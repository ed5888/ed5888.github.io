(this["webpackJsonp@elamp/main-app"]=this["webpackJsonp@elamp/main-app"]||[]).push([[1],{1e3:function(e,t,n){"use strict";n.d(t,"c",(function(){return A})),n.d(t,"d",(function(){return N})),n.d(t,"e",(function(){return I})),n.d(t,"b",(function(){return R})),n.d(t,"a",(function(){return W})),n.d(t,"f",(function(){return K}));var a=n(139),r=n.n(a),c=n(187),i=n(286),o=n(53),s=n(285),d=n(17),u=n(0),l=n(14),j=n(10),p=n(1016),b=n(1010),f=n(1148),O=n(1153),m=n(1154),h=n(1013),g=n(800),v=n(1),x=function(e){var t=Object.assign({},e);return Object(v.jsx)(l.Line,Object(d.a)(Object(d.a)({py:1,width:"100%"},t),{},{children:t.children}))},y=function(e,t){var n=[],a=[{}],r=[{}];return"undefined"!==typeof e&&"undefined"!==typeof t&&(e.length>=t.length?(a=e,r=t):(a=t,r=e)),a.forEach((function(e,t){var a=r[t];"undefined"!==typeof a&&delete a.manDays,delete e.manDays,n.push(Object.keys(e).length===Object.keys(a||{}).length&&Object.keys(e).every((function(t){return e[t]===a[t]})))})),n.every((function(e){return!0===e}))},C=["isOpened","projectNeed","onUpdate","onSelectAssignment","searchPattern","onNewAssignmentCreated"],D={isQuickAssignModalOpened:!1,isAdvancedSearchModalOpened:!1,isAssignmentModalOpened:!1,isAddNeedModalOpened:!1,isSearchProfileModalOpened:!1,isExternalAssignment:!1,users:[]};function w(e,t){switch(t.type){case"openQuickAssignModal":return Object(d.a)(Object(d.a)({},e),{},{isQuickAssignModalOpened:!0,isAdvancedSearchModalOpened:!1,isAssignmentModalOpened:!1});case"closeQuickAssignModal":return Object(d.a)(Object(d.a)({},e),{},{isQuickAssignModalOpened:!1});case"openAdvancedSearchModal":return Object(d.a)(Object(d.a)({},e),{},{isQuickAssignModalOpened:!1,isAdvancedSearchModalOpened:!0,isAssignmentModalOpened:!1});case"closeAdvancedSearchModal":return Object(d.a)(Object(d.a)({},e),{},{isAdvancedSearchModalOpened:!1});case"selectUsersToAssign":return Object(d.a)(Object(d.a)({},e),{},{isExternalAssignment:!0===t.isExternalAssignment,isAdvancedSearchModalOpened:!1,isQuickAssignModalOpened:!1,isAssignmentModalOpened:!0,users:t.users||[]});case"closeAssignmentModal":return Object(d.a)(Object(d.a)({},e),{},{isAssignmentModalOpened:!1});case"openSearchProfileModal":return Object(d.a)(Object(d.a)({},e),{},{isSearchProfileModalOpened:!0});case"closeSearchProfileModal":return Object(d.a)(Object(d.a)({},e),{},{isSearchProfileModalOpened:!1});default:return e}}var A=function(e){var t=e.isOpened,n=e.projectNeed,a=e.onUpdate,A=e.onSelectAssignment,P=e.searchPattern,S=e.onNewAssignmentCreated,N=Object(s.a)(e,C),I=Object(u.useReducer)(w,D),M=Object(o.a)(I,2),k=M[0],E=M[1],L=Object(l.useTranslate)({capitalize:!0}),T=Object(j.useAppContext)().customFields,_=n.capabilities,U=_.canUpdate,F=_.canAssign,B=function(e){return function(){var t=Object(i.a)(r.a.mark((function t(n){return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,a(Object(c.a)({},e,n));case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},z=function(){var e=Object(i.a)(r.a.mark((function e(t){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,B("projectId")(t);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),V=function(){E({type:"closeSearchProfileModal"})},H=function(){E({type:"closeAdvancedSearchModal"})},W=function(){E({type:"closeAssignmentModal"})},Q=function(e){E({type:"selectUsersToAssign",users:e,isExternalAssignment:!1})},Y=function(){var e=Object(i.a)(r.a.mark((function e(t){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=4;break}return e.next=3,a({searchPattern:t});case 3:V();case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Z=function(){var e=Object(i.a)(r.a.mark((function e(t){var n;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.pattern,e.next=3,a({searchPattern:n});case 3:H();case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),q=function(){var e=Object(i.a)(r.a.mark((function e(c){var i;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=c.scheduledPeriods,t&&(y(i,n.scheduledPeriods)||a({scheduledPeriods:i}).catch((function(e){return console.error("Schedule update failed !!",e)})));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(v.jsxs)(v.Fragment,{children:[Object(v.jsxs)(l.Column,Object(d.a)(Object(d.a)({alignItems:"flex-start"},N),{},{children:[Object(v.jsx)(x,{children:Object(v.jsx)(l.Label,{content:L("staffing_project_need_title"),name:"projectNeedName",width:"100%",children:Object(v.jsx)(l.TextEditable,{value:n.name,readOnly:!U,onSubmit:B("name"),getIsValueValid:function(e){return"undefined"!==typeof e&&e.trim().length>0},width:"100%"})})}),Object(v.jsx)(x,{children:Object(v.jsx)(l.Label,{content:L("description"),name:"projectNeedDescription",width:"100%",children:U?Object(v.jsx)(l.TextEditableCancelable,{initialText:n.description||"",placeholder:L("add_a_description"),onSubmit:B("description")}):Object(v.jsx)(l.Text,{ml:1,children:n.description||""})})}),Object(v.jsx)(x,{children:Object(v.jsx)(l.Label,{content:L("staffing_project",1),name:"project",width:"100%",children:Object(v.jsx)(p.a,{placeholder:"",value:n.project.id,submit:z,width:"100%",readOnly:!U})})}),T.projectNeedFields.length>0&&Object(v.jsx)(j.FormSectionContainer,{children:Object(v.jsx)(g.a,{customFieldsConfiguration:T.projectNeedFields,onChange:B("customFields"),value:n.customFields,width:"100%"})}),Object(v.jsx)(j.FormSectionContainer,{title:L("scheduled_periods_and_number_of_resources"),children:Object(v.jsx)(K,{minStartDate:n.project.startDate,maxEndDate:n.project.endDate,initialScheduledPeriods:n.scheduledPeriods,onSubmit:q,readOnly:!U},n.scheduledPeriods.map((function(e){return"".concat(e.endDate,"_").concat(e.startDate,"_").concat(e.headCount,"_").concat(e.manDays,"_").concat(e.rate)})).join("."))}),Object(v.jsx)(j.FormSectionContainer,{title:L("searched_profile"),children:n.tags&&Object(v.jsx)(b.a,{tags:n.tags,onModify:function(){E({type:"openSearchProfileModal"})},canUpdate:U})}),Object(v.jsx)(j.FormSectionContainer,{title:L("assignments"),children:Object(v.jsx)(R,{projectAssignments:null===n||void 0===n?void 0:n.projectAssignments,allocationRates:null===n||void 0===n?void 0:n.allocationRates.total,onAddAssignment:function(e){E({type:"openQuickAssignModal"})},onSelectAssignment:A,width:"100%",canAssign:F})})]})),Object(v.jsx)(O.a,{isOpened:k.isQuickAssignModalOpened,onClose:function(){E({type:"closeQuickAssignModal"})},onSelectUser:function(e){Q([e])},onClickAdvancedSearch:function(){E({type:"openAdvancedSearchModal"})},onClickAddExternalResource:function(){E({type:"selectUsersToAssign",users:[],isExternalAssignment:!0})}}),Object(v.jsx)(m.a,{isOpened:k.isAdvancedSearchModalOpened,onClose:H,resourceSearchPattern:P,rawTextForSuggests:"",onSubmit:function(e){var t=e.selection;Q(t)},onUpdatePattern:Z}),Object(v.jsx)(f.a,{isOpened:k.isAssignmentModalOpened,initialStartDate:n.startDate,initialEndDate:n.endDate,needId:n.id,assignUsersData:{format:k.isExternalAssignment?"external":(k.users||[]).length>1?"multi":"single",users:k.users||[]},onClose:W,onSubmit:function(){S(),W()}},"".concat(n.id,"_").concat(k.isExternalAssignment?"external":"multi","_").concat((k.users||[]).sort().join("-"))),Object(v.jsx)(h.a,{initialPattern:n.resourceSearchPattern,isOpened:k.isSearchProfileModalOpened,onClose:V,onSubmit:Y,projectNeedForSuggestions:{name:n.name,description:n.description,project:{name:n.project.name,description:void 0}}})]})},P=n(749),S=["canDelete","renderTitle","onDelete"],N=function(e){var t=e.canDelete,n=e.renderTitle,a=e.onDelete,r=Object(s.a)(e,S),c=Object(l.useSwitch)(!1),i=c.active,o=c.on,u=c.off,j=Object(l.useTranslate)({capitalize:!0});return Object(v.jsxs)(l.Line,Object(d.a)(Object(d.a)({justifyContent:"space-between"},r),{},{children:[n(),t&&Object(v.jsxs)(l.MenuSelect.Target,{children:[Object(v.jsx)(l.IconButton,{iconAs:P.a,onClick:o,isActive:i}),Object(v.jsx)(l.MenuSelect,{onClose:u,isOpened:i,children:Object(v.jsx)(l.MenuOption,{onClick:function(){a(),u()},children:j("delete")})})]})]}))},I=function(e){var t=Object.assign({},e),n=Object(l.useTranslate)({capitalize:!0});return Object(v.jsx)(l.Box,Object(d.a)(Object(d.a)({width:"100%",display:"flex",justifyContent:"center"},t),{},{children:Object(v.jsxs)(l.Line,{children:[Object(v.jsx)(l.Loader,{}),Object(v.jsx)(l.Text,{ml:1,children:n("loading")})]})}))},M=n(61),k=n(65),E=n(63),L=n(833),T=n(764),_=n(795),U=["allocationRates","canAssign","onAddAssignment","onSelectAssignment","projectAssignments"],R=function(e){var t=e.allocationRates,n=(e.canAssign,e.onAddAssignment),a=e.onSelectAssignment,r=e.projectAssignments,c=Object(s.a)(e,U),i=Object(l.useTranslate)(),o=(Object(k.h)(),(null===r||void 0===r?void 0:r.length)||0),u={confirmed:"success.0",provisional:"alert.0",simulated:"grey.1"},j=Object(M.default)(l.Line)((function(e){return{":hover":{background:e.theme.colors.grey[0]}}}));return Object(v.jsxs)(l.Box,Object(d.a)(Object(d.a)({},c),{},{children:[Object(v.jsxs)(l.Line,{justifyContent:"space-between",mb:1,children:[Object(v.jsx)(l.Box,{width:"25%",children:Object(v.jsx)(l.ProgressionStatus,{attendedValue:100,actualValue:t,isPercent:!0})}),Object(v.jsxs)(l.Card,{display:"flex",alignItems:"center",width:"100%",ml:3,children:[Object(v.jsx)(l.Icon,{as:L.a,p:5}),Object(v.jsxs)(l.Text,{children:[o," ",i("resource",o)]})]}),Object(v.jsxs)(l.Button,{appearance:"clean",onClick:n,children:[Object(v.jsx)(l.Icon,{as:T.a,mr:0})," ",i("assign_ressource")]})]}),Object(v.jsx)(l.Box,{width:"100%",children:null===r||void 0===r?void 0:r.map((function(e){var t,n=u[e.status]||"grey.6";return Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)(j,{p:5,width:"100%",onClick:(t=e.id,function(){a(t)}),children:Object(v.jsxs)(l.Box,{width:"100%",display:"flex",alignItems:"center",justifyContent:"space-between",children:[Object(v.jsxs)(l.Box,{display:"flex",alignItems:"center",children:[Object(v.jsx)(E.UserAvatar,{user:{displayName:e.user.displayName,avatarURL:e.user.avatarURL,familyName:e.user.familyName,givenName:e.user.givenName},mr:2,size:"small"}),Object(v.jsx)(l.Text,{children:e.user.displayName})]}),Object(v.jsxs)(l.Box,{display:"flex",alignItems:"center",children:[Object(v.jsx)(l.Text,{bg:n,p:5,fontWeight:"semiBold",children:i(e.status).toUpperCase()}),Object(v.jsx)(l.Icon,{size:14,as:_.a,mr:1,ml:2})]})]})},e.user.id),Object(v.jsx)(l.Separator,{})]})}))})]}))},F=n(751),B=n(23),z=n(1019),V=n(766),H=["projectAssignment","onUpdate"],W=function(e){var t=e.projectAssignment,n=e.onUpdate,a=Object(s.a)(e,H),r=Object(u.useState)({status:t.status,startDate:t.startDate,endDate:t.endDate,rate:t.rate,manDays:t.manDays,customFields:t.customFields}),i=Object(o.a)(r,2),p=i[0],b=i[1],f=Object(l.useTranslate)({capitalize:!0}),O=Object(j.useAppContext)().customFields,m=t.capabilities.canUpdate,h=function(e){return function(t){b(Object(d.a)(Object(d.a)({},p),{},Object(c.a)({},e,t))),y(Object(c.a)({},e,t))}},g=function(e){return function(t){"onChange"===e&&b(Object(d.a)(Object(d.a)({},p),{},{rate:Number(t)})),"onBlur"===e&&n({rate:p.rate})}},y=Object(u.useCallback)(Object(F.debounce)((function(e){return n(e)}),500),[]);return Object(v.jsxs)(l.Column,Object(d.a)(Object(d.a)({alignItems:"flex-start"},a),{},{children:[Object(v.jsx)(x,{children:Object(v.jsx)(l.Label,{content:f("status",1),name:"status",width:"100%",children:Object(v.jsx)(z.a,{value:p.status,onChange:h("status"),isModification:!0,capabilities:t.capabilities,width:"100%"})})}),Object(v.jsx)(x,{children:Object(v.jsx)(l.Label,{content:f("staffing_project",1),name:"needName",width:"100%",children:Object(v.jsx)(l.Text,{fontWeight:"semiBold",p:1,color:"grey.6",children:Object(B.maj)(t.projectName)})})}),Object(v.jsx)(x,{flexDirection:"column",children:Object(v.jsx)(l.PeriodPicker,{readOnly:!m,startDate:t.startDate,endDate:t.endDate,onChange:function(e){var t=e.startDate,a=e.endDate;b(Object(d.a)(Object(d.a)({},p),{},{startDate:t,endDate:a})),n({startDate:t,endDate:a})},mb:0})}),Object(v.jsxs)(x,{children:[Object(v.jsx)(l.Label,{content:"".concat(f("rate")," (%)"),name:"rate",mb:0,children:Object(v.jsx)(l.Input,{type:"number",readOnly:!m,value:p.rate,onBlur:g("onBlur"),onChange:g("onChange")})}),Object(v.jsx)(l.Label,{content:f("rate_man_day"),ml:2,children:Object(v.jsx)(l.Input,{type:"undefined"===typeof t.manDays?"text":"number",readOnly:!0,value:"undefined"===typeof t.manDays?"-":t.manDays,ml:1})})]}),O.projectAssignmentFields.length>0&&Object(v.jsx)(x,{children:Object(v.jsx)(V.a,{customFieldsConfiguration:O.projectAssignmentFields,onChange:h("customFields"),value:p.customFields,width:"100%"})}),Object(v.jsx)(x,{})]}))},Q=n(188),Y=n(19),Z=n(37),q=n(773),G=n(288),J=["value","onSubmit","minStartDate","maxEndDate","isManDaysLoading","readOnly"],X=function(e){var t=e.value,n=e.onSubmit,a=e.minStartDate,r=e.maxEndDate,i=e.isManDaysLoading,j=e.readOnly,p=void 0!==j&&j,b=Object(s.a)(e,J),f=Object(l.useTranslate)({capitalize:!0}),O=Object(u.useState)({headCount:t.headCount,rate:t.rate,manDays:t.manDays}),m=Object(o.a)(O,2),h=m[0],g=m[1];Object(u.useEffect)((function(){g({headCount:t.headCount,rate:t.rate,manDays:t.manDays})}),[t]);var x=function(e){return function(a){var r;r="headCount"===e||"rate"===e?Number(a):a,n(Object(d.a)(Object(d.a)({},t),{},Object(c.a)({},e,r)))}};return Object(v.jsxs)(l.Box,Object(d.a)(Object(d.a)({display:"flex",flexWrap:"wrap",width:"100%"},b),{},{children:[Object(v.jsx)(l.PeriodPicker,{startDate:t.startDate,isStartDateRequired:!0,endDate:t.endDate,isEndDateRequired:!0,minStartDate:a,maxEndDate:r,onChange:function(e){var a=e.startDate,r=e.endDate;a===t.startDate&&r===t.endDate||!n||n(Object(d.a)(Object(d.a)({},t),{},{startDate:a||void 0,endDate:r||void 0}))},isFlex:!1,readOnly:p}),Object(v.jsxs)(l.Line,{width:"100%",display:"flex",children:[Object(v.jsx)(l.Label,{content:f("number_of_persons"),mr:1,mb:1,children:Object(v.jsx)(l.Input,{type:"number",readOnly:p,value:h.headCount,onChange:function(e){return g((function(t){return Object(d.a)(Object(d.a)({},t),{},{headCount:Number(e)})}))},onBlur:function(){h.headCount!==t.headCount&&x("headCount")(h.headCount)}})}),Object(v.jsx)(l.Label,{content:f("rate"),mb:1,children:Object(v.jsx)(l.Input,{type:"number",readOnly:p,value:h.rate,onChange:function(e){return g((function(t){return Object(d.a)(Object(d.a)({},t),{},{rate:Number(e)})}))},onBlur:function(){h.rate!==t.rate&&x("rate")(h.rate)}})})]}),Object(v.jsx)(l.Line,{children:Object(v.jsx)(l.Label,{content:f("rate_man_day"),mb:1,children:i?Object(v.jsx)(l.LoaderSkeleton.Line,{width:"80%",my:1}):Object(v.jsx)(l.Input,{type:"undefined"===typeof h.manDays?"text":"number",readOnly:!0,value:"undefined"===typeof h.manDays?"-":h.manDays,onChange:function(e){g((function(t){return Object(d.a)(Object(d.a)({},t),{},{manDays:Number(e)})}))},onBlur:function(){h.manDays!==t.manDays&&x("manDays")(h.manDays)},ml:1})})})]}))},K=function(e){var t=e.initialScheduledPeriods,n=e.onSubmit,a=e.onError,r=e.minStartDate,c=e.maxEndDate,i=e.readOnly,s=void 0!==i&&i,j=Object(l.useTranslate)({capitalize:!0}),p=Object(u.useState)({scheduledPeriods:Object(Q.a)(t)}),b=Object(o.a)(p,2),f=b[0],O=b[1],m=Object(Y.useComputeScheduledPeriodsManDaysLazyQuery)({onCompleted:function(e){var t,n=null===e||void 0===e||null===(t=e.computeScheduledPeriodsManDays)||void 0===t?void 0:t.periods;if(n){var a=n.map((function(e){return{startDate:e.startDate,endDate:e.endDate,rate:e.rate,headCount:Object(Y.maybeToOptional)(e.headCount)||1,manDays:Object(q.getRoundedToTwoDecimalsOrZero)(e.manDays)}}));O((function(e){return Object(d.a)(Object(d.a)({},e),{},{scheduledPeriods:a})}))}}}),h=Object(o.a)(m,2),g=h[0],x=h[1].loading,C=Object(u.useMemo)((function(){var e,t=null===(e=f.scheduledPeriods[0])||void 0===e?void 0:e.startDate,n=f.scheduledPeriods.length>0?f.scheduledPeriods[f.scheduledPeriods.length-1].endDate:void 0,a="undefined"===typeof r||"undefined"===typeof t||Object(Z.localeMoment)(r).isSameOrBefore(Object(Z.localeMoment)(t)),i="undefined"===typeof c||"undefined"===typeof n||Object(Z.localeMoment)(c).isSameOrAfter(Object(Z.localeMoment)(n));return!a||!i}),[r,c,f.scheduledPeriods]);Object(u.useEffect)((function(){C&&a&&a()}),[C]),Object(u.useEffect)((function(){if(f.scheduledPeriods.every((function(e){return"undefined"!==typeof e.startDate}))&&f.scheduledPeriods.every((function(e){return"undefined"!==typeof e.endDate}))&&f.scheduledPeriods.every((function(e){return"undefined"!==typeof e.rate}))){var e=f.scheduledPeriods.map((function(e){return{startDate:e.startDate,endDate:e.endDate,rate:e.rate||100,headCount:e.headCount||1}}));g({variables:{input:{periods:e}}})}}),[f.scheduledPeriods]),Object(u.useEffect)((function(){C||(y(t,f.scheduledPeriods)||A())}),[f.scheduledPeriods,C]);var D=function(e){return function(){var t=f.scheduledPeriods.filter((function(t,n){return e!==n}));O(Object(d.a)(Object(d.a)({},f),{},{scheduledPeriods:t}))}},w=function(e){return function(t){var n=Object(Q.a)(f.scheduledPeriods);n[e]&&(n[e]=t,O(Object(d.a)(Object(d.a)({},f),{},{scheduledPeriods:n})))}},A=function(){n({scheduledPeriods:f.scheduledPeriods.map((function(e){return{startDate:e.startDate,endDate:e.endDate,headCount:e.headCount,rate:e.rate}}))})};return Object(v.jsxs)(v.Fragment,{children:[f.scheduledPeriods.map((function(e,t){var n;return Object(v.jsxs)(l.Box,{mb:1,children:[Object(v.jsxs)(l.Line,{width:"100%",justifyContent:"space-between",children:[Object(v.jsx)(l.Text,{fontWeight:"bold",textTransform:"uppercase",mb:1,size:14,children:j("scheduled_period_number",{number:t+1})}),!s&&t===f.scheduledPeriods.length-1&&t>0&&Object(v.jsx)(l.IconButton,{iconAs:G.a,size:18,onClick:D(t)})]}),Object(v.jsx)(X,{value:e,onSubmit:w(t),isManDaysLoading:x,minStartDate:t>0?f.scheduledPeriods[t-1].endDate:void 0,maxEndDate:null===(n=f.scheduledPeriods[t+1])||void 0===n?void 0:n.startDate,readOnly:s,mb:1})]},"scheduledPeriod_".concat(t))})),!s&&Object(v.jsxs)(v.Fragment,{children:[Object(v.jsxs)(l.TextButton,{onClick:function(){var e,t,n=f.scheduledPeriods[f.scheduledPeriods.length-1];n.endDate&&(e=Object(Z.localeMoment)(n.endDate).add(1,"day").toISOString()),O(Object(d.a)(Object(d.a)({},f),{},{scheduledPeriods:[].concat(Object(Q.a)(f.scheduledPeriods),[Object(d.a)({},(t={startDate:e,endDate:Object(Z.localeMoment)(e).add(1,"day").toISOString()},{rate:100,headCount:1,startDate:t.startDate,endDate:t.endDate,manDays:void 0}))])}))},children:[j("add_a_something",{object:j("a_scheduled_period")}),"..."]}),C&&Object(v.jsx)(l.Box,{mt:1,width:"100%",bg:"error.0",p:1,children:Object(v.jsxs)(l.Text,{fontWeight:"semiBold",children:[j("project_need_dates_cannot_be_out_of_project_date_range"),Object(v.jsx)("br",{}),"(",Object(Z.localeMoment)(r).format("DD MMMM YYYY")," -"," ",Object(Z.localeMoment)(c).format("DD MMMM YYYY"),")"]})})]})]})}},1010:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return u}));var a=n(17),r=(n(0),n(63)),c=n(14),i=n(1),o=function(e){var t=e.tags,n=e.onModify,o=e.canUpdate,s=Object(c.useTranslate)();return Object(i.jsxs)(i.Fragment,{children:[Object(i.jsx)(c.Box,{display:"flex",flexWrap:"wrap",children:t.map((function(e){var t;return t="geolocationTag"===e.kind?e.place.label:"customFieldTag"===e.kind?e.fieldKey:e.id,Object(i.jsx)(r.ObjectTag,Object(a.a)(Object(a.a)({},e),{},{mr:1,mb:1}),t)}))}),n&&o&&Object(i.jsx)(c.Button,{appearance:"clean",onClick:n,children:s("modify_criteria")})]})},s=n(751),d=n(109),u=function(e){var t=e.project,n=e.projectNeed,a=e.projectNeedResourceSearchPattern,r=t.groups||[],c=t.place,i=n.startDate,o=n.endDate,u=Object(s.cloneDeep)(a)||{must:[],should:[]};return"undefined"!==typeof c&&"undefined"!==typeof c.location&&(u=Object(d.applyGeolocationFilters)(u,{label:c.label,location:{latitude:c.location.latitude,longitude:c.location.longitude}})),u=Object(d.applyGroupsFilters)(u,r),"undefined"!==typeof i&&"undefined"!==typeof o&&(u=Object(d.applyAvailabilityFilters)(u,{startDate:new Date(i),endDate:new Date(o)})),u}},1013:function(e,t,n){"use strict";n.d(t,"a",(function(){return j}));var a=n(17),r=n(53),c=n(285),i=n(0),o=n(14),s=n(63),d=n(10),u=n(1),l=["initialPattern","isOpened","confirmButtonLabel","cancelButtonLabel","onClose","onSubmit","projectNeedForSuggestions"],j=function(e){var t,n=e.initialPattern,j=e.isOpened,p=e.confirmButtonLabel,b=e.cancelButtonLabel,f=e.onClose,O=e.onSubmit,m=e.projectNeedForSuggestions,h=Object(c.a)(e,l),g=Object(o.useTranslate)(),v=Object(d.useAppContext)().checkLayout,x=Object(i.useState)(),y=Object(r.a)(x,2),C=y[0],D=y[1],w=function(){f()},A="".concat((null===m||void 0===m||null===(t=m.project)||void 0===t?void 0:t.name)||"","\n  \n ").concat((null===m||void 0===m?void 0:m.name)||""," \n  \n ").concat((null===m||void 0===m?void 0:m.description)||"");return Object(u.jsx)(d.FormContainerModal,Object(a.a)(Object(a.a)({title:g("searched_profile"),isOpened:j,onClose:w,onCancel:w,onConfirm:function(){O(C)},cancelButtonLabel:b,confirmButtonLabel:p,maxHeight:"95vh"},h),{},{children:Object(u.jsx)(s.SearchFilters,{useCase:"PROJECT_NEED_DEFINITION",initialPattern:n,suggestsOptions:{rawText:A,isInstantCriteria:!1},checkLayout:v,onChange:function(e){!0===j&&D(e.pattern)},width:"100%",pt:1})}))}},1016:function(e,t,n){"use strict";n.d(t,"a",(function(){return O}));var a=n(139),r=n.n(a),c=n(286),i=n(53),o=n(187),s=n(17),d=n(285),u=n(0),l=n(14),j=n(19),p=n(65),b=n(1),f=["submit","value","readOnly"],O=function(e){var t=e.submit,n=e.value,a=e.readOnly,O=void 0!==a&&a,m=Object(d.a)(e,f),h=Object(p.h)(),g=Object(j.useGetProjectsNamesQuery)({fetchPolicy:"cache-and-network"}),v=g.data,x=g.loading,y=Object(u.useMemo)((function(){var e;return null===v||void 0===v||null===(e=v.projects)||void 0===e?void 0:e.nodes.reduce((function(e,t,n){return Object(s.a)(Object(s.a)({},e),{},Object(o.a)({},t.name||"unnamed project ".concat(n),t.id))}),{})}),[v]),C=Object(u.useMemo)((function(){return function(e){var t;if("undefined"!==typeof y)return null===(t=Object.entries(y).find((function(t){var n=Object(i.a)(t,2);return n[0],n[1]===e})))||void 0===t?void 0:t[0]}(n)}),[v]),D=function(){var e=Object(c.a)(r.a.mark((function e(n,a){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a||"undefined"===typeof y){e.next=3;break}return e.next=3,t(y[n]);case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();return x||"undefined"===typeof y?Object(b.jsx)(l.LoaderSkeleton.Line,{width:"100%",my:0}):Object(b.jsx)(l.Box,Object(s.a)(Object(s.a)({},m),{},{children:O?Object(b.jsx)(l.Text,{my:0,ml:1,fontWeight:"semiBold",color:"grey.6",children:C}):Object(b.jsx)(l.AutoCompleteEditable,{onChange:function(){},submit:D,source:Object.keys(y),value:C,zIndex:h.zIndexes.MODAL_POPOVER,width:"100%"})}))}},1019:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var a=n(17),r=n(223),c=n(285),i=n(0),o=n(14),s=n(32),d=n(65),u=n(1),l=["isModification","capabilities","value","onChange"],j=new Map([[s.ProjectAssignmentStatus.Simulated,"simulated"],[s.ProjectAssignmentStatus.Provisional,"provisional"],[s.ProjectAssignmentStatus.Confirmed,"confirmed"]]),p=function(e){var t=e.isModification,n=e.capabilities,s=e.value,p=e.onChange,b=Object(c.a)(e,l),f=Object(o.useTranslate)({capitalize:!0}),O=Object(d.h)(),m=Object(i.useMemo)((function(){var e,a=[],c=Object(r.a)(j);try{var i=function(){var r=e.value;t?(s&&!(null===n||void 0===n?void 0:n.allowedStatuses.includes(s))&&r[0]===s&&a.push(r),null===n||void 0===n||n.allowedStatuses.forEach((function(e){r[0]===e&&a.push(r)}))):a.push(r)};for(c.s();!(e=c.n()).done;)i()}catch(o){c.e(o)}finally{c.f()}return a}),[n]);return Object(u.jsx)(o.SelectField,Object(a.a)({value:s,zIndex:O.zIndexes.MODAL_POPOVER,onChange:p,readOnly:1===m.length,source:m.map((function(e){return{label:f(e[1]),value:e[0]}}))},b))}},1148:function(e,t,n){"use strict";n.d(t,"a",(function(){return T}));var a,r,c=n(139),i=n.n(c),o=n(286),s=n(53),d=n(285),u=n(17),l=n(0),j=n(14),p=n(19),b=n(32),f=n(37),O=n(773),m=n(10),h=n(760),g=n(766),v=n(1019),x=n(1),y=["onDateChange","rate","manDays","isManDaysLoading","setRate","startDate","endDate"],C=function(e){var t=e.onDateChange,n=e.rate,a=e.manDays,r=e.isManDaysLoading,c=e.setRate,i=e.startDate,o=e.endDate,s=Object(d.a)(e,y),l=Object(j.useTranslate)({capitalize:!0});return Object(x.jsxs)(j.Column,Object(u.a)(Object(u.a)({},s),{},{children:[Object(x.jsx)(j.PeriodPicker,{startDate:i,isStartDateRequired:!0,endDate:o,isEndDateRequired:!0,onChange:t}),Object(x.jsxs)(j.Line,{mt:2,width:"100%",children:[Object(x.jsx)(j.Label,{mb:0,content:"".concat(l("rate")," (%)"),required:!0,children:Object(x.jsx)(j.Input,{width:"100%",value:n,onChange:c,type:"number"})}),Object(x.jsx)(j.Label,{content:l("rate_man_day"),ml:2,children:r?Object(x.jsx)(j.LoaderSkeleton.Line,{width:"80%",my:1}):Object(x.jsx)(j.Input,{type:"undefined"===typeof a?"text":"number",readOnly:!0,value:"undefined"===typeof a?"-":a,ml:1})})]})]}))},D=["title","titleId"];function w(){return(w=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function A(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},c=Object.keys(e);for(a=0;a<c.length;a++)n=c[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(a=0;a<c.length;a++)n=c[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function P(e,t){var n=e.title,c=e.titleId,i=A(e,D);return l.createElement("svg",w({viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg",ref:t,"aria-labelledby":c},i),n?l.createElement("title",{id:c},n):null,a||(a=l.createElement("g",{clipPath:"url(#clip0_3002_944)"},l.createElement("path",{d:"M9.93334 12.0749C9.93334 10.9333 10.2583 9.87494 10.8 9.00828C10.7667 8.84161 10.7083 8.69161 10.5917 8.57494C10.4333 8.41661 10.2333 8.33328 10 8.33328H5V6.66661H6.66667C6.9 6.66661 7.1 6.58328 7.25834 6.42494C7.41667 6.26661 7.5 6.06661 7.5 5.83328V4.16661H9.16667C9.625 4.16661 10.0167 3.99994 10.3417 3.67494C10.6667 3.34994 10.8333 2.95828 10.8333 2.49994V2.16661C12.1 2.66661 13.1083 3.47494 13.8667 4.59994C14.3083 5.25828 14.6083 5.95828 14.7917 6.69994C15.4167 6.69994 16.0167 6.84161 16.5667 7.08328C16.4667 6.39161 16.2833 5.71661 16.0083 5.07494C15.5667 4.05828 14.975 3.17494 14.225 2.42494C13.475 1.67494 12.5917 1.08328 11.5833 0.64161C10.5667 0.199943 9.48334 -0.0167236 8.33333 -0.0167236C7.18334 -0.0167236 6.1 0.199943 5.08334 0.64161C4.06667 1.07494 3.18334 1.67494 2.43334 2.42494C1.68334 3.17494 1.09167 4.05828 0.650002 5.07494C0.208335 6.09161 -0.0083313 7.17494 -0.0083313 8.32494C-0.0083313 9.47494 0.208335 10.5583 0.650002 11.5749C1.08334 12.5916 1.68334 13.4666 2.43334 14.2166C3.18334 14.9666 4.06667 15.5583 5.08334 15.9999C5.88334 16.3416 6.725 16.5499 7.61667 16.6249C8.20834 15.4583 9.11667 14.4999 10.2333 13.8999C10.05 13.3249 9.94167 12.7166 9.94167 12.0749H9.93334ZM7.5 14.9583C5.81667 14.7499 4.425 14.0166 3.325 12.7499C2.225 11.4833 1.66667 10.0166 1.66667 8.33328C1.66667 8.08328 1.68334 7.83328 1.71667 7.58328C1.75 7.33328 1.79167 7.08328 1.83334 6.83328L5.83334 10.8333V11.6666C5.83334 12.1249 6 12.5166 6.325 12.8416C6.65 13.1666 7.04167 13.3333 7.5 13.3333V14.9583Z"}),l.createElement("path",{d:"M12.3583 8.97504C11.7667 9.56671 11.4667 10.2834 11.4667 11.1167C11.4667 11.95 11.7667 12.6667 12.3583 13.2584C12.95 13.85 13.675 14.15 14.5 14.15C15.325 14.15 16.05 13.85 16.6417 13.2584C17.2333 12.6667 17.5333 11.9417 17.5333 11.1167C17.5333 10.2917 17.2333 9.56671 16.6417 8.97504C16.05 8.38337 15.325 8.08337 14.5 8.08337C13.675 8.08337 12.95 8.38337 12.3583 8.97504ZM15.8583 11.1167C15.8583 11.4917 15.725 11.8084 15.4583 12.075C15.1917 12.3417 14.875 12.475 14.5 12.475C14.125 12.475 13.8083 12.3417 13.5417 12.075C13.275 11.8084 13.1417 11.4917 13.1417 11.1167C13.1417 10.7417 13.275 10.425 13.5417 10.1584C13.8083 9.89171 14.125 9.75837 14.5 9.75837C14.875 9.75837 15.1833 9.89171 15.4583 10.1584C15.725 10.425 15.8583 10.7417 15.8583 11.1167Z"}),l.createElement("path",{d:"M19.6917 16.6499C19.4833 16.2833 19.2083 16.0083 18.8667 15.8166C18.1667 15.4333 17.4417 15.1499 16.7167 14.9583C15.2667 14.5749 13.725 14.5749 12.2833 14.9583C11.5583 15.1499 10.8333 15.4416 10.1333 15.8166C9.79167 16.0083 9.51667 16.2916 9.30833 16.6499C9.1 17.0166 9 17.4166 9 17.8416V19.9999H20V17.8416C20 17.4083 19.9 17.0083 19.6917 16.6499ZM18.425 18.3249H10.5667V17.8499C10.5667 17.7333 10.5917 17.6333 10.6417 17.5333C10.6917 17.4416 10.7667 17.3666 10.8417 17.3166C11.4417 16.9916 12.05 16.7499 12.65 16.5833C13.8583 16.2583 15.1167 16.2583 16.325 16.5833C16.9333 16.7416 17.5417 16.9916 18.1333 17.3083C18.2167 17.3583 18.2833 17.4333 18.3417 17.5249C18.3917 17.6166 18.4167 17.7249 18.4167 17.8416V18.3166L18.425 18.3249Z"}))),r||(r=l.createElement("defs",null,l.createElement("clipPath",{id:"clip0_3002_944"},l.createElement("rect",{width:20,height:20})))))}var S=l.forwardRef(P),N=(n.p,n(759)),I=["value","onChange"],M=function(e){var t=e.value,n=e.onChange,a=Object(d.a)(e,I),r=Object(j.useTranslate)({capitalize:!0});return Object(x.jsxs)(j.Line,Object(u.a)(Object(u.a)({width:"100%"},a),{},{children:[Object(x.jsx)(N.b,{children:Object(x.jsx)(j.Icon,{as:S,size:30,color:"grey.4"})}),Object(x.jsx)(j.Text,{fontSize:14,ml:1,children:r("external_collaborator")}),Object(x.jsxs)(j.Box,{ml:2,children:[Object(x.jsx)(j.Text,{mb:0,children:r("number_of_resources_to_assign")}),Object(x.jsx)(j.Input,{value:t.toString(),onChange:function(e){n(Number(e))},min:0,type:"number"})]})]}))},k=(n(65),["needId","initialStartDate","initialEndDate","isOpened","onSubmit","onClose","assignUsersData"]),E={userIds:[],isExternalResource:!1,externalRessource:1,projectId:"",status:b.ProjectAssignmentStatus.Provisional,startDate:"",endDate:"",rate:100,manDays:void 0},L=function(e,t){switch(t.type){case"setUserIds":return Object(u.a)(Object(u.a)({},e),{},{userIds:t.userIds||[]});case"setExternalRessource":return Object(u.a)(Object(u.a)({},e),{},{externalRessource:t.externalRessource});case"setProjectId":return Object(u.a)(Object(u.a)({},e),{},{projectId:t.projectId});case"setStatus":return Object(u.a)(Object(u.a)({},e),{},{status:t.status});case"init":return Object(u.a)(Object(u.a)({},e),{},{startDate:t.startDate,endDate:t.endDate,projectId:t.needId,isExternalResource:t.isExternalResource});case"setManDays":return Object(u.a)(Object(u.a)({},e),{},{manDays:t.manDays});case"setDate":return Object(u.a)(Object(u.a)({},e),{},{startDate:t.startDate,endDate:t.endDate});case"setRate":return Object(u.a)(Object(u.a)({},e),{},{rate:t.rate});case"setCustomFields":return Object(u.a)(Object(u.a)({},e),{},{customFields:t.customFields});case"reset":return E;default:return e}},T=function(e){var t=e.needId,n=e.initialStartDate,a=e.initialEndDate,r=e.isOpened,c=e.onSubmit,u=e.onClose,b=e.assignUsersData,y=(Object(d.a)(e,k),Object(j.useTranslate)({capitalize:!0})),D=Object(m.useAppContext)(),w=D.getErrorMessage,A=D.customFields,P=Object(l.useState)(!1),S=Object(s.a)(P,2),N=S[0],I=S[1],T=Object(j.useAlert)(),_=Object(l.useReducer)(L,E),U=Object(s.a)(_,2),R=U[0],F=R.customFields,B=R.endDate,z=R.externalRessource,V=R.isExternalResource,H=R.manDays,W=(R.projectId,R.rate),Q=R.startDate,Y=R.status,Z=R.userIds,q=U[1],G=Object(l.useMemo)((function(){return!Q||!B||"number"===typeof z&&z<1}),[Q,B]),J=Object(p.useGetUsersLazyQuery)(),X=Object(s.a)(J,2),K=X[0],$=X[1],ee=$.data,te=$.loading,ne=Object(p.useCreateProjectBulkAssignmentsMutation)(),ae=Object(s.a)(ne,1)[0],re=Object(p.useComputeScheduledPeriodsManDaysLazyQuery)({onCompleted:function(e){var t,n=null===e||void 0===e||null===(t=e.computeScheduledPeriodsManDays)||void 0===t?void 0:t.periods;if(n){var a=n.map((function(e){return{startDate:e.startDate,endDate:e.endDate,rate:e.rate,manDays:e.manDays}}));q({type:"setManDays",manDays:Object(O.getRoundedToTwoDecimalsOrZero)(a[0].manDays)})}}}),ce=Object(s.a)(re,2),ie=ce[0],oe=ce[1].loading;Object(l.useEffect)((function(){var e=Object(f.localeMoment)().format("YYYY-MM-DD");q({type:"init",needId:t,startDate:n?Object(f.localeMoment)(n).format("YYYY-MM-DD"):e,endDate:a?Object(f.localeMoment)(a).format("YYYY-MM-DD"):e,isExternalResource:"external"===b.format})}),[n,a,b.format]),Object(l.useEffect)((function(){if("external"!==b.format){var e=b.users.map((function(e){return e}));q({type:"setUserIds",userIds:e})}}),[b]),Object(l.useEffect)((function(){r&&Z.length>0&&K({variables:{ids:Z}})}),[Z,r]),Object(l.useEffect)((function(){if(r&&"undefined"!==typeof Q&&"undefined"!==typeof B){var e=[{startDate:Q,endDate:B,rate:W,headCount:"external"===b.format?z:Z.length}];ie({variables:{input:{periods:e}}})}}),[Q,B,W,z,r]);var se=Object(l.useMemo)((function(){var e,t=null===ee||void 0===ee||null===(e=ee.users)||void 0===e?void 0:e.nodes;if(t)return t.map((function(e){return Object(p.getFormatedUserBasicFragment)(e)}))}),[ee]),de=function(){var e=Object(o.a)(i.a.mark((function e(n){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:I(!0),ae({variables:{input:{assignments:n}}}).then((function(e){var n,a;T.success(y("assignments_created")),c({needId:t,createdAssignments:(null===(n=e.data)||void 0===n||null===(a=n.createProjectBulkAssignments)||void 0===a?void 0:a.projectAssignments)||[]}),I(!1)})).catch((function(e){T.error(w(e)),I(!1)}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ue=function(){q({type:"reset"}),u()};return Object(x.jsx)(m.FormContainerModal,{title:"multi"===b.format?y("new_assignment",8):y("new_assignment",1),confirmButtonLabel:y("assign"),isOpened:r,onClose:ue,onCancel:ue,onConfirm:function(){if(Q&&B)if("external"===b.format){for(var e=[],n=0;n<z;n++)e.push({userId:"EXT1",projectNeedId:t,startDate:Q,endDate:B,status:Y,rate:W,customFields:F,isExternalResource:V});de(e)}else if(Z){var a=Z.map((function(e){return{userId:e,projectNeedId:t,startDate:Q,endDate:B,status:Y,rate:W,customFields:F,isExternalResource:V}}));de(a)}},isLoading:N,isDisabledSubmit:G,maxHeight:"95vh",children:te?Object(x.jsx)(j.Loader,{}):Object(x.jsxs)(j.Column,{alignItems:"flex-start",py:1,children:["external"===b.format&&Object(x.jsx)(m.ContainerWithBottomSeparator,{mt:-20,children:Object(x.jsx)(M,{value:z,onChange:function(e){var t=1;e>=0&&(t=e),q({type:"setExternalRessource",externalRessource:t})}})}),"single"===b.format&&se&&se.length>0&&Object(x.jsx)(m.ContainerWithBottomSeparator,{mt:-20,children:Object(x.jsx)(h.b,{user:se[0]})}),"multi"===b.format&&se&&se.length>0&&Object(x.jsx)(m.ContainerWithBottomSeparator,{mt:-20,children:Object(x.jsx)(h.a,{users:se})}),Object(x.jsx)(m.ContainerWithBottomSeparator,{children:Object(x.jsx)(j.Label,{content:y("status"),required:!0,children:Object(x.jsx)(v.a,{value:Y,onChange:function(e){q({type:"setStatus",status:e})}})})}),Object(x.jsx)(m.ContainerWithBottomSeparator,{py:20,children:Object(x.jsx)(C,{rate:W,setRate:function(e){var t;t=Number(e)?Number(e)>100?100:Number(e):0,q({type:"setRate",rate:t})},startDate:Q,endDate:B,manDays:H,isManDaysLoading:oe,onDateChange:function(e){var t=e.startDate,n=e.endDate;t===Q&&n===B||q({type:"setDate",startDate:t||void 0,endDate:n||void 0})}})}),A.projectAssignmentFields.length>0&&Object(x.jsx)(g.a,{customFieldsConfiguration:A.projectAssignmentFields,onChange:function(e){q({type:"setCustomFields",customFields:e})},value:F,width:"100%"})]})})}},1151:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var a=n(53),r=n(0),c=n(14),i=n(63),o=n(19),s=n(61),d=n(1),u=Object(s.default)(c.Line)((function(){return{textDecoration:"none"}})),l=function(e){e.id;var t=e.displayName,n=e.familyName,a=e.givenName,r=e.avatarURL;return Object(d.jsxs)(u,{width:"100%",p:1,my:1,children:[Object(d.jsx)(i.UserAvatar,{ml:0,mr:8,size:"small",user:{displayName:t,familyName:n,givenName:a,avatarURL:r}}),Object(d.jsx)(c.Box,{children:Object(d.jsx)(c.Text,{fontWeight:"semiBold",children:t})})]})},j=i.Selector.withSelector((function(e){var t,n=e.searchValue,s=e.submitSelection,u=Object(o.useSearchUsersLazyQuery)({variables:{searchQuery:n}}),j=Object(a.a)(u,2),p=j[0],b=j[1],f=b.data,O=b.loading;Object(r.useEffect)((function(){p({variables:{searchQuery:n}})}),[n]);var m=[];return(null===f||void 0===f||null===(t=f.search)||void 0===t?void 0:t.edges)&&f.search.edges.forEach((function(e){"User"===e.node.__typename&&m.push(Object(o.getFormatedUserBasicFragment)(e.node))})),O?Object(d.jsx)(c.Loader,{}):Object(d.jsx)(i.Selector.Result,{isLoading:O,data:m||[],onSelect:s,renderElement:function(e){return"selectable"===e.type?Object(d.jsx)(l,{id:e.id,displayName:e.displayName,avatarURL:e.avatarURL,givenName:e.givenName,familyName:e.familyName}):null},height:45,p:"0px"})})),p=function(e){var t=e.onSelect,n=e.placeholder;return Object(d.jsx)(c.Line,{width:"90%",children:Object(d.jsx)(j,{submitSelection:function(e){t(e.id)},placeholder:n,width:"100%",height:350})})}},1153:function(e,t,n){"use strict";n(0);var a=n(14),r=n(61),c=n(1151),i=n(1),o=Object(r.default)(a.Text)((function(){return{textDecoration:"underline",":hover":{background:"none"}}})),s=function(e){var t=e.onClose,n=void 0===t?function(){}:t,r=e.onSelectUser,s=e.onClickAdvancedSearch,d=e.onClickAddExternalResource,u=Object(a.useTranslate)();return Object(i.jsxs)(a.Box,{height:"175px",p:0,children:[Object(i.jsx)(a.Line,{width:"100%",display:"flex",justifyContent:"center",mt:1,children:Object(i.jsx)(c.a,{onSelect:function(e){r(e)},placeholder:u("search_object",{object:u("a_resource",1)})})}),Object(i.jsxs)(a.Line,{display:"flex",justifyContent:"space-between",my:1,children:[Object(i.jsx)(a.Button,{appearance:"clean",onClick:function(){n()},accent:"grey",children:u("cancel")}),Object(i.jsx)(a.Button,{appearance:"clean",onClick:function(){s()},children:u("advanced_search")})]}),Object(i.jsx)(a.Line,{display:"flex",justifyContent:"center",children:Object(i.jsx)(a.Separator,{width:"90%"})}),Object(i.jsx)(a.Line,{display:"flex",justifyContent:"center",mt:1,children:Object(i.jsx)(o,{fontSize:14,onClick:function(){d()},children:"".concat(u("add_external_resource"),"...")})})]})};t.a=function(e){var t=e.isOpened,n=e.onClose,r=e.onSelectUser,c=e.onClickAddExternalResource,o=e.onClickAdvancedSearch;return Object(i.jsx)(a.Modal,{isOpened:t,onClose:n,showCloseButton:!0,children:Object(i.jsx)(s,{onClose:n,onSelectUser:r,onClickAdvancedSearch:o,onClickAddExternalResource:c})})}},1154:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(53),r=n(0),c=n(14),i=n(63),o=n(10),s=n(310),d=n(288),u=n(1),l=function(e){var t=e.rawTextForSuggests,n=e.resourceSearchPattern,l=e.isOpened,j=e.onClose,p=e.onSubmit,b=e.onUpdatePattern,f=Object(c.useTranslate)(),O=Object(r.useState)([]),m=Object(a.a)(O,2),h=m[0],g=m[1],v=function(){g([]),j()},x=Object(o.useAppContext)().disabledFilters;return Object(u.jsx)(c.Modal,{isOpened:l,onClose:v,width:"90%",height:"90%",children:Object(u.jsx)(i.ResourceSearchPage,{useCase:"PROJECT_NEED_DEFINITION",initialPattern:n,selectedIds:h,onUserSelectionChange:function(e,t){g(t?function(t){return t.filter((function(t){return t!==e}))}:function(t){return t.concat([e])})},resultComponent:s.a,disabledFilters:x,suggestsOptions:{rawText:t,isInstantCriteria:!1},headerRender:function(){return Object(u.jsxs)(u.Fragment,{children:[Object(u.jsxs)(c.Line,{justifyContent:"space-between",pb:1,width:"100%",children:[Object(u.jsx)(c.Text,{fontSize:"big",fontWeight:"bold",textTransform:"uppercase",ml:2,children:f("searched_profile")}),Object(u.jsx)(c.IconButton,{iconSize:20,size:20,iconAs:d.a,onClick:v,accent:"black"})]}),Object(u.jsx)(c.Separator,{borderWidth:2})]})},footerRender:function(e){var t=e.pattern,n=e.selectedIds;return Object(u.jsxs)(c.Line,{justifyContent:"flex-end",width:"100%",pt:1,children:[Object(u.jsx)(c.Text,{onClick:v,color:"grey.4",mr:1,children:f("cancel")}),Object(u.jsx)(c.Button,{onClick:function(){return b({pattern:t})},appearance:"outline",mr:1,children:f("save_criteria")}),Object(u.jsx)(c.Button,{onClick:function(){p({selection:n}),g([])},children:f("preposition")})]})}})})}},749:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a,r,c,i=n(0),o=["title","titleId"];function s(){return(s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function d(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},c=Object.keys(e);for(a=0;a<c.length;a++)n=c[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(a=0;a<c.length;a++)n=c[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function u(e,t){var n=e.title,u=e.titleId,l=d(e,o);return i.createElement("svg",s({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1000 1000",ref:t,"aria-labelledby":u},l),n?i.createElement("title",{id:u},n):null,a||(a=i.createElement("circle",{cx:0,cy:500,r:128})),r||(r=i.createElement("circle",{cx:500,cy:500,r:128})),c||(c=i.createElement("circle",{cx:1e3,cy:500,r:128})))}var l=i.forwardRef(u);n.p},759:function(e,t,n){"use strict";n.d(t,"b",(function(){return b})),n.d(t,"a",(function(){return m}));var a=n(17),r=n(285),c=n(0),i=n.n(c),o=n(189),s=n(61),d=n(14),u=n(63),l=n(3),j=n(1),p=["users","isLink","maxDisplayCount","totalCount","mainTooltipPosition","offLimitTooltipPosition","size","isLoading","isOverLapped","urlNewTabOnPlusClick","onClick"],b=Object(s.default)(d.Box)((function(e){var t=e.onClick;return{background:e.theme.colors.grey[0],width:"35px",height:"35px",display:"flex",justifyContent:"center",alignItems:"center",borderRadius:"50px",cursor:"default",":hover":{cursor:t?"pointer":"default"}}})),f=Object(s.default)(d.Box)((function(e){return{background:e.theme.colors.grey[0],width:"35px",height:"35px",display:"flex",justifyContent:"center",alignItems:"center",borderRadius:"50px",cursor:"default",textDecoration:"none",":hover":{cursor:"pointer"}}})),O={y:-5,scale:1.15},m=i.a.forwardRef((function(e,t){var n=e.users,c=e.isLink,i=void 0!==c&&c,s=e.maxDisplayCount,m=void 0===s?7:s,h=e.totalCount,g=e.mainTooltipPosition,v=void 0===g?"bottom":g,x=e.offLimitTooltipPosition,y=void 0===x?"bottom":x,C=e.size,D=void 0===C?"small":C,w=e.isLoading,A=void 0!==w&&w,P=e.isOverLapped,S=void 0!==P&&P,N=e.urlNewTabOnPlusClick,I=e.onClick,M=Object(r.a)(e,p),k=Object(d.useTranslate)(),E="number"===typeof h?h:n.length,L=Math.min(n.length,m),T=n.length>L?Math.min(n.length-L,4):0,_=E-(L+T);return A?Object(j.jsx)(d.Loader,{}):0===n.length?null:Object(j.jsx)(d.Box,{ref:t,children:Object(j.jsxs)(d.Line,Object(a.a)(Object(a.a)({width:"100%"},M),{},{children:[n.slice(0,m).map((function(e){return Object(j.jsx)(d.Tooltip,{position:v,title:e.displayName,children:Object(j.jsx)(u.UserAvatar,{mr:S?-1:void 0,whileHover:S?O:void 0,user:e,size:D,linkTo:i?l.b.USER_PROFILE_DETAILS.getRoute({userId:e.id}):void 0,target:"_blank"})},e.displayName)})),(T>0||_>0)&&Object(j.jsx)(d.Tooltip,{position:y,title:Object(j.jsxs)(d.Column,{justifyContent:"flex-start",children:[T>0&&n.slice(L,L+T).map((function(e){var t=e.id,n=e.displayName;return Object(j.jsx)(d.Line,{display:"flex",justifyContent:"flex-start",width:"100%",children:Object(j.jsx)(d.Text,{mb:0,color:"white",fontSize:"small",children:n})},t)})),_>0&&Object(j.jsx)(d.Line,{display:"flex",justifyContent:"flex-start",width:"100%",children:Object(j.jsx)(d.Text,{color:"white",fontSize:"small",children:"+ ".concat(k("num_other",_))})})]}),children:N?Object(j.jsx)(f,{as:"a",href:N,onClick:I,target:"_blank",children:Object(j.jsx)(d.Text,{fontWeight:"bold",fontSize:12,children:"+".concat(T+_)})}):Object(j.jsx)(b,{as:o.motion.span,whileHover:O,onClick:I,children:Object(j.jsx)(d.Text,{fontWeight:"bold",fontSize:12,children:"+".concat(T+_)})})})]}))})}))},760:function(e,t,n){"use strict";n.d(t,"a",(function(){return r.a})),n.d(t,"b",(function(){return p})),n.d(t,"c",(function(){return D})),n.d(t,"d",(function(){return N}));var a,r=n(759),c=n(17),i=n(285),o=n(0),s=n(14),d=n(63),u=n(23),l=n(1),j=["avatarRightMargin","avatarSize","fontSize","fontWeight","user"],p=function(e){var t=e.avatarRightMargin,n=void 0===t?2:t,a=e.avatarSize,r=void 0===a?"medium":a,o=e.fontSize,p=void 0===o?"medium":o,b=e.fontWeight,f=void 0===b?"semiBold":b,O=e.user,m=Object(i.a)(e,j);return Object(l.jsxs)(s.Line,Object(c.a)(Object(c.a)({width:"100%"},m),{},{children:[Object(l.jsx)(d.UserAvatar,{user:O,size:r,mr:n,ml:1}),Object(l.jsx)(s.TextWithAutoTooltipOnEllipsis,{fontWeight:f,fontSize:p,p:0,tooltipTitle:Object(u.maj)(O.displayName),children:Object(u.maj)(O.displayName)})]}))},b=n(139),f=n.n(b),O=n(286),m=n(61),h=["title","titleId"];function g(){return(g=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function v(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},c=Object.keys(e);for(a=0;a<c.length;a++)n=c[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(a=0;a<c.length;a++)n=c[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function x(e,t){var n=e.title,r=e.titleId,c=v(e,h);return o.createElement("svg",g({xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",ref:t,"aria-labelledby":r},c),n?o.createElement("title",{id:r},n):null,a||(a=o.createElement("path",{d:"M5 4h-3v-1h3v1zm12 9c0 2.206-1.794 4-4 4s-4-1.794-4-4 1.794-4 4-4 4 1.794 4 4zm-1 0c0-1.657-1.342-3-3-3s-3 1.343-3 3 1.342 3 3 3 3-1.343 3-3zm8-8v17h-24v-17h5.93c.669 0 1.293-.334 1.664-.891l1.406-2.109h8l1.406 2.109c.371.557.995.891 1.664.891h3.93zm-19 4c0-.552-.447-1-1-1s-1 .448-1 1 .447 1 1 1 1-.448 1-1zm14 4c0-3.314-2.687-6-6-6s-6 2.686-6 6 2.687 6 6 6 6-2.686 6-6z"})))}var y=o.forwardRef(x),C=(n.p,["linkTo","target","user","readOnly","onChangeAvatar"]),D=120,w=Object(m.default)(s.Box)((function(){return{width:D,height:D,display:"flex",alignItems:"center",justifyContent:"center",position:"relative"}})),A=Object(m.default)("input")((function(){return{width:1,height:1,position:"absolute"}})),P=Object(m.default)(s.Box)((function(e){var t=e.theme;return{position:"absolute",width:D,height:D,borderRadius:D,background:"none",display:"flex",alignItems:"center",justifyContent:"center",svg:{display:"none"},":hover":{background:t.colors.black[1],svg:{display:"block"}}}})),S=Object(m.default)(s.Icon)((function(){return{pointerEvents:"none"}})),N=function(e){var t=e.linkTo,n=e.target,a=e.user,r=e.readOnly,u=e.onChangeAvatar,j=Object(i.a)(e,C),p=Object(s.useTranslate)({capitalize:!0}),b=Object(o.useRef)(null),m=function(){var e=Object(O.a)(f.a.mark((function e(t){var n,a;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:"undefined"!==typeof(a=null===(n=t.target.files)||void 0===n?void 0:n[0])&&u&&u(a);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(l.jsxs)(w,Object(c.a)(Object(c.a)({},j),{},{children:[!r&&Object(l.jsxs)(l.Fragment,{children:[Object(l.jsx)(A,{type:"file",ref:b,onChange:m}),Object(l.jsx)(s.Tooltip,{title:p("update_photo"),position:"bottom",children:Object(l.jsx)(P,{onClick:function(){b.current&&b.current.click()},children:Object(l.jsx)(S,{as:y,color:"white",size:60})})})]}),Object(l.jsx)(d.UserAvatar,{linkTo:t,target:n,user:a,size:"huge",margin:15})]}))}},764:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var a,r=n(0),c=["title","titleId"];function i(){return(i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function o(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},c=Object.keys(e);for(a=0;a<c.length;a++)n=c[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(a=0;a<c.length;a++)n=c[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function s(e,t){var n=e.title,s=e.titleId,d=o(e,c);return r.createElement("svg",i({id:"Icon",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",x:"0px",y:"0px",viewBox:"0 0 24 24",style:{enableBackground:"new 0 0 24 24"},xmlSpace:"preserve",ref:t,"aria-labelledby":s},d),n?r.createElement("title",{id:s},n):null,a||(a=r.createElement("path",{d:"M20.5,10H14V3.5C14,3.2,13.8,3,13.5,3h-3C10.2,3,10,3.2,10,3.5V10H3.5C3.2,10,3,10.2,3,10.5v3C3,13.8,3.2,14,3.5,14H10v6.5 c0,0.3,0.2,0.5,0.5,0.5h3c0.3,0,0.5-0.2,0.5-0.5V14h6.5c0.3,0,0.5-0.2,0.5-0.5v-3C21,10.2,20.8,10,20.5,10z"})))}var d=r.forwardRef(s);n.p},766:function(e,t,n){"use strict";n.d(t,"c",(function(){return d})),n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return l.a}));var a=n(17),r=n(285),c=(n(0),n(14)),i=n(63),o=n(1),s=["customFields","customFieldsConfiguration","shouldHideUndefined"],d=function(e,t){return!(t in e)||void 0==e[t]||"string"===typeof e[t]&&0===e[t].length},u=function(e){var t=e.customFields,n=e.customFieldsConfiguration,u=e.shouldHideUndefined,l=void 0!==u&&u,j=Object(r.a)(e,s);return Object(o.jsx)(o.Fragment,{children:(null===n||void 0===n?void 0:n.length)>0&&t&&Object(o.jsx)(c.Box,Object(a.a)(Object(a.a)({},j),{},{children:n.map((function(e){return!0===l&&d(t,e._key)?null:Object(o.jsx)(i.CustomField,{mb:2,value:t[e._key],field:e,readOnly:!0,withLabel:!0},e._key)}))}))})},l=n(800)},773:function(e,t,n){"use strict";n.r(t),n.d(t,"getRoundedToTwoDecimalsOrZero",(function(){return a})),n.d(t,"getRoundedToOneDecimalOrZero",(function(){return r})),n.d(t,"getRoundedValueInPercent",(function(){return c}));var a=function(e){return"undefined"!==typeof e?Math.round(100*(e+Number.EPSILON))/100:0},r=function(e){return"undefined"!==typeof e?Math.round(10*(e+Number.EPSILON))/10:0},c=function(e,t){return void 0===t&&(t=0),Math.round(100*(e+Number.EPSILON)*Math.pow(10,t))/Math.pow(10,t)}},785:function(e,t,n){"use strict";n.d(t,"a",(function(){return A})),n.d(t,"b",(function(){return k}));var a=n(139),r=n.n(a),c=n(17),i=n(286),o=n(53),s=n(285),d=n(0),u=n(14),l=n(23),j=n(10),p=n(841),b=n(19),f=n(773),O=n(1010),m=function(e){return(e||[]).map((function(e){var t;return Object(c.a)(Object(c.a)({},e),{},{qualifiers:((null===(t=e.skill.qualifiers)||void 0===t?void 0:t.nodes)||[]).map((function(t){var n,a;return Object(c.a)(Object(c.a)({},t),{},{value:null===(n=e.qualifiers.find((function(e){return e.qualifier.id===t.id})))||void 0===n?void 0:n.value,comparator:null===(a=e.qualifiers.find((function(e){return e.qualifier.id===t.id})))||void 0===a?void 0:a.comparator})}))})}))||{}},h=n(1e3),g=n(1),v=["title"],x=function(e){var t=e.title,n=Object(s.a)(e,v);return Object(g.jsx)(u.Text,Object(c.a)(Object(c.a)({px:1,fontWeight:"bold",fontSize:"big"},n),{},{children:t}))},y=n(63),C=["assignedUser"],D=function(e){var t=e.assignedUser,n=Object(s.a)(e,C),a=Object(u.useTranslate)();return Object(g.jsxs)(u.Line,Object(c.a)(Object(c.a)({px:1},n),{},{children:[Object(g.jsx)(u.Text,{fontWeight:"bold",fontSize:"big",mr:1,children:a("two_points",{phrase:a("assignment")})}),Object(g.jsx)(y.UserBasicInfo,{user:{id:t.id,displayName:t.displayName,avatarURL:t.avatarURL,familyName:t.familyName,givenName:t.givenName}})]}))},w=["projectNeedId","projectAssignmentId","onChangeProjectAssignmentId","onUpdatedProjectNeed","onUpdatedProjectAssignment","isOpened","onClose"],A=function(e){var t=e.projectNeedId,n=e.projectAssignmentId,a=e.onChangeProjectAssignmentId,v=e.onUpdatedProjectNeed,y=e.onUpdatedProjectAssignment,C=e.isOpened,A=e.onClose,P=Object(s.a)(e,w),S=Object(u.useTranslate)({capitalize:!0}),N=Object(j.useAppContext)().getErrorMessage,I=Object(u.useAlert)(),M=Object(u.useSwitch)(!1),k=Object(d.useState)({projectNeedId:t,projectAssignmentId:"undefined"===typeof t?n:void 0}),E=Object(o.a)(k,2),L=E[0],T=L.projectNeedId,_=L.projectAssignmentId,U=E[1],R=function(e){var t=e.projectNeedId,n=e.projectAssignmentId,a=e.onProjectNeedUpdated,s=Object(b.useGetProjectNeedLazyQuery)(),u=Object(o.a)(s,2),l=u[0],j=u[1],p=j.data,h=j.loading,g=j.refetch,v=Object(b.useGetProjectAssignmentLazyQuery)({fetchPolicy:"cache-and-network",nextFetchPolicy:"cache-first"}),x=Object(o.a)(v,2),y=x[0],C=x[1],D=C.data,w=C.loading,A=C.refetch,P=Object(b.useUpdateProjectNeedMutation)({onCompleted:function(){g(),a&&a()}}),S=Object(o.a)(P,1)[0],N=Object(b.useUpdateProjectAssignmentMutation)(),I=Object(o.a)(N,1)[0],M=Object(b.useDeleteProjectNeedMutation)(),k=Object(o.a)(M,2),E=k[0],L=k[1].loading,T=Object(b.useDeleteProjectAssignmentMutation)(),_=Object(o.a)(T,2),U=_[0],R=_[1].loading,F=function(){var e=Object(i.a)(r.a.mark((function e(n){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=3;break}return e.next=3,S({variables:Object(c.a)({id:t},n)});case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),B=function(){var e=Object(i.a)(r.a.mark((function e(t){var a;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n){e.next=4;break}return a=t.onUpdatedProjectAssignment,e.next=4,I({variables:Object(c.a)({id:n},t),onCompleted:function(){a&&a({})},refetchQueries:b.refetchQueries.onMutateAssignment});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),z=function(){var e=Object(i.a)(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=3;break}return e.next=3,E({variables:{id:t}});case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),V=function(){var e=Object(i.a)(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n){e.next=3;break}return e.next=3,U({variables:{id:n}});case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),H=Object(d.useMemo)((function(){if(null===p||void 0===p?void 0:p.projectNeed){var e,t,n,a,r,i,o,s=p.projectNeed.resourceSearchPatternTags;return{id:p.projectNeed.id,name:p.projectNeed.name,description:Object(b.maybeToOptional)(p.projectNeed.description),startDate:p.projectNeed.startDate,endDate:p.projectNeed.endDate,customFields:p.projectNeed.customFields,capabilities:{canUpdate:p.projectNeed.capabilities.canUpdate,canDelete:p.projectNeed.capabilities.canDelete,canAssign:p.projectNeed.capabilities.canAssign},project:{id:p.projectNeed.project.id,name:Object(b.maybeToOptional)(p.projectNeed.project.name),startDate:p.projectNeed.project.startDate?new Date(p.projectNeed.project.startDate):void 0,endDate:p.projectNeed.project.endDate?new Date(p.projectNeed.project.endDate):void 0,place:p.projectNeed.project.place?{label:p.projectNeed.project.place.label,location:{latitude:null===(e=p.projectNeed.project.place.location)||void 0===e?void 0:e.latitude,longitude:null===(t=p.projectNeed.project.place.location)||void 0===t?void 0:t.longitude}}:void 0,groups:p.projectNeed.project.groups.nodes.map((function(e){return e.id}))},projectAssignments:p.projectNeed.projectAssignments.nodes.map((function(e){return{id:e.id,status:e.status,capabilities:{canUpdate:e.capabilities.canUpdate,canDelete:e.capabilities.canDelete,allowedStatuses:e.capabilities.allowedStatuses},user:"User"===e.assignedUser.__typename?Object(b.getFormatedUserBasicFragment)(e.assignedUser):{id:e.assignedUser.id,displayName:e.assignedUser.displayName,avatarURL:e.assignedUser.avatarURL}}})),allocationRates:{total:p.projectNeed.allocationRates.total,byPeriod:[]},scheduledPeriods:(p.projectNeed.scheduledPeriods||[]).map((function(e){return{startDate:e.startDate,endDate:e.endDate,headCount:Object(b.maybeToOptional)(e.headCount),rate:Object(b.maybeToOptional)(e.rate),manDays:Object(f.getRoundedToTwoDecimalsOrZero)(Object(b.maybeToOptional)(e.manDays))}})),resourceSearchPattern:Object(c.a)(Object(c.a)({},null===p||void 0===p||null===(n=p.projectNeed)||void 0===n?void 0:n.resourceSearchPattern),{},{must:m(null===p||void 0===p||null===(a=p.projectNeed)||void 0===a||null===(r=a.resourceSearchPattern)||void 0===r?void 0:r.must),should:m(null===p||void 0===p||null===(i=p.projectNeed)||void 0===i||null===(o=i.resourceSearchPattern)||void 0===o?void 0:o.should)}),resourceSearchPatternTags:p.projectNeed.resourceSearchPatternTags,tags:s}}}),[p]),W=Object(d.useMemo)((function(){if("undefined"!==typeof H)return Object(O.b)({project:{startDate:H.project.startDate,endDate:H.project.endDate,groups:H.project.groups,place:H.project.place},projectNeed:{startDate:H.startDate,endDate:H.endDate},projectNeedResourceSearchPattern:H.resourceSearchPattern})}),[H]),Q=Object(d.useMemo)((function(){if(null===D||void 0===D?void 0:D.projectAssignment)return{startDate:D.projectAssignment.startDate,endDate:D.projectAssignment.endDate,projectName:D.projectAssignment.project.name,rate:D.projectAssignment.rate,manDays:Object(f.getRoundedToTwoDecimalsOrZero)(D.projectAssignment.manDays),status:D.projectAssignment.status,customFields:D.projectAssignment.customFields,capabilities:{canUpdate:D.projectAssignment.capabilities.canUpdate,canDelete:D.projectAssignment.capabilities.canDelete,allowedStatuses:D.projectAssignment.capabilities.allowedStatuses}}}),[D]),Y=Object(d.useMemo)((function(){if(null===D||void 0===D?void 0:D.projectAssignment){var e=D.projectAssignment.assignedUser;return"User"===e.__typename?Object(b.getFormatedUserBasicFragment)(e):{id:e.id,displayName:e.displayName,givenName:void 0,familyName:void 0,avatarURL:Object(b.maybeToOptional)(e.avatarURL)}}}),[D]);return Object(d.useEffect)((function(){t&&l({variables:{id:t}})}),[t]),Object(d.useEffect)((function(){n&&y({variables:{id:n}})}),[n]),{projectNeed:H,projectNeedSearchPattern:W,projectAssignment:Q,projectAssignmentAssignedUser:Y,refetchProjectNeed:g,refetchProjectAssignment:A,isLoadingProjectNeed:h,isLoadingProjectAssignment:w,isDeletingProjectNeed:L,isDeletingProjectAssignment:R,updateProjectNeed:F,updateProjectAssignment:B,deleteProjectNeed:z,deleteProjectAssignment:V}}({projectNeedId:T,projectAssignmentId:_,onProjectNeedUpdated:v}),F=R.projectNeed,B=R.isLoadingProjectNeed,z=R.projectAssignment,V=R.isLoadingProjectAssignment,H=R.projectAssignmentAssignedUser,W=R.refetchProjectNeed,Q=R.refetchProjectAssignment,Y=R.projectNeedSearchPattern,Z=R.updateProjectNeed,q=R.updateProjectAssignment,G=R.deleteProjectNeed,J=R.deleteProjectAssignment,X=R.isDeletingProjectNeed,K=R.isDeletingProjectAssignment;Object(d.useEffect)((function(){"undefined"!==typeof t&&U({projectNeedId:t,projectAssignmentId:void 0})}),[t]),Object(d.useEffect)((function(){"undefined"!==typeof n&&U({projectAssignmentId:n,projectNeedId:void 0})}),[n]),Object(d.useEffect)((function(){C&&(_&&Q&&Q({id:_}),T&&W&&W({id:T}))}),[C]);var $="undefined"!==typeof T&&"undefined"===typeof _,ee="undefined"!==typeof _&&"undefined"===typeof T,te=Object(d.useMemo)((function(){return S($?"confirm_delete_staffing_project_need":ee?"confirm_delete_staffing_project_assignment":"confirm")}),[$,ee]),ne=function(){var e=Object(i.a)(r.a.mark((function e(t){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Z(Object(c.a)(Object(c.a)({},t),{},{resourceSearchPattern:t.searchPattern}));case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.error("Error updating project need");case 8:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(t){return e.apply(this,arguments)}}(),ae=function(){var e=Object(i.a)(r.a.mark((function e(t){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,q(Object(c.a)(Object(c.a)({},t),{},{onUpdatedProjectAssignment:y})).then((function(){y&&y({startDate:t.startDate,endDate:t.endDate,status:t.status,rate:t.rate,userId:null===H||void 0===H?void 0:H.id})})).catch((function(e){I.error(N(e)),console.error("Error updating project assignment")}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),re=function(){($||ee)&&M.on()},ce=function(){var e=Object(i.a)(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,G();case 3:P.onDeletedProjectNeed(),M.off(),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error("Error deleting project need");case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),ie=function(){var e=Object(i.a)(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,J();case 3:P.onDeletedProjectAssignment(),M.off(),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error("Error deleting project assignment");case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}();return Object(g.jsxs)(g.Fragment,{children:[Object(g.jsxs)(p.a,{isOpened:C,onClose:A,renderHeader:function(){return Object(g.jsx)(h.d,{renderTitle:function(){return $?Object(g.jsx)(x,{title:Object(l.maj)((null===F||void 0===F?void 0:F.name)||"")}):ee&&H?Object(g.jsx)(D,{assignedUser:H}):null},canDelete:(null===F||void 0===F?void 0:F.capabilities.canDelete)||(null===z||void 0===z?void 0:z.capabilities.canDelete)||!1,onDelete:re})},children:[$&&Object(g.jsx)(g.Fragment,{children:!B&&F&&Y?Object(g.jsx)(h.c,{projectNeed:F,isOpened:C,onUpdate:ne,onSelectAssignment:a,searchPattern:Y,onNewAssignmentCreated:function(){W&&W()}}):Object(g.jsx)(h.e,{})}),ee&&Object(g.jsx)(g.Fragment,{children:!V&&z?Object(g.jsx)(h.a,{projectAssignment:z,onUpdate:ae}):Object(g.jsx)(h.e,{})})]}),Object(g.jsx)(u.ConfirmModal,{isOpened:M.active,onConfirm:function(){$?ce():ee&&ie()},onCancel:M.off,isLoading:X||K,children:Object(g.jsx)(u.Box,{display:"flex",flexDirection:"column",children:Object(g.jsx)(u.Text,{fontSize:"big",fontWeight:"bold",children:te})})})]})},P=n(15),S="projectNeedId",N="projectAssignmentId",I=function(e){var t=e.projectNeedId,n=e.projectAssignmentId;return"undefined"!==typeof t||"undefined"!==typeof n},M=function(e,t){switch(t.type){case"setProjectNeedId":return Object(c.a)(Object(c.a)({},e),{},{projectAssignmentId:void 0,projectNeedId:t.projectNeedId,isOpened:I({projectNeedId:t.projectNeedId})});case"setProjectAssignmentId":return Object(c.a)(Object(c.a)({},e),{},{projectNeedId:void 0,projectAssignmentId:t.projectAssignmentId,isOpened:I({projectAssignmentId:t.projectAssignmentId})});case"open":return Object(c.a)(Object(c.a)({},e),{},{isOpened:I({projectNeedId:e.projectNeedId,projectAssignmentId:e.projectAssignmentId})});case"close":return Object(c.a)(Object(c.a)({},e),{},{isOpened:!1});default:return e}},k=function(e){var t=Object(d.useReducer)(M,{projectNeedId:e.projectNeedId,projectAssignmentId:e.projectAssignmentId,isOpened:I({projectNeedId:e.projectNeedId,projectAssignmentId:e.projectAssignmentId})}),n=Object(o.a)(t,2),a=n[0],r=a.isOpened,c=a.projectNeedId,i=a.projectAssignmentId,s=n[1],u=Object(P.useLocation)(),l=Object(P.useHistory)();Object(d.useEffect)((function(){r&&c?l.push("?".concat(S,"=").concat(c)):r&&i?l.push("?".concat(N,"=").concat(i)):l.push(u.pathname)}),[r,c,i]),Object(d.useEffect)((function(){var e=new URLSearchParams(u.search),t=e.get(S),n=e.get(N);t&&t!==c?s({type:"setProjectNeedId",projectNeedId:t}):n&&n!==i?s({type:"setProjectAssignmentId",projectAssignmentId:n}):t||n||s({type:"close"})}),[u.search]);return{isOpened:r,projectNeedId:c,projectAssignmentId:i,setProjectNeedId:function(e){s({type:"setProjectNeedId",projectNeedId:e})},setProjectAssignmentId:function(e){s({type:"setProjectAssignmentId",projectAssignmentId:e})},open:function(){s({type:"open"})},close:function(){s({type:"close"})}}}},800:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var a=n(187),r=n(17),c=n(285),i=(n(0),n(14)),o=n(63),s=n(1),d=["customFieldsConfiguration","value","onChange"],u=function(e){var t=e.customFieldsConfiguration,n=e.value,u=e.onChange,l=Object(c.a)(e,d);return Object(s.jsx)(i.Box,Object(r.a)(Object(r.a)({},l),{},{children:t.map((function(e){return Object(s.jsx)(o.CustomField,{field:e,value:null===n||void 0===n?void 0:n[e._key],onSubmit:(t=e._key,function(e){u(Object(r.a)(Object(r.a)({},n||{}),{},Object(a.a)({},t,e)))}),withLabel:!0,mb:1,width:l.width},e._key);var t}))}))}},833:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var a,r=n(0),c=["title","titleId"];function i(){return(i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function o(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},c=Object.keys(e);for(a=0;a<c.length;a++)n=c[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(a=0;a<c.length;a++)n=c[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function s(e,t){var n=e.title,s=e.titleId,d=o(e,c);return r.createElement("svg",i({viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg",ref:t,"aria-labelledby":s},d),n?r.createElement("title",{id:s},n):null,a||(a=r.createElement("path",{d:"M0 18V15.1084C0 14.5141 0.138106 13.9759 0.414318 13.494C0.689933 13.012 1.05891 12.6426 1.52125 12.3855C2.46085 11.8715 3.41536 11.4898 4.38479 11.2405C5.35421 10.9918 6.33855 10.8675 7.33781 10.8675C8.33706 10.8675 9.3214 10.9918 10.2908 11.2405C11.2603 11.4898 12.2073 11.8635 13.132 12.3614C13.5943 12.6185 13.9672 12.9921 14.2506 13.4824C14.5339 13.972 14.6756 14.5141 14.6756 15.1084V18H0ZM16.5324 18V14.9157C16.5324 14.1928 16.3535 13.4982 15.9955 12.8318C15.6376 12.1648 15.1156 11.5663 14.4295 11.0361C15.1603 11.1486 15.8464 11.3173 16.4877 11.5422C17.129 11.7671 17.733 12.0402 18.2998 12.3614C18.8516 12.6827 19.2731 13.0641 19.5642 13.5055C19.8547 13.9476 20 14.4257 20 14.9398V18H16.5324ZM7.33781 9.90361C6.32364 9.90361 5.45861 9.51807 4.74273 8.74699C4.02685 7.9759 3.6689 7.04418 3.6689 5.95181C3.6689 4.85944 4.02685 3.92771 4.74273 3.15663C5.45861 2.38554 6.32364 2 7.33781 2C8.35198 2 9.217 2.38554 9.93289 3.15663C10.6488 3.92771 11.0067 4.85944 11.0067 5.95181C11.0067 7.04418 10.6488 7.9759 9.93289 8.74699C9.217 9.51807 8.35198 9.90361 7.33781 9.90361ZM16.5324 5.95181C16.5324 7.04418 16.1745 7.9759 15.4586 8.74699C14.7427 9.51807 13.8777 9.90361 12.8635 9.90361C12.6995 9.90361 12.4946 9.88337 12.2488 9.84289C12.0024 9.80305 11.7897 9.75101 11.6107 9.68675C12.0134 9.17269 12.323 8.59438 12.5396 7.95181C12.7556 7.30924 12.8635 6.64257 12.8635 5.95181C12.8635 5.26104 12.7556 4.59438 12.5396 3.95181C12.323 3.30924 12.0134 2.73092 11.6107 2.21687C11.8195 2.12048 12.0283 2.06008 12.2371 2.03566C12.4459 2.01189 12.6547 2 12.8635 2C13.8777 2 14.7427 2.38554 15.4586 3.15663C16.1745 3.92771 16.5324 4.85944 16.5324 5.95181ZM2.03579 15.8072H12.6398V15.1325C12.6398 14.9558 12.5987 14.7952 12.5163 14.6506C12.4346 14.506 12.3266 14.4016 12.1924 14.3374C11.4019 13.9036 10.604 13.5823 9.79866 13.3735C8.99329 13.1647 8.17301 13.0602 7.33781 13.0602C6.50261 13.0602 5.67875 13.1647 4.86622 13.3735C4.0531 13.5823 3.25876 13.9036 2.48322 14.3374C2.34899 14.4016 2.24072 14.506 2.15839 14.6506C2.07666 14.7952 2.03579 14.9558 2.03579 15.1325V15.8072ZM7.33781 7.80723C7.80015 7.80723 8.19925 7.62635 8.53512 7.26458C8.8704 6.90345 9.03803 6.46586 9.03803 5.95181C9.03803 5.43775 8.8704 5.00016 8.53512 4.63904C8.19925 4.27727 7.80015 4.09639 7.33781 4.09639C6.86055 4.09639 6.45399 4.27727 6.11812 4.63904C5.78285 5.00016 5.61521 5.43775 5.61521 5.95181C5.61521 6.4498 5.78285 6.88353 6.11812 7.25301C6.45399 7.62249 6.86055 7.80723 7.33781 7.80723Z"})))}var d=r.forwardRef(s);n.p},841:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var a=n(285),r=n(0),c=n(14),i=n(10),o=n(799),s=n(1),d=["isOpened","onClose","renderHeader"],u=function(e){var t=e.isOpened,n=e.onClose,u=e.renderHeader,l=Object(a.a)(e,d),j=Object(r.useContext)(i.AppContext).topBarHeight;return Object(s.jsx)(c.RightPane.Container,{contentTop:j,isOverlayTransparent:!0,isOpened:t,fixed:!0,onClose:n,children:Object(s.jsx)(c.RightPane.Content,{bg:"white",height:"calc(100% - ".concat(j,"px)"),width:620,children:Object(s.jsx)(o.a,{renderHeader:u,children:l.children})})})}}}]);