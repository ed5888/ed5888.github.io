(this["webpackJsonp@elamp/main-app"]=this["webpackJsonp@elamp/main-app"]||[]).push([[64],{1005:function(e,t,n){"use strict";n.d(t,"a",(function(){return f})),n.d(t,"b",(function(){return m})),n.d(t,"c",(function(){return b})),n.d(t,"d",(function(){return v})),n.d(t,"e",(function(){return p}));var i=n(17),s=n(285),a=n(0),r=n(61),l=n(14),o=n(10),c=n(1),u=["isRightBorderDisplay"],d=Object(r.default)(l.Box)((function(e){var t=e.isRightBorderDisplay,n=e.theme;return{height:o.DEFAULT_ROW_HEIGHT,overflow:"hidden",display:"flex",alignItems:"center",outline:"1px solid ".concat(n.colors.grey[2]),borderRight:t?"1px solid ".concat(n.colors.grey[2]):"none",width:"100%"}})),f=function(e){var t=e.isRightBorderDisplay,n=void 0!==t&&t,a=Object(s.a)(e,u);return Object(c.jsx)(d,Object(i.a)(Object(i.a)({isRightBorderDisplay:n},a),{},{children:a.children}))},j=Object(r.default)(l.Box)((function(){return{width:"100%",justifyContent:"flex-start",display:"flex"}})),m=function(){return Object(c.jsx)(f,{children:Object(c.jsx)(j,{p:1,children:Object(c.jsx)(l.Text,{children:"-"})})})},b=function(e){var t=e.skill,n=e.qualifier,i=e.readOnly,s=e.value,a=e.onChange;return Object(c.jsx)(f,{children:!i||"undefined"!==typeof s&&null!==s?Object(c.jsx)(o.QualifierValueEditableCell,{value:s,qualifier:{id:n.id,name:n.name,comparators:n.comparators,fields:n.fields,fieldType:n.fieldType},skill:{id:t.id,name:t.name,logo:t.libraryContext.logo,color:t.libraryContext.color,qualifiers:t.qualifiers,libraryContext:t.libraryContext},readOnly:i,onChange:a},n.id):Object(c.jsx)(l.Box,{width:"100%",justifyContent:"flex-start",p:1,children:Object(c.jsx)(l.Text,{children:"-"})})})},O=n(53),v=function(e){var t=e.onChange,n=e.value,i=Object(a.useState)(n||""),s=Object(O.a)(i,2),r=s[0],o=s[1];Object(a.useEffect)((function(){o(n||"")}),[n]);return Object(c.jsx)(l.TextArea,{value:r,onChange:o,rows:1,onBlur:function(){t(r)}})},p=function(e){var t=Object.assign({},e);return Object(c.jsx)(l.Column,{height:"100%",width:"100%",children:t.children})}},1558:function(e,t,n){"use strict";n.r(t);var i=n(285),s=n(17),a=n(53),r=n(0),l=n(15),o=n(61),c=n(14),u=n(63),d=n(287),f=n(10),j=n(3),m=n(187),b=n(23),O=n(1),v=["qualifiers","onSubmit","isOpened"],p=function(e){var t=e.qualifiers,n=e.onSubmit,l=e.isOpened,o=Object(i.a)(e,v),d=Object(r.useState)({}),j=Object(a.a)(d,2),p=j[0],h=j[1],y=Object(r.useState)(),x=Object(a.a)(y,2),g=x[0],k=x[1],C=Object(c.useTranslate)({capitalize:!0}),q=t.length>0&&0===Object.values(p).length&&!g;Object(r.useEffect)((function(){l||(h({}),k(void 0))}),[l]);return Object(O.jsx)(f.FormContainerModal,Object(s.a)(Object(s.a)({title:C("bulk_fill_values"),onConfirm:function(){n({qualifiersValues:Object.entries(p).map((function(e){var t=Object(a.a)(e,2);return{id:t[0],value:t[1]}})),comment:g})},onCancel:o.onClose,isDisabledSubmit:q,isOpened:l,width:700,height:650},o),{},{children:Object(O.jsxs)(c.Box,{overflow:"auto",flex:1,children:[Object(O.jsx)(c.Text,{mb:1,children:C("two_points",{phrase:Object(b.maj)(C("bulk_fill_values_description"))})}),t.map((function(e){return Object(O.jsx)(c.Box,{mb:1,children:Object(O.jsx)(u.QualifierEditable,{value:p[e.id],onChange:(t=e.id,function(e){h((function(n){return Object(s.a)(Object(s.a)({},n),{},Object(m.a)({},t,e))}))}),qualifier:e})},e.id);var t})),Object(O.jsx)(c.Label,{content:C("comment"),name:"comment",children:Object(O.jsx)(c.TextArea,{value:g,onChange:k})})]})}))},h=n(65),y=n(45),x=n(939),g=n(188),k=n(19),C=function(e){return{id:e.id,name:e.name,description:Object(k.maybeToOptional)(e.description),libraryContext:Object(k.getFormatedLibraryBasicFragment)(e.libraryContext),qualifiers:e.qualifiers.nodes.map((function(e){var t;return{id:e.id,name:e.name,fields:(null===(t=e.fields)||void 0===t?void 0:t[0])?[{decorators:e.fields[0].decorators,options:e.fields[0].options,validators:e.fields[0].validators}]:void 0,comparators:Object(k.maybeToOptional)(e.comparators),fieldType:e.fieldType}}))}},q=function(e){return{id:e.id,displayName:e.displayName,avatarURL:Object(k.maybeToOptional)(e.avatarURL),familyName:Object(k.maybeToOptional)(e.familyName),givenName:Object(k.maybeToOptional)(e.givenName)}},_=n(1005),S=n(745),I=["jobName","titleHeight"],T=function(e){var t=e.jobName,n=e.titleHeight,a=Object(i.a)(e,I),r=Object(h.h)();return Object(O.jsxs)(c.Column,Object(s.a)(Object(s.a)({width:"100%",height:"100%",justifyContent:"flex-end"},a),{},{border:"1px solid ".concat(r.colors.grey[2]),children:[Object(O.jsx)(c.Line,{height:"calc(100% - ".concat(n,"px)"),children:Object(O.jsx)(c.Icon,{as:S.a,size:24})}),Object(O.jsx)(c.Line,{p:20,justifyContent:"center",alignItems:"center",height:n,borderTop:"1px solid ".concat(r.colors.grey[2]),width:"100%",children:Object(O.jsx)(c.Text,{color:"grey.6",fontWeight:"bold",textTransform:"uppercase",children:t})})]}))},R=["skills","assessors","evaluatedUser","onChangeComment","onChangeQualifierValue","poweredValues","jobsRequirements","validatedSkills","assessorsResults"],w={manager:"manager_title",peer:"peer_title",self:"self_assessment_title"},L=function(e){var t=e.skills,n=e.assessors,a=e.evaluatedUser,r=e.onChangeComment,l=e.onChangeQualifierValue,o=e.poweredValues,u=e.jobsRequirements,d=e.validatedSkills,j=e.assessorsResults,m=Object(i.a)(e,R),b=Object(c.useTranslate)({capitalize:!0}),v=Object(h.h)(),p=t.map((function(e){return(e.qualifiers.length+1)*f.DEFAULT_ROW_HEIGHT})),g=function(e){var t=e.skillId,n=e.qualifierId;return function(e){l({skillId:t,qualifierId:n,value:e})}};var k=t.length;return Object(O.jsx)(O.Fragment,{children:Object(O.jsx)(c.Box,Object(s.a)(Object(s.a)({height:"calc(100% - 60px)",display:"flex",flexDirection:"column",width:"100%"},m),{},{children:Object(O.jsx)(f.TableContent,{rows:t||[],fixedColumnCount:2,columns:function(){var e=[{dataKey:"skill",headerTitle:"",isSortable:!1,isIcon:!1,columnWidth:440,cellRenderer:function(e){var t=e.node;return Object(O.jsxs)(c.Line,{width:"100%",justifyContent:"space-between",children:[Object(O.jsx)(f.SkillNameWithIconAndDescriptionCell,{skill:{name:t.name,description:t.description,libraryContext:{logo:t.libraryContext.logo,color:t.libraryContext.color}},size:"large"}),t.qualifiers.length>0&&Object(O.jsxs)(c.Column,{width:140,children:[t.qualifiers.map((function(e){return Object(O.jsx)(_.a,{children:Object(O.jsx)(f.LongTextCell,{text:e.name,isTwoLines:!0})},"".concat(t.id,"_").concat(e.id))})),Object(O.jsx)(_.a,{children:Object(O.jsx)(f.LongTextCell,{text:b("comment")},"".concat(t.id,"_comment"))})]})]})}},{dataKey:"finalResults",headerTitle:b("final_evaluation"),headerRenderer:function(){return Object(O.jsx)(x.a,{user:{id:a.id,displayName:a.displayName,avatarURL:a.avatarURL,familyName:a.familyName,givenName:a.givenName},title:b("final_evaluation"),titleColor:v.colors.primary[3],titleHeight:f.DEFAULT_ROW_HEIGHT})},isSortable:!1,isIcon:!1,style:{backgroundColor:v.colors.primary[0]},columnWidth:Object(y.b)("large"),cellRenderer:function(e){var t,n=e.node;if(n.qualifiers.length>0){var i=function(e){var t,n=e.validatedSkills,i=e.skillId;return null===(t=n.find((function(e){return e.id===i})))||void 0===t?void 0:t.comment}({validatedSkills:d,skillId:n.id});return Object(O.jsxs)(_.e,{children:[n.qualifiers.map((function(e){var t=function(e){var t,n,i=e.validatedSkills,s=e.skillId,a=e.qualifierId;return null===(t=i.find((function(e){return e.id===s})))||void 0===t||null===(n=t.qualifiers.find((function(e){return e.id===a})))||void 0===n?void 0:n.value}({validatedSkills:d,skillId:n.id,qualifierId:e.id});return Object(O.jsx)(_.c,{skill:n,qualifier:e,value:t,onChange:g({skillId:n.id,qualifierId:e.id})},"finalResult_".concat(e.id))})),Object(O.jsx)(_.a,{p:1,width:"100%",children:Object(O.jsx)(_.d,{value:i,onChange:(t=n.id,function(e){r({skillId:t,comment:e})})})})]})}return Object(O.jsx)(c.Line,{width:"100%",height:"100%",bg:"grey.0"})}}];return j.forEach((function(t){var i=n[t.assessor.id];i&&e.push({dataKey:i.id,headerTitle:i.displayName,headerRenderer:function(){return Object(O.jsx)(x.a,{user:{id:i.id,displayName:i.displayName,avatarURL:i.avatarURL,familyName:i.familyName,givenName:i.givenName},title:b(w[i.assessorType]),titleColor:v.colors.grey[6],titleHeight:f.DEFAULT_ROW_HEIGHT})},isSortable:!1,isIcon:!1,columnWidth:Object(y.b)("large"),cellRenderer:function(e){var n=e.node,s=function(e){var t,n=e.assessorResults,i=e.skillId;return null===(t=n.find((function(e){return e.id===i})))||void 0===t?void 0:t.comment}({assessorResults:t.results,skillId:n.id});return Object(O.jsxs)(_.e,{children:[n.qualifiers.length>0&&n.qualifiers.map((function(e){var s=function(e){var t,n,i=e.assessorResults,s=e.skillId,a=e.qualifierId;return null===(t=i.find((function(e){return e.id===s})))||void 0===t||null===(n=t.qualifiers.find((function(e){return e.id===a})))||void 0===n?void 0:n.value}({assessorResults:t.results,skillId:n.id,qualifierId:e.id});return Object(O.jsx)(_.c,{skill:n,qualifier:e,value:s,readOnly:!0},"assessorValue_".concat(i.id,"_").concat(e.id))})),Object(O.jsx)(_.a,{children:"undefined"!==typeof s?Object(O.jsx)(f.LongTextCell,{isTwoLines:!0,text:s}):Object(O.jsx)(_.b,{})})]})}})})),e.push({dataKey:"poweredValues",headerTitle:b("current_values"),headerRenderer:function(){return Object(O.jsx)(x.a,{user:{id:a.id,displayName:a.displayName,avatarURL:a.avatarURL,familyName:a.familyName,givenName:a.givenName},title:b("current_values"),titleColor:v.colors.grey[6],titleHeight:f.DEFAULT_ROW_HEIGHT})},isSortable:!1,isIcon:!1,style:{backgroundColor:v.colors.grey[0]},columnWidth:Object(y.b)("large"),cellRenderer:function(e){var t=e.node;return t.qualifiers.length>0?Object(O.jsxs)(_.e,{children:[t.qualifiers.map((function(e){var n=function(e){var t,n,i=e.poweredValues,s=e.skillId,a=e.qualifierId;return null===(t=i.find((function(e){return e.id===s})))||void 0===t||null===(n=t.qualifiers.find((function(e){return e.id===a})))||void 0===n?void 0:n.value}({poweredValues:o,skillId:t.id,qualifierId:e.id});return Object(O.jsx)(_.c,{skill:t,qualifier:e,value:n,readOnly:!0},"poweredValue_".concat(e.id))})),Object(O.jsx)(_.b,{})]}):Object(O.jsx)(c.Line,{width:"100%",height:"100%",bg:"grey.0"})}}),"undefined"!==typeof u&&u.forEach((function(t){e.push({dataKey:"job_".concat(t.job),headerTitle:t.job.name,headerRenderer:function(){return Object(O.jsx)(T,{jobName:t.job.name,titleHeight:f.DEFAULT_ROW_HEIGHT})},isSortable:!1,isIcon:!1,style:{backgroundColor:v.colors.grey[0]},columnWidth:Object(y.b)("large"),cellRenderer:function(e){var n=e.node;return n.qualifiers.length>0?Object(O.jsxs)(_.e,{children:[n.qualifiers.map((function(e){var i=function(e){var t,n,i=e.jobRequirements,s=e.skillId,a=e.qualifierId;return null===(t=i.requirements.find((function(e){return e.id===s})))||void 0===t||null===(n=t.qualifiers.find((function(e){return e.id===a})))||void 0===n?void 0:n.value}({jobRequirements:t,skillId:n.id,qualifierId:e.id});return Object(O.jsx)(_.c,{skill:n,qualifier:e,value:i,readOnly:!0},"jobRequirementValue_".concat(t.job.id,"_").concat(n.id,"_").concat(e.id))})),Object(O.jsx)(_.b,{})]}):Object(O.jsx)(c.Line,{width:"100%",height:"100%",bg:"grey.0"})}})})),e}(),isLoading:!1,noRowsRenderer:function(){return Object(O.jsx)(c.Column,{width:"100%",height:"100%",justifyContent:"center",children:Object(O.jsx)(c.Text,{color:"grey.5",fontSize:"big",fontWeight:"semiBold",children:b("no_skill_to_display")})})},totalRowCount:k,rowHeight:function(e){var t=e.index;return p[t]||f.DEFAULT_ROW_HEIGHT},headerHeight:150})}))})},E=n(139),N=n.n(E),U=n(286),V=n(115),A=n(32),F=n(122),M=n(121),H=n(743),B=function(e){var t=e.assessmentId,n=Object(r.useState)(),i=Object(a.a)(n,2),l=i[0],o=i[1],c=Object(r.useState)(),u=Object(a.a)(c,2),d=u[0],f=u[1],j=Object(r.useState)(!1),b=Object(a.a)(j,2),O=b[0],v=b[1],p=Object(r.useState)(),h=Object(a.a)(p,2),y=h[0],x=h[1],_=Object(V.a)(),S=Object(H.a)().redirectToEntity404,I=Object(k.useGetAssessmentResultsQuery)({variables:{id:t},onError:function(e){return S({entity:M.d.Assessment,error:e})}}),T=I.data,R=I.loading,w=(I.refetch,Object(k.useUpdateAssessmentValidatedSkillsMutation)()),L=Object(a.a)(w,2),E=L[0],B=L[1].loading,D=Object(r.useMemo)((function(){if(null===T||void 0===T?void 0:T.assessment)return{name:T.assessment.name,status:T.assessment.status,startDate:T.assessment.startDate,updatedAt:T.assessment.updatedAt,updatedBy:T.assessment.updatedBy?{displayName:T.assessment.updatedBy.displayName}:void 0}}),[T]),W=Object(r.useMemo)((function(){if(null===T||void 0===T?void 0:T.assessment)return function(e){return"AssessmentSkillsFromList"===e.__typename?e.selectedSkills||[]:"AssessmentSkillsFromEvaluatedUserJobs"===e.__typename&&(null===(t=e.userJobs)||void 0===t?void 0:t.flatMap((function(e){var t,n,i=(null===(t=e.pattern)||void 0===t?void 0:t.must.map((function(e){return e.skill})))||[],s=(null===(n=e.pattern)||void 0===n?void 0:n.should.map((function(e){return e.skill})))||[];return[].concat(Object(g.a)(i),Object(g.a)(s))})))||[];var t}(T.assessment.skillsScope).map((function(e){return C(e)}))}),[T]),G=Object(r.useMemo)((function(){var e,t;if("AssessmentSkillsFromEvaluatedUserJobs"===(null===T||void 0===T||null===(e=T.assessment)||void 0===e?void 0:e.skillsScope.__typename))return null===(t=T.assessment.skillsScope.userJobs)||void 0===t?void 0:t.map((function(e){var t,n;return{job:{id:e.id,name:e.name},requirements:[].concat(Object(g.a)((null===(t=e.pattern)||void 0===t?void 0:t.must)||[]),Object(g.a)((null===(n=e.pattern)||void 0===n?void 0:n.should)||[])).map((function(e){return{id:e.skill.id,qualifiers:e.qualifiers.map((function(e){return{id:e.qualifier.id,value:e.value}}))}}))}}))}),[T]),P=Object(r.useMemo)((function(){var e;if(null===T||void 0===T||null===(e=T.assessment)||void 0===e?void 0:e.validatedSkills)return T.assessment.validatedSkills.map((function(e){return C(e.skill)}))}),[T]),Q=Object(r.useMemo)((function(){var e;if((null===T||void 0===T||null===(e=T.assessment)||void 0===e?void 0:e.assessmentRows)&&"undefined"!==typeof W){var t=W.map((function(e){return e.id}));return T.assessment.assessmentRows.flatMap((function(e){return(e.validatedSkills||[]).filter((function(e){return!t.includes(e.skill.id)})).map((function(e){return C(e.skill)}))}))}}),[T,W]);Object(r.useEffect)((function(){if("undefined"!==typeof W&&"undefined"!==typeof P&&"undefined"!==typeof Q){var e=Object.fromEntries([].concat(Object(g.a)(W||[]),Object(g.a)(P||[]),Object(g.a)(Q||[])).map((function(e){return[e.id,e]})));x(Object.values(e))}}),[W,P,Q]);var z=Object(r.useMemo)((function(){var e;return(null===T||void 0===T||null===(e=T.assessment)||void 0===e?void 0:e.assessmentRows)?T.assessment.assessmentRows.filter((function(e){return e.assessors.edges.length>0})).map((function(e){return{assessorId:e.assessors.edges[0].node.id,validatedSkills:(e.validatedSkills||[]).map((function(e){return{id:e.skill.id,qualifiers:e.qualifiers.edges.map((function(e){return{id:e.node.id,value:e.value}})),comment:Object(k.maybeToOptional)(e.comment)}}))}})).filter((function(e){return e.validatedSkills.some((function(e){var t=e.qualifiers.some((function(e){return"undefined"!==typeof e.value})),n="undefined"!==typeof e.comment&&e.comment.length>0;return t||n}))})).reduce((function(e,t){return Object(s.a)(Object(s.a)({},e),{},Object(m.a)({},t.assessorId,t.validatedSkills))}),{}):{}}),[T]),J=Object(r.useMemo)((function(){if(null===T||void 0===T?void 0:T.assessment){var e=[A.AssessorType.PEER,A.AssessorType.MANAGER,A.AssessorType.SELF];return T.assessment.assessors.edges.map((function(e){return Object(s.a)(Object(s.a)({},q(e.node)),{},{assessorType:e.assessorAuthority})})).sort((function(t,n){return e.indexOf(t.assessorType)-e.indexOf(n.assessorType)})).reduce((function(e,t){return Object(s.a)(Object(s.a)({},e),{},Object(m.a)({},t.id,t))}),{})}return{}}),[T]),K=Object(r.useMemo)((function(){return Object.entries(J).reduce((function(e,t){var n=Object(a.a)(t,2),i=n[0],s=n[1];return"undefined"!==typeof z[i]?[].concat(Object(g.a)(e),[{assessor:s,results:z[i]}]):e}),[])}),[z,J]),X=Object(r.useMemo)((function(){if(null===T||void 0===T?void 0:T.assessment)return q(T.assessment.evaluatedUser)}),[T]);Object(r.useEffect)((function(){if(y&&X){var e=y.map((function(e){return e.id})).map((function(e){return _.query({query:k.GetUserPoweredValueDocument,variables:{skillId:e,userId:X.id}})}));v(!0),Promise.all(e).then((function(e){var t=[];e.forEach((function(e){var n,i,s=null===(n=e.data)||void 0===n||null===(i=n.user)||void 0===i?void 0:i.power;(null===s||void 0===s?void 0:s.id)&&t.push({id:s.skill.id,qualifiers:s.qualifiers.edges.map((function(e){return{id:e.node.id,value:e.value}}))})})),f(t),v(!1)}))}}),[y,X]),Object(r.useEffect)((function(){var e;if("undefined"===typeof l&&(null===T||void 0===T||null===(e=T.assessment)||void 0===e?void 0:e.validatedSkills)&&y){var t=T.assessment.validatedSkills.reduce((function(e,t){return Object(s.a)(Object(s.a)({},e),{},Object(m.a)({},t.skill.id,{qualifiers:t.qualifiers.edges.reduce((function(e,t){return Object(s.a)(Object(s.a)({},e),{},Object(m.a)({},t.node.id,t.value))}),{}),comment:Object(k.maybeToOptional)(t.comment)}))}),{}),n=y.reduce((function(e,n){var i;return Object(s.a)(Object(s.a)({},e),{},Object(m.a)({},n.id,{comment:null===(i=t[n.id])||void 0===i?void 0:i.comment,qualifiers:n.qualifiers.reduce((function(e,i){var a;return Object(s.a)(Object(s.a)({},e),{},Object(m.a)({},i.id,null===(a=t[n.id])||void 0===a?void 0:a.qualifiers[i.id]))}),{})}))}),{});o(n)}}),[T,y]);var Y=Object(r.useMemo)((function(){if(l)return Object.entries(l).map((function(e){var t=Object(a.a)(e,2),n=t[0],i=t[1];return{id:n,comment:i.comment,qualifiers:Object.entries(i.qualifiers).map((function(e){var t=Object(a.a)(e,2);return{id:t[0],value:t[1]}}))}}))}),[l]),Z=function(e,t){if("undefined"!==typeof y){var n=y.reduce((function(n,i){var a,r=e.find((function(e){return e.id===i.id})),o=((null===r||void 0===r?void 0:r.qualifiers)||[]).reduce((function(e,t){return Object(s.a)(Object(s.a)({},e),{},Object(m.a)({},t.id,t.value))}),{}),c=t?null===r||void 0===r?void 0:r.comment:null===l||void 0===l||null===(a=l[i.id])||void 0===a?void 0:a.comment;return Object(s.a)(Object(s.a)({},n),{},Object(m.a)({},i.id,{comment:c,qualifiers:i.qualifiers.reduce((function(e,t){return Object(s.a)(Object(s.a)({},e),{},Object(m.a)({},t.id,o[t.id]))}),{})}))}),{});o(n)}},$=function(){var e=Object(U.a)(N.a.mark((function e(){var n,i;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Y){e.next=4;break}return n=Y.filter((function(e){var t=e.qualifiers.some((function(e){return"undefined"!==typeof e.value&&e.value!==F.QUALIFIER_MULTI_VALUE_NULL_INPUT_VALUE})),n="string"===typeof e.comment&&e.comment.length>0;return t||n})),i=n.map((function(e){var t={id:e.id,qualifiers:e.qualifiers.filter((function(e){return"undefined"!==typeof e.value&&e.value!==F.QUALIFIER_MULTI_VALUE_NULL_INPUT_VALUE}))};return"string"===typeof e.comment&&(t.comment=e.comment),t})),e.abrupt("return",E({variables:{assessmentId:t,validatedSkills:i.map((function(e){return{skill:e.id,comment:e.comment,qualifiers:e.qualifiers}}))}}));case 4:return e.abrupt("return");case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ee=function(){var e=Object(U.a)(N.a.mark((function e(){return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",$());case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(r.useEffect)((function(){"undefined"!==typeof Y&&Y.length>0&&$()}),[Y]),{isLoading:R||O,isUpdatingAssessmentSkills:B,assessmentHeaderInfos:D,validatedSkills:Y,skills:y,poweredValues:d,jobsRequirements:G,assessorsResults:K,evaluatedUser:X,assessors:J,changeQualifierValue:function(e){var t=e.skillId,n=e.qualifierId,i=e.value;if(l){var a,r=Object(s.a)({},l);r[t]=Object(s.a)(Object(s.a)({},l[t]||{comment:void 0}),{},{qualifiers:Object(s.a)(Object(s.a)({},(null===(a=l[t])||void 0===a?void 0:a.qualifiers)||{}),{},Object(m.a)({},n,i))}),o(r)}},changeComment:function(e){var t=e.skillId,n=e.comment;if(null===l||void 0===l?void 0:l[t]){var i=Object(s.a)(Object(s.a)({},l),{},Object(m.a)({},t,Object(s.a)(Object(s.a)({},l[t]),{},{comment:n})));o(i)}},addSkill:function(e){_.query({query:k.GetSkillToAddToAssessmentDocument,variables:{id:e}}).then((function(e){var t;if(null===(t=e.data)||void 0===t?void 0:t.skill){var n,i=C(null===(n=e.data)||void 0===n?void 0:n.skill);y&&!y.find((function(e){return e.id===i.id}))&&x([i].concat(Object(g.a)(y)))}}))},fillCommonValues:function(e){var t=e.qualifiers,n=e.comment;if(l){var i=Object.fromEntries(t.map((function(e){return[e.id,e.value]}))),r=Object.entries(l).reduce((function(e,t){var r=Object(a.a)(t,2),l=r[0],o=r[1];return Object(s.a)(Object(s.a)({},e),{},Object(m.a)({},l,{comment:n||o.comment,qualifiers:Object.fromEntries(Object.entries(o.qualifiers).map((function(e){var t=Object(a.a)(e,2),n=t[0],s=t[1];return[n,i[n]||s]})))}))}),{});o(r)}},fillCurrentValuesFromAssessorResults:function(e,t){var n=z[e];"undefined"!==typeof n&&Z(n,t)},fillCurrentValuesFromPowers:function(e){"undefined"!==typeof d&&Z(d,e)},resetValues:function(){if(l){var e=Object.entries(l).reduce((function(e,t){var n=Object(a.a)(t,2),i=n[0],r=n[1];return Object(s.a)(Object(s.a)({},e),{},Object(m.a)({},i,{comment:void 0,qualifiers:Object.entries(r.qualifiers).reduce((function(e,t){var n=Object(a.a)(t,1)[0];return Object(s.a)(Object(s.a)({},e),{},Object(m.a)({},n,void 0))}),{})}))}),{});o(e)}},updateValidatedSkills:ee}},D=["onCancel","onValidate","isValidating"],W=Object(o.default)(c.Text)((function(){return{whiteSpace:"break-spaces"}})),G=Object(o.default)(c.Line)((function(e){var t=e.theme;return{borderTop:"1px solid ".concat(t.colors.grey[2])}})),P=function(e){var t=e.onCancel,n=e.onValidate,a=e.isValidating,r=Object(i.a)(e,D),l=Object(c.useTranslate)({capitalize:!0});return Object(O.jsxs)(G,Object(s.a)(Object(s.a)({width:"100%",py:1,px:20,justifyContent:"flex-end"},r),{},{children:[Object(O.jsx)(c.Button,{onClick:t,appearance:"outline",mr:1,children:l("cancel")}),Object(O.jsx)(c.Button,{onClick:n,isLoading:a,children:l("validate_evaluations")})]}))};t.default=function(e){var t=e.tabsOptions,n=Object(r.useState)(),i=Object(a.a)(n,2),o=i[0],m=i[1],b=Object(l.useParams)().assessmentId,v=Object(f.useAppContext)(),h=v.getErrorMessage,y=v.setTabsOptions,x=Object(l.useHistory)(),g=Object(c.useTranslate)(),k=Object(c.useSwitch)(),C=Object(c.useSwitch)(),q=Object(c.useSwitch)(),_=Object(c.useSwitch)(),S=Object(c.useAlert)(),I=B({assessmentId:b}),T=I.isLoading,R=I.isUpdatingAssessmentSkills,w=I.assessmentHeaderInfos,E=I.skills,N=I.assessors,U=I.assessorsResults,V=I.evaluatedUser,A=I.poweredValues,F=I.jobsRequirements,M=I.validatedSkills,H=I.changeQualifierValue,D=I.changeComment,G=I.resetValues,Q=I.fillCommonValues,z=I.fillCurrentValuesFromAssessorResults,J=I.fillCurrentValuesFromPowers,K=I.addSkill,X=I.updateValidatedSkills;Object(r.useEffect)((function(){return y(t),function(){y(void 0)}}),[]),Object(r.useEffect)((function(){"undefined"!==typeof o&&_.on()}),[o]),Object(r.useEffect)((function(){_.active||m(void 0)}),[_.active]);var Y=Object(r.useMemo)((function(){return"assessor"===(null===o||void 0===o?void 0:o.source)&&"undefined"!==typeof N?N[o.assessorId].displayName:"powers"===(null===o||void 0===o?void 0:o.source)?"current_values":void 0}),[o,N]),Z=Object(r.useMemo)((function(){if(E)return Object.values(Object.fromEntries(E.flatMap((function(e){return e.qualifiers})).map((function(e){return[e.id,e]}))))}),[E]),$=Object(r.useMemo)((function(){if("undefined"!==typeof E)return Object(d.getSortedSkills)(E)}),[E]),ee=function(){V&&x.push(j.b.USER_PROFILE_ASSESSMENT.getRoute({assessmentId:b,userId:V.id}))};return T||"undefined"===typeof w||"undefined"===typeof $||"undefined"===typeof U||"undefined"===typeof N||"undefined"===typeof V||"undefined"===typeof A||"undefined"===typeof M?Object(O.jsx)(c.Loader,{}):Object(O.jsxs)(O.Fragment,{children:[Object(O.jsxs)(c.Column,{width:"100%",height:"100%",alignItems:"flex-start",children:[Object(O.jsxs)(c.Line,{mb:0,px:1,flex:0,children:[Object(O.jsx)(c.Popover,{isOpened:k.active,onClose:k.off,content:Object(O.jsx)(u.SkillsNavigator,{blockLibrarySelection:!0,buttonLabel:g("add"),onSubmit:function(e){var t=Object(a.a)(e,1)[0];K(t.id)},isSkillWithChildrenSelectionBlocked:!0}),children:Object(O.jsx)(c.Button,{onClick:k.on,mr:1,children:g("add_a_something",{object:g("a_skill",1)})})}),Object(O.jsxs)(c.MenuSelect.Target,{m:2,children:[Object(O.jsx)(c.Button,{onClick:C.on,mr:1,appearance:"outline",accent:"grey",children:g("bulk_fill_values")}),Object(O.jsxs)(c.MenuSelect,{onClose:C.off,isOpened:C.active,children:[U.map((function(e){return Object(O.jsx)(c.MenuOption,{onClick:(t=e.assessor.id,function(){C.off(),m({source:"assessor",assessorId:t,isFillComment:!1})}),children:g("copy_assessor_evaluation",{assessorName:e.assessor.displayName})},"assessor_menuOption_".concat(e.assessor.id));var t})),Object(O.jsx)(c.MenuOption,{onClick:function(){C.off(),m({source:"powers",isFillComment:!1})},children:g("copy_evaluated_user_current_values")}),Object(O.jsx)(c.MenuOption,{onClick:function(){C.off(),q.on()},children:g("enter_common_values")})]})]}),Object(O.jsx)(c.Button,{onClick:function(){G()},appearance:"outline",accent:"grey",children:g("reinitialize")})]}),Object(O.jsx)(L,{skills:$,assessorsResults:U,assessors:N,evaluatedUser:V,onChangeComment:D,onChangeQualifierValue:H,poweredValues:A,jobsRequirements:F,validatedSkills:M,flex:1}),Object(O.jsx)(P,{onValidate:function(){X().then((function(){ee()})).catch((function(e){ee(),S.error(h(e))}))},onCancel:function(){ee()},isValidating:R,flex:0})]}),Object(O.jsx)(p,{isOpened:q.active,onClose:q.off,qualifiers:Z||[],onSubmit:function(e){var t=e.qualifiersValues,n=e.comment;Q({qualifiers:t,comment:n}),q.off()}}),Object(O.jsx)(c.ConfirmModal,{isOpened:_.active,onCancel:_.off,onConfirm:function(){"assessor"===(null===o||void 0===o?void 0:o.source)?z(o.assessorId,o.isFillComment):"powers"===(null===o||void 0===o?void 0:o.source)&&J(o.isFillComment),_.off()},children:Object(O.jsxs)(c.Box,{display:"flex",flexDirection:"column",justifyContent:"flex-start",children:[Object(O.jsx)(W,{fontSize:"large",children:"undefined"!==typeof o&&g("assessment_fill_values_with_column_confirm_message",{columnName:Y})}),Object(O.jsxs)(c.Text,{as:"label",name:"isFillComment",fontWeight:"semiBold",mt:2,ml:1,children:[Object(O.jsx)(c.Checkbox,{checked:null===o||void 0===o?void 0:o.isFillComment,onChange:function(e){"undefined"!==typeof o&&"boolean"===typeof e&&m(Object(s.a)(Object(s.a)({},o),{},{isFillComment:e}))},mr:1}),g("also_copy_comments")]})]})})]})}},939:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var i=n(17),s=n(285),a=(n(0),n(14)),r=n(63),l=n(65),o=n(1),c=["user","title","titleColor","titleHeight"],u=function(e){var t=e.user,n=e.title,u=e.titleColor,d=e.titleHeight,f=Object(s.a)(e,c),j=Object(l.h)();return Object(o.jsxs)(a.Column,Object(i.a)(Object(i.a)({width:"100%",height:"100%",justifyContent:"space-between"},f),{},{border:"1px solid ".concat(j.colors.grey[2]),children:[Object(o.jsx)(r.UserBasicInfo,{user:{id:t.id,displayName:t.displayName,avatarURL:t.avatarURL,familyName:t.familyName,givenName:t.givenName},display:"flex",flexDirection:"column",height:"calc(100% - ".concat(d,"px)"),justifyContent:"center"}),Object(o.jsx)(a.Line,{p:20,justifyContent:"center",alignItems:"center",height:d,borderTop:"1px solid ".concat(j.colors.grey[2]),width:"100%",children:Object(o.jsx)(a.Text,{color:u,fontWeight:"bold",textTransform:"uppercase",children:n})})]}))}}}]);