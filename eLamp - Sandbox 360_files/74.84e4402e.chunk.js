(this["webpackJsonp@elamp/main-app"]=this["webpackJsonp@elamp/main-app"]||[]).push([[74],{1528:function(e,t,s){"use strict";s.r(t),s.d(t,"sortableCustomFieldsFieldsType",(function(){return m}));var l=s(17),r=s(53),n=s(0),a=s(15),o=s(14),i=s(19),u=s(414),d=s(45),c=s(10),b=s(3),v=s(1),m=["BOOLEAN","DATE","MULTIVALUES","NUMERIC","TEXT"],w=function(e){return((null===e||void 0===e?void 0:e.edges)||[]).map((function(e){var t,s,l,r,n,a,o,u,d,c,b,v,m,w,h,C,j,f,S,R,p,O,x,y,_,g,k,T,F,L;return{userBasicInfos:Object(i.getFormatedUserBasicFragment)(e.node),experiences:(null===(t=e.node.experiences)||void 0===t?void 0:t.length)||0,poweredSkillsCount:e.node.poweredSkillsCount,externalId:Object(i.maybeToOptional)(e.node.externalId),groups:e.node.groups.nodes.map((function(e){return{kind:"groupTag",id:e.id,name:e.name}})),lastLoginAt:Object(i.maybeToOptional)(e.node.lastLoginAt),nextAvailability:e.node.nextAvailability,managers:e.node.managers.nodes.map((function(e){return Object(i.getFormatedUserBasicFragment)(e)})),skillsReviewsStats:{powersTotalCount:(null===(s=e.node.skillsReviewsStats)||void 0===s?void 0:s.powersTotalCount)||0,evaluatedPowersCount:(null===(l=e.node.skillsReviewsStats)||void 0===l?void 0:l.evaluatedPowersCount)||0,validatedPowersCount:(null===(r=e.node.skillsReviewsStats)||void 0===r?void 0:r.validatedPowersCount)||0,self:{powersCount:(null===(n=e.node.skillsReviewsStats)||void 0===n?void 0:n.self.powersCount)||0,powersCountByLastThreeMonths:(null===(a=e.node.skillsReviewsStats)||void 0===a?void 0:a.self.powersCountByLastThreeMonths)||0,lastReview:Object(i.maybeToOptional)(null===(o=e.node.skillsReviewsStats)||void 0===o?void 0:o.self.lastReview)},other:{powersCount:(null===(u=e.node.skillsReviewsStats)||void 0===u?void 0:u.other.powersCount)||0,powersCountByLastThreeMonths:(null===(d=e.node.skillsReviewsStats)||void 0===d?void 0:d.other.powersCountByLastThreeMonths)||0,lastReview:Object(i.maybeToOptional)(null===(c=e.node.skillsReviewsStats)||void 0===c?void 0:c.other.lastReview)},currentJobsStats:{skillsCount:(null===(b=e.node.skillsReviewsStats)||void 0===b||null===(v=b.currentJobsStats)||void 0===v?void 0:v.skillsCount)||0,powersCount:(null===(m=e.node.skillsReviewsStats)||void 0===m||null===(w=m.currentJobsStats)||void 0===w?void 0:w.powersCount)||0,validatedPowersCount:(null===(h=e.node.skillsReviewsStats)||void 0===h||null===(C=h.currentJobsStats)||void 0===C?void 0:C.validatedPowersCount)||0,self:{powersCount:(null===(j=e.node.skillsReviewsStats)||void 0===j||null===(f=j.currentJobsStats)||void 0===f?void 0:f.self.powersCount)||0,powersCountByLastThreeMonths:(null===(S=e.node.skillsReviewsStats)||void 0===S||null===(R=S.currentJobsStats)||void 0===R?void 0:R.self.powersCountByLastThreeMonths)||0,lastReview:Object(i.maybeToOptional)(null===(p=e.node.skillsReviewsStats)||void 0===p||null===(O=p.currentJobsStats)||void 0===O?void 0:O.self.lastReview)},other:{powersCount:(null===(x=e.node.skillsReviewsStats)||void 0===x||null===(y=x.currentJobsStats)||void 0===y?void 0:y.other.powersCount)||0,powersCountByLastThreeMonths:(null===(_=e.node.skillsReviewsStats)||void 0===_||null===(g=_.currentJobsStats)||void 0===g?void 0:g.other.powersCountByLastThreeMonths)||0,lastReview:Object(i.maybeToOptional)(null===(k=e.node.skillsReviewsStats)||void 0===k||null===(T=k.currentJobsStats)||void 0===T?void 0:T.other.lastReview)}}},pinnedJobs:null===(F=e.node.pinnedJobs)||void 0===F||null===(L=F.edges)||void 0===L?void 0:L.map((function(e){return"have"===e.status?{kind:"jobTag",id:e.node.id,name:e.node.name}:{kind:void 0}})),customFields:e.node.customFields}}))},h=function(e,t){var s=[{name:e("my_subalterns"),filters:{team_users:{managedBy:{managedBy:["me"]}}}},{name:e("all_my_subalterns"),filters:{team_users:{managedBy:{managedByWithHierarchy:["me"]}}}}];return t.length>0&&s.push({name:e("my_entities"),filters:{team_users:{groups:{inValues:t}}}}),s};t.default=function(){var e,t=Object(o.useTranslate)({capitalize:!0}),s=Object(o.useAlert)(),C=Object(a.useHistory)(),j=Object(c.useAppContext)(),f=j.checkLayout,S=j.customFields,R=j.getErrorMessage,p=j.userGroups,O=j.userPreferences,x=j.usersManagedByMe,y=Object(n.useState)(),_=Object(r.a)(y,2),g=_[0],k=_[1],T=Object(c.useFilters)({category:c.UserSavedDataFiltersEnum.MyTeamUsers,defaultEntity:"team_users",defaultFilter:{team_users:x.length>0?{managedBy:{managedBy:["me"]}}:{groups:{inValues:p}}},defaultSelectedFilterName:x.length>0?t("my_subalterns"):t("my_entities"),entities:["team_users"],initialStandardFilters:h(t,p),mergeFilters:function(e){return e},savedDataFilters:null===O||void 0===O?void 0:O.savedDataFilters}),F=T.dataFilters,L=T.localStorageLabel,D=T.standardFilters,M=T.createAdvancedFilter,J=T.updateAdvancedFilter,B=T.deleteAdvancedFilter,N=T.isDeletingAdvancedFilter,z=T.isOpenedDeleteConfirmModal,W=T.onCloseDeleteConfirmModal,A=T.openDeleteAdvancedFilterModal,K=T.filterNameToDelete,P=T.selectedFilter,I=T.setSelectedFilter;Object(n.useEffect)((function(){Object(u.setLocalStorage)({label:L,value:{dataFilters:F,selectedFilter:P,standardFilters:D}})}),[F,P,D]);var E=Object(i.usePaginateGraphQLQuery)({query:i.GetMyTeamUsersDocument,variables:{dataFilters:F.team_users,isNextAvailability:f("availabilities"),sorting:(null===g||void 0===g?void 0:g.field)?g:void 0},pageSize:100,getConnections:function(e){return e.users}}),U=E.edges,V=E.loading,G=E.isLoadingMore,q=E.error,H=E.totalCount,Q=E.loadMore,X=E.fetchMorePromise,Y=Object(n.useMemo)((function(){return w({edges:U})}),[U]),Z=Object(n.useMemo)((function(){return Object(d.c)(S.userFields)}),[S]);q&&s.error(R(q));var $=function(){var e=[{dataKey:"userId",headerTitle:t("id_short"),isSortable:!0,columnWidth:Object(d.b)("small"),cellRenderer:function(e){e.node;return Object(v.jsx)(v.Fragment,{})},xlsCellRenderer:function(e){var t=e.node;return Object(c.xlsStringCell)(t.userBasicInfos.id)},isExportOnly:!0},{dataKey:"familyName",headerTitle:t("user",{smart_count:1}),isSortable:!0,columnWidth:Object(d.b)("large"),cellRenderer:function(e){var t,s=e.node;return Object(v.jsx)(c.SingleUserCell,{isClickable:!0,onClick:(t=s.userBasicInfos.id,function(e){e.stopPropagation(),C.push(b.b.USER_PROFILE_DETAILS.getRoute({userId:t}))}),user:s.userBasicInfos,size:"large"})},xlsCellRenderer:function(e){var t=e.node;return"".concat(t.userBasicInfos.familyName," ").concat(t.userBasicInfos.givenName)}},{dataKey:"groups",headerTitle:t("groups"),isSortable:!1,columnWidth:Object(d.b)("large"),cellRenderer:function(e){var t=e.node;return Object(v.jsx)(c.ObjectTagsCell,{tags:t.groups,size:"large"})},xlsCellRenderer:function(e){var t=e.node;return Object(c.xlsObjectTagCell)(t.groups)}},{dataKey:"managers",headerTitle:t("managers"),isSortable:!1,columnWidth:Object(d.b)("large"),cellRenderer:function(e){var t=e.node;return Object(v.jsx)(c.MultipleUsersCell,{users:t.managers,size:"large"})},xlsCellRenderer:function(e){var t=e.node;return Object(c.xlsUserCell)(t.managers)}},{dataKey:"have_job_title",headerTitle:t("have_job_title"),isSortable:!1,columnWidth:Object(d.b)("large"),cellRenderer:function(e){var t=e.node;return Object(v.jsx)(c.ObjectTagsCell,{tags:t.pinnedJobs,size:"large"})},xlsCellRenderer:function(e){var t=e.node;return Object(c.xlsObjectTagCell)(t.pinnedJobs)}}];return f("availabilities")&&e.push({dataKey:"next_availability",headerTitle:t("next_availability"),isSortable:!1,columnWidth:Object(d.b)("large"),cellRenderer:function(e){var t=e.node;return Object(v.jsx)(c.NextAvailabilityCell,{size:"large",date:t.nextAvailability})},xlsCellRenderer:function(e){var t=e.node;return Object(c.xlsDateCell)(t.nextAvailability)}}),e.push({dataKey:"externalId",headerTitle:t("external_id_short"),isSortable:!0,columnWidth:Object(d.b)("medium"),cellRenderer:function(e){var t=e.node;return Object(v.jsx)(c.LongTextCell,{text:t.externalId,size:"medium"})},xlsCellRenderer:function(e){return e.node.externalId||"-"}}),Z.size>0&&Z.forEach((function(s){e.push({dataKey:"customFields.".concat(s._key),headerTitle:s.name,isSortable:!!m.includes(s.field_type),columnWidth:Object(d.b)("large"),cellRenderer:function(e){var t=e.node;return Object.keys(t.customFields).includes(s._key)?Object(v.jsx)(c.CustomFieldCell,{field:s,customFields:t.customFields,value:t.customFields[s._key],size:"large"}):Object(v.jsx)(o.Line,{width:"100%",height:"100%",bg:"grey.0"})},xlsCellRenderer:function(e){var l=e.node;return Object(c.xlsCustomFieldCell)({field:s,value:s._key in(l.customFields||{})?l.customFields[s._key]:null,translate:t})}})})),e.push({dataKey:"lastLoginAt",headerTitle:t("last_connexion"),isSortable:!0,columnWidth:Object(d.b)("small"),cellRenderer:function(e){var t=e.node;return Object(v.jsx)(c.DateCell,{date:t.lastLoginAt,size:"small"})},xlsCellRenderer:function(e){var t=e.node;return Object(c.xlsDateCell)(t.lastLoginAt)}},{dataKey:"experience",headerTitle:t("experience",8),isSortable:!1,columnWidth:Object(d.b)("small"),cellRenderer:function(e){var t=e.node;return Object(v.jsx)(c.NumberDisplayCell,{number:t.experiences,size:"small"})},xlsCellRenderer:function(e){var t=e.node;return Object(c.xlsNumberCell)(t.experiences)}},{dataKey:"userEdge.node.skillsReviewsStats?.powersTotalCount",headerTitle:t("powers_count_total_title_short"),isSortable:!1,columnWidth:Object(d.b)("small"),cellRenderer:function(e){var t,s=e.node;return Object(v.jsx)(c.NumberDisplayCell,{number:null===(t=s.skillsReviewsStats)||void 0===t?void 0:t.powersTotalCount,size:"small"})},xlsCellRenderer:function(e){var t,s=e.node;return Object(c.xlsNumberCell)(null===(t=s.skillsReviewsStats)||void 0===t?void 0:t.powersTotalCount)}},{dataKey:"skillsReviewsStats.validatedPowersCount",headerTitle:t("validated_powers_count"),isSortable:!1,columnWidth:Object(d.b)("small"),cellRenderer:function(e){var t=e.node;return Object(v.jsx)(c.NumberDisplayCell,{number:t.skillsReviewsStats.validatedPowersCount,size:"small"})},xlsCellRenderer:function(e){var t=e.node;return Object(c.xlsNumberCell)(t.skillsReviewsStats.validatedPowersCount)}},{dataKey:"skillsReviewsStats.self.powersCount",headerTitle:t("self_review_powers_count"),isSortable:!1,columnWidth:Object(d.b)("small"),cellRenderer:function(e){var t=e.node;return Object(v.jsx)(c.NumberDisplayCell,{number:t.skillsReviewsStats.self.powersCount,size:"small"})},xlsCellRenderer:function(e){var t=e.node;return Object(c.xlsNumberCell)(t.skillsReviewsStats.self.powersCount)}},{dataKey:"skillsReviewsStats.self.powersCountByLastThreeMonths",headerTitle:t("self_reviews_count_by_last_three_months"),isSortable:!1,columnWidth:Object(d.b)("small"),cellRenderer:function(e){var t=e.node;return Object(v.jsx)(c.NumberDisplayCell,{number:t.skillsReviewsStats.self.powersCountByLastThreeMonths,size:"small"})},xlsCellRenderer:function(e){var t=e.node;return Object(c.xlsNumberCell)(t.skillsReviewsStats.self.powersCountByLastThreeMonths)}},{dataKey:"skillsReviewsStats.self.lastReview",headerTitle:t("last_self_review"),isSortable:!1,columnWidth:Object(d.b)("small"),cellRenderer:function(e){var t=e.node;return Object(v.jsx)(c.DateCell,{date:t.skillsReviewsStats.self.lastReview,size:"medium"})},xlsCellRenderer:function(e){var t=e.node;return Object(c.xlsDateCell)(t.skillsReviewsStats.self.lastReview)}},{dataKey:"skillsReviewsStats.other.powersCountByLastThreeMonths",headerTitle:t("other_reviews_count_by_last_three_months"),isSortable:!1,columnWidth:Object(d.b)("small"),cellRenderer:function(e){var t=e.node;return Object(v.jsx)(c.NumberDisplayCell,{number:t.skillsReviewsStats.other.powersCountByLastThreeMonths,size:"small"})},xlsCellRenderer:function(e){var t=e.node;return Object(c.xlsNumberCell)(t.skillsReviewsStats.other.powersCountByLastThreeMonths)}},{dataKey:"skillsReviewsStats.other.lastReview",headerTitle:t("last_other_review"),isSortable:!1,columnWidth:Object(d.b)("small"),cellRenderer:function(e){var t=e.node;return Object(v.jsx)(c.DateCell,{date:t.skillsReviewsStats.other.lastReview,size:"medium"})},xlsCellRenderer:function(e){var t=e.node;return Object(c.xlsDateCell)(t.skillsReviewsStats.other.lastReview)}}),f("jobs")&&e.push({dataKey:"skillsReviewsStats.currentJobsStats.validatedPowersCount",headerTitle:t("validated_skills_among_current_jobs"),isSortable:!1,columnWidth:Object(d.b)("medium"),cellRenderer:function(e){var t=e.node;return Object(v.jsx)(c.ProgressionStatusCell,{actualValue:t.skillsReviewsStats.currentJobsStats.validatedPowersCount,attendedValue:t.skillsReviewsStats.currentJobsStats.skillsCount||0,size:"medium"})},xlsCellRenderer:function(e){var t=e.node;return Object(c.xlsNumberCell)(t.skillsReviewsStats.currentJobsStats.validatedPowersCount)}},{dataKey:"skillsReviewsStats.currentJobsStats.other.powersCountByLastThreeMonths",headerTitle:t("other_reviews_powers_count_among_current_jobs_by_last_three_months"),isSortable:!1,columnWidth:Object(d.b)("small"),cellRenderer:function(e){var t=e.node;return Object(v.jsx)(c.NumberDisplayCell,{number:t.skillsReviewsStats.currentJobsStats.other.powersCountByLastThreeMonths,size:"small"})},xlsCellRenderer:function(e){var t=e.node;return Object(c.xlsNumberCell)(t.skillsReviewsStats.currentJobsStats.other.powersCountByLastThreeMonths)}},{dataKey:"skillsReviewsStats.currentJobsStats.other.lastReview",headerTitle:t("last_other_review_among_current_jobs"),isSortable:!1,columnWidth:Object(d.b)("medium"),cellRenderer:function(e){var t=e.node;return Object(v.jsx)(c.DateCell,{date:t.skillsReviewsStats.currentJobsStats.other.lastReview,size:"medium"})},xlsCellRenderer:function(e){var t=e.node;return Object(c.xlsDateCell)(t.skillsReviewsStats.currentJobsStats.other.lastReview)}},{dataKey:"skillsReviewsStats.currentJobsStats.self.powersCount",headerTitle:t("self_reviews_powers_count_among_current_jobs"),isSortable:!1,columnWidth:Object(d.b)("medium"),cellRenderer:function(e){var t=e.node;return Object(v.jsx)(c.ProgressionStatusCell,{actualValue:t.skillsReviewsStats.currentJobsStats.self.powersCount,attendedValue:t.skillsReviewsStats.currentJobsStats.skillsCount||0,size:"medium"})},xlsCellRenderer:function(e){var t=e.node;return Object(c.xlsNumberCell)(t.skillsReviewsStats.currentJobsStats.self.powersCount)}},{dataKey:"skillsReviewsStats.currentJobsStats.self.powersCountByLastThreeMonths",headerTitle:t("self_reviews_powers_count_among_current_jobs_by_last_three_months"),isSortable:!1,columnWidth:Object(d.b)("small"),cellRenderer:function(e){var t=e.node;return Object(v.jsx)(c.NumberDisplayCell,{number:t.skillsReviewsStats.currentJobsStats.self.powersCountByLastThreeMonths,size:"small"})},xlsCellRenderer:function(e){var t=e.node;return Object(c.xlsNumberCell)(t.skillsReviewsStats.currentJobsStats.self.powersCountByLastThreeMonths)}},{dataKey:"skillsReviewsStats.currentJobsStats.self.lastReview",headerTitle:t("last_self_review_among_current_jobs"),isSortable:!1,columnWidth:Object(d.b)("medium"),cellRenderer:function(e){var t=e.node;return Object(v.jsx)(c.DateCell,{date:t.skillsReviewsStats.currentJobsStats.self.lastReview,size:"medium"})},xlsCellRenderer:function(e){var t=e.node;return Object(c.xlsDateCell)(t.skillsReviewsStats.currentJobsStats.self.lastReview)}},{dataKey:"skillsReviewsStats.currentJobsStats.skillsCount",headerTitle:t("current_jobs_skills_count_title"),isSortable:!1,columnWidth:Object(d.b)("small"),cellRenderer:function(){return Object(v.jsx)(v.Fragment,{})},xlsCellRenderer:function(e){var t=e.node;return Object(c.xlsNumberCell)(t.skillsReviewsStats.currentJobsStats.skillsCount)},isExportOnly:!0}),e},ee=Object(c.useExportTable)({worksheetName:"Team",columns:$(),fetchRowsPromise:X,rowsMappingFn:function(e){return w(e.users)},pageSize:100,totalRowCount:H,fixedColumnCount:1}),te=Object(r.a)(ee,2),se=te[0],le=te[1];return Object(v.jsxs)(c.PageLayout,{pb:"0px",pr:"0px",display:"flex",flexDirection:"column",children:[Object(v.jsx)(c.TableToolbox,{totalCount:H||0,isLoading:V,quickFilters:[],advancedFilters:{advancedFilters:(null===O||void 0===O||null===(e=O.savedDataFilters)||void 0===e?void 0:e.myTeamUsers)||[],advancedFiltersSchema:[Object(i.getDataFiltersSchemaWithCustomFields)(i.UserDataFiltersSchema,S.userFields)],onNewFilter:function(e){M(Object(l.a)(Object(l.a)({},e),{},{filters:e.filters.user}))},onUpdateFilter:function(e){J(Object(l.a)(Object(l.a)({},e),{},{filters:e.filters[i.UserDataFiltersSchema.entity]}))},onDeleteFilter:function(e){A(e)},onSelectFilter:I,selectedFilter:P,standardFilters:D,standardFiltersSchema:[i.UserDataFiltersSchema]},menuActions:[{title:t("export"),onClick:function(){return le()},disabled:se}]}),Object(v.jsx)(c.TableContent,{rows:Y||[],onSort:function(e){var t=e.sortBy,s=e.sortDirection;return k(s?{field:t,order:s}:{field:t})},fixedColumnCount:1,columns:$(),isLoading:V,isLoadingMore:G,loadMoreRows:function(e){var t=e.startIndex;Q(t)},totalRowCount:H,noRowsRenderer:function(){return Object(v.jsx)(c.NoDataToDisplay,{})}}),Object(v.jsx)(c.DeleteAdvancedFilterConfirmModal,{filterName:K,isOpened:z,onConfirm:function(){B()},onCancel:W,isLoading:N})]})}}}]);