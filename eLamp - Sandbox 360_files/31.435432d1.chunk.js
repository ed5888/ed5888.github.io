/*! For license information please see 31.435432d1.chunk.js.LICENSE.txt */
(this["webpackJsonp@elamp/main-app"]=this["webpackJsonp@elamp/main-app"]||[]).push([[31],{1001:function(e,t,n){"use strict";n.d(t,"a",(function(){return I}));var a,o=n(0),r=n(14),i=n(17),l=n(285),s=n(10),c=n(1),d={callbacks:{onChangePeriod:function(){return null},onChangeView:function(){return null},onChangeDisplayMode:function(){return null},onChangeFilters:function(){return null},onExport:function(){return null}}},u=Object(o.createContext)(d),p=function(e){var t=e.children,n=e.callbacks;return Object(c.jsx)(u.Provider,{value:{callbacks:n},children:t})},m=n(187),f=n(821),g=n(818),h=function(e){var t=e.value,n=e.onChange,a=Object(r.useSwitch)(!1),l=a.active,d=a.on,u=a.off,p=Object(r.useTranslate)(),h=Object(o.useMemo)((function(){return[{label:p(g.PeriodType.DAY),value:g.PeriodType.DAY},{label:p(g.PeriodType.WEEK),value:g.PeriodType.WEEK},{label:p(g.PeriodType.MONTH),value:g.PeriodType.MONTH}]}),[p]),v=Object(o.useMemo)((function(){return h.reduce((function(e,t){return Object(i.a)(Object(i.a)({},e),{},Object(m.a)({},t.value,t))}),{})}),[h]);return Object(c.jsxs)(r.MenuSelect.Target,{children:[Object(c.jsx)(s.SelectedFilterButton,{text:v[t].label,onClick:d,icon:f.a,isActive:l}),Object(c.jsx)(r.MenuSelect,{onClose:u,isOpened:l,children:Object(c.jsx)(s.SelectFilterList,{title:p("periodType"),value:t,onChange:function(e){n(e),u()},options:h})})]})},v=["startDate","endDate","periodType"],b=function(e){var t=e.startDate,n=e.endDate,a=e.periodType,d=Object(l.a)(e,v),p=Object(r.useTranslate)(),m=Object(o.useContext)(u).callbacks.onChangePeriod;return Object(c.jsxs)(r.Line,Object(i.a)(Object(i.a)({},d),{},{children:[Object(c.jsx)(s.DatePickerFilter,{onSubmit:function(e){m(e.set("hours",12).toDate(),n,a)},value:t.toISOString(),textPrefix:p("from"),mr:1}),Object(c.jsx)(s.DatePickerFilter,{min:t.toISOString(),onSubmit:function(e){m(t,e.set("hours",12).toDate(),a)},value:n.toISOString(),textPrefix:p("to"),mr:1}),Object(c.jsx)(h,{value:a,onChange:function(e){return m(t,n,e)}})]}))},x=n(104),j=n(101),y=["value","onChange"],O=function(e){var t=e.value,n=e.onChange,a=Object(l.a)(e,y),d=Object(r.useSwitch)(!1),u=d.active,p=d.on,f=d.off,g=Object(r.useTranslate)(),h=Object(o.useMemo)((function(){return[{icon:x.a,label:g("planningView"),value:"planning"},{icon:j.a,label:g("allocationRatesView"),value:"allocationRate"}]}),[g]),v=Object(o.useMemo)((function(){return h.reduce((function(e,t){return Object(i.a)(Object(i.a)({},e),{},Object(m.a)({},t.value,t))}),{})}),[h]);return Object(c.jsxs)(r.MenuSelect.Target,{children:[Object(c.jsx)(s.SelectedFilterButton,Object(i.a)({text:v[t].label,onClick:p,icon:v[t].icon,isActive:u},a)),Object(c.jsx)(r.MenuSelect,{onClose:f,isOpened:u,children:Object(c.jsx)(s.SelectFilterList,{title:g("viewType"),value:t,onChange:function(e){n(e),f()},options:h})})]})},D=n(833),_=["title","titleId"];function P(){return(P=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function C(e,t){if(null==e)return{};var n,a,o=function(e,t){if(null==e)return{};var n,a,o={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function w(e,t){var n=e.title,r=e.titleId,i=C(e,_);return o.createElement("svg",P({viewBox:"0 0 14 14",xmlns:"http://www.w3.org/2000/svg",ref:t,"aria-labelledby":r},i),n?o.createElement("title",{id:r},n):null,a||(a=o.createElement("path",{d:"M3.44657 6.31234C2.66965 6.31234 2.00099 6.03214 1.4406 5.47174C0.880197 4.91134 0.599998 4.23632 0.599998 3.44666C0.599998 2.66975 0.880197 2.00109 1.4406 1.44069C2.00099 0.880297 2.67602 0.600098 3.46567 0.600098C4.24259 0.600098 4.91124 0.880297 5.47164 1.44069C6.03204 2.00109 6.31224 2.67612 6.31224 3.46577C6.31224 4.24268 6.03204 4.91134 5.47164 5.47174C4.91124 6.03214 4.23622 6.31234 3.44657 6.31234ZM3.46567 4.57383C3.77134 4.57383 4.03244 4.46557 4.24895 4.24905C4.46547 4.03254 4.57373 3.76507 4.57373 3.44666C4.57373 3.14099 4.46547 2.8799 4.24895 2.66338C4.03244 2.44686 3.76497 2.33861 3.44657 2.33861C3.14089 2.33861 2.8798 2.44686 2.66328 2.66338C2.44676 2.8799 2.33851 3.14736 2.33851 3.46577C2.33851 3.77144 2.44676 4.03254 2.66328 4.24905C2.8798 4.46557 3.14726 4.57383 3.46567 4.57383ZM10.5343 13.4001C9.75741 13.4001 9.08875 13.1199 8.52836 12.5595C7.96796 11.9991 7.68776 11.3241 7.68776 10.5344C7.68776 9.75751 7.96796 9.08885 8.52836 8.52846C9.08875 7.96806 9.76378 7.68786 10.5534 7.68786C11.3303 7.68786 11.999 7.96806 12.5594 8.52846C13.1198 9.08885 13.4 9.76388 13.4 10.5535C13.4 11.3304 13.1198 11.9991 12.5594 12.5595C11.999 13.1199 11.324 13.4001 10.5343 13.4001ZM10.5534 11.6616C10.8591 11.6616 11.1202 11.5533 11.3367 11.3368C11.5532 11.1203 11.6615 10.8528 11.6615 10.5344C11.6615 10.2288 11.5532 9.96766 11.3367 9.75114C11.1202 9.53463 10.8527 9.42637 10.5343 9.42637C10.2287 9.42637 9.96756 9.53463 9.75104 9.75114C9.53453 9.96766 9.42627 10.2351 9.42627 10.5535C9.42627 10.8592 9.53453 11.1203 9.75104 11.3368C9.96756 11.5533 10.235 11.6616 10.5534 11.6616ZM1.95642 13.2664L0.73373 12.0437L12.0436 0.733829L13.2663 1.95652L1.95642 13.2664Z"})))}var S=o.forwardRef(w),E=(n.p,["value","onChange"]),A=function(e){var t=e.value,n=e.onChange,a=Object(l.a)(e,E),s=Object(r.useTranslate)({capitalize:!0}),d=Object(o.useMemo)((function(){return[{type:"icon",icon:S,value:"percentage"},{type:"icon",icon:D.a,value:"number_of_resources"}]}),[s]),u=Object(o.useMemo)((function(){return"undefined"===typeof t||!0===t?"percentage":"number_of_resources"}),[t]);return Object(c.jsx)(r.ButtonSwitch,Object(i.a)({value:u,onChange:function(e){n("percentage"===e)},options:d},a))},T=n(61),N=n(1145),k=T.default.div({padding:0,margin:0,border:0,width:0},(function(e){return{borderLeft:"1px solid ".concat(e.theme.colors.grey[4])}}),N.b,N.a),I=function(e){var t=e.callbacks,n=e.view,a=e.planningType,i=e.isPercentage,l=e.periodType,d=e.startDate,u=e.endDate,m=e.quickFilters,f=e.advancedFilters,g=e.advancedFiltersSchema,h=e.standardFilters,v=e.standardFiltersSchema,x=e.selectedFilter,j=e.onSelectFilter,y=e.onNewFilter,D=e.onUpdateFilter,_=e.onDeleteFilter,P=e.canExport,C=Object(r.useTranslate)({capitalize:!0}),w=Object(o.useMemo)((function(){if(m)return m.filter((function(e){return!0===e.isSelected})).map((function(e){return e.id}))}),[m]);return Object(c.jsx)(p,{callbacks:t,children:Object(c.jsxs)(r.Line,{justifyContent:"space-between",pb:0,children:[Object(c.jsxs)(r.Line,{alignItems:"center",children:[Object(c.jsx)(O,{value:n,onChange:t.onChangeView,mr:1}),Object(c.jsx)(b,{periodType:l,startDate:d,endDate:u}),"project"===a&&Object(c.jsx)(A,{value:i,onChange:t.onChangeDisplayMode,ml:1}),m.length>0&&"undefined"!==typeof w&&Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)(k,{ml:1,mr:1,alignSelf:"stretch"}),Object(c.jsx)(s.TableToolboxQuickFiltersGroup,{quickFilters:m,ml:"-2.5px",minHeight:"30px"})]})]}),Object(c.jsxs)(r.Line,{pr:1,children:["undefined"!==typeof f&&Object(c.jsx)(s.TableToolboxAdvancedFilters,{advancedFilters:f,advancedFiltersSchema:g,standardFilters:h,standardFiltersSchema:v,onSelectFilter:j,onNewFilter:y,onUpdateFilter:D,onDeleteFilter:_,selectedFilter:x}),Object(c.jsx)(s.TableToolboxActionsMenu,{actions:[{title:C("export_action"),onClick:t.onExport,disabled:!P}]})]})]})})}},1004:function(e,t,n){"use strict";n.d(t,"b",(function(){return v})),n.d(t,"a",(function(){return b})),n.d(t,"d",(function(){return j})),n.d(t,"c",(function(){return O}));var a,o=n(53),r=n(0),i=n(14),l=n(415),s=n(37),c=n(45),d=n(65),u=n(818);!function(e){e.Overstaffed="overstaffed",e.Unstaffed="unstaffed",e.PartiallyStaffed="partiallyStaffed",e.Staffed="staffed"}(a||(a={}));var p={simulation:"simulated",provision:"provisional",approved:"confirmed"},m=[u.AllocationType.ABSENT,u.AllocationType.VACANCY,u.AllocationType.TRAINING,u.AllocationType.WORK],f=function(){var e=Object(d.h)(),t=Object(i.useTranslate)(),n={overstaffed:{fill:{type:"pattern",pattern:"solid",fgColor:{argb:e.colors.error[0].replace("#","FF")}},font:{color:{argb:e.colors.error[3].replace("#","FF")}}},unstaffed:{fill:{type:"pattern",pattern:"solid",fgColor:{argb:e.colors.error[0].replace("#","FF")}}},partiallyStaffed:{fill:{type:"pattern",pattern:"solid",fgColor:{argb:e.colors.alert[0].replace("#","FF")}}},staffed:{fill:{type:"pattern",pattern:"solid",fgColor:{argb:e.colors.success[0].replace("#","FF")}}}},o=function(e,n){var a;return"work"===e.type?"".concat((null===(a=e.project)||void 0===a?void 0:a.name)||""," - ").concat((null===n||void 0===n?void 0:n.name)||""," - ").concat(e.rate,"%").concat(p[e.status]?" - ".concat(t(p[e.status])):""):"".concat(e.projectAndNeedName||""," - ").concat(e.rate,"%")};return{formatAllocationCell:function(e,t){if(void 0===e||null===e)return"";switch(t){case"percentage":return"".concat(Math.round(10*e.rate)/10,"%");case"headcount":return"".concat(e.min,"/").concat(e.max);case"manDays":return"".concat(e.staffedManDays||"","/").concat(e.totalManDays||"");default:return""}},formatAssignmentLabel:o,formatNextAvailability:function(n){var a=Object(s.localeMoment)(n);return a.isSameOrBefore(Object(s.localeMoment)(),"d")?{cellContent:t("available"),cellStyle:{fill:{type:"pattern",pattern:"solid",fgColor:{argb:e.colors.success[0].replace("#","FF")}}}}:{cellContent:a.toDate(),cellStyle:{fill:{type:"pattern",pattern:"solid",fgColor:{argb:e.colors.error[0].replace("#","FF")}}}}},getAllocationStyle:function(e){return"number"!==typeof e?[]:e>100?n[a.Overstaffed]:100===e?n[a.Staffed]:0===e?n[a.Unstaffed]:n[a.PartiallyStaffed]},getAssignmentCellColor:function(t){var n;return t.some((function(e){return e.type===u.AllocationType.ABSENT||e.type===u.AllocationType.VACANCY||e.type===u.AllocationType.TRAINING}))?e.colors.grey[2]:(null===(n=t[0].project)||void 0===n?void 0:n.colorHex)||e.colors.grey[1]},getAssignmentsOnThisPeriodCellContent:function(e,t){return e.sort((function(e,t){return m.indexOf(e.type)-m.indexOf(t.type)})).map((function(e){return o(e,t)})).join("\n")},getResourceName:function(e){if("EXTERNAL_RESOURCE"===e.id){var n=t("externalResource");return"externalResource"!==e.displayName&&(n="".concat(e.displayName," (").concat(t("external_resource_shortcut"),")")),n}return"".concat((null===e||void 0===e?void 0:e.familyName)||""," ").concat((null===e||void 0===e?void 0:e.givenName)||"")},getScheduleColumns:function(e,t,n){return Object(u.generatePlanningHeaders)(e,t,n).reduce((function(e,t){return t.squares.forEach((function(t){void 0===e.find((function(e){return e.startDate.getTime()===t.startDate.getTime()}))&&e.push(t)})),e}),[])}}},g=n(10),h=function(e){var t=e.columns,n=e.title,a=Object(d.h)(),r=Object(g.useAppContext)().user,i=function(e){switch(e){case"header":return{fill:{type:"pattern",pattern:"solid",fgColor:{argb:a.colors.grey[4].replace("#","FF")}},font:{bold:!0}};case"project":return{border:{top:{style:"thin",color:{argb:a.colors.black[2].replace("#","FF")}}},fill:{type:"pattern",pattern:"solid",fgColor:{argb:a.colors.grey[3].replace("#","FF")}},font:{bold:!0}};case"projectNeed":return{border:{top:{style:"thin",color:{argb:a.colors.grey[5].replace("#","FF")}}},fill:{type:"pattern",pattern:"solid",fgColor:{argb:a.colors.grey[1].replace("#","FF")}}};case"totals":return{border:{top:{style:"thin",color:{argb:a.colors.black[2].replace("#","FF")}},bottom:{style:"thin",color:{argb:a.colors.black[2].replace("#","FF")}}},font:{bold:!0}};case"userAssignments":case"userAllocation":default:return{}}},s=new Map,c=t.map((function(e){return{header:e.headerTitle,key:e.dataKey,width:void 0!==e.columnWidth?e.columnWidth/10.41:void 0,xlsCellWithStyleRenderer:e.xlsCellWithStyleRenderer||function(e){return null}}}));c.forEach((function(e){s.set(e.key,e)}));var u=n,p=Object(l.generateXLSWorkbook)({currentUser:{id:r.id,givenName:r.givenName||"",familyName:r.familyName||""},worksheetName:u});return{workbook:p,addRowToXLS:function(e,t){var n=function(e,t){return e.kind=t,Array.from(s.entries()).reduce((function(t,n,a){var r=Object(o.a)(n,2),i=r[0],l=r[1];if(l.xlsCellWithStyleRenderer&&l.xlsCellWithStyleRenderer({node:e})){var s=l.xlsCellWithStyleRenderer({node:e}),c=s.cellContent,d=s.cellStyle;t.content[i]=c,d&&t.styles.push({properties:d,columnIndex:a})}return t}),{content:{},styles:[]})}(e,t),a=n.content,r=n.styles,l=p.sheet.addRow(a);return Object.assign(l,i(t)),(null===r||void 0===r?void 0:r.length)>0&&r.forEach((function(e){Object.assign(l.getCell(e.columnIndex+1),e.properties)})),l},initWorksheet:function(){p.sheet&&p.workbook.removeWorksheet(p.sheet.id),p.sheet=p.workbook.addWorksheet(u,{properties:{}}),p.sheet.properties.defaultRowHeight=30,p.sheet.columns=c,Object.assign(p.sheet.getRow(1),i("header"))}}},v=function(e){var t=e.planningData,n=e.allocationsMode,a=Object(i.useTranslate)({capitalize:!0}),d=Object(i.useAlert)(),u=Object(r.useState)(!1),p=Object(o.a)(u,2),m=p[0];p[1];Object(r.useEffect)((function(){m&&d.show(a("export_toaster_info"),{timeout:0,type:"info"})}),[m]);var g=f(),v=g.getAllocationStyle,b=g.getAssignmentCellColor,x=g.getAssignmentsOnThisPeriodCellContent,j=g.getResourceName,y=g.formatAllocationCell,O=g.getScheduleColumns,D=[{dataKey:"project",headerTitle:a("projects"),columnWidth:Object(c.b)("large"),xlsCellWithStyleRenderer:function(e){var t;return{cellContent:(null===(t=e.node.project)||void 0===t?void 0:t.name)||""}}},{dataKey:"projectNeed",headerTitle:a("needs"),columnWidth:Object(c.b)("large"),xlsCellWithStyleRenderer:function(e){var t;return{cellContent:(null===(t=e.node.projectNeed)||void 0===t?void 0:t.name)||""}}},{dataKey:"user",headerTitle:a("users"),columnWidth:Object(c.b)("large"),xlsCellWithStyleRenderer:function(e){var t=e.node;return{cellContent:"userAssignments"===t.kind?j(t.person):""}}},{dataKey:"allocationRate",headerTitle:a("allocation_rate_table_header"),columnWidth:Object(c.b)("small"),xlsCellWithStyleRenderer:function(e){var t=e.node;return"userAssignments"!==t.kind?{cellContent:y({min:t.minAssignees,max:t.maxHeadCount,rate:t.total},n),cellStyle:v(t.total)}:{cellContent:""}}}],_=O(t.periodType,t.startDate,t.endDate),P=D.concat(_.map((function(e,t){return{dataKey:"period".concat(t),headerTitle:e.startDate,columnWidth:Object(c.b)("small"),xlsCellWithStyleRenderer:function(a){var o=a.node;if("projectNeed"===o.kind)return{cellContent:o.byPeriod?y(o.byPeriod[t],n):"",cellStyle:o.byPeriod&&o.byPeriod[t]?v(o.byPeriod[t].rate):null};if("userAssignments"!==o.kind)return{cellContent:""};var r=o.assignments.filter((function(t){return t.startDate<=e.startDate&&t.endDate>e.startDate||t.startDate>e.startDate&&t.startDate<e.endDate})).sort((function(e,t){return e.rate-t.rate}));return r.length>0?{cellContent:x(r,o.projectNeed),cellStyle:{fill:{type:"pattern",pattern:"solid",fgColor:{argb:b(r).replace("#","FF")}}}}:void 0}}}))),C=h({title:a("projects_planning"),columns:P}),w=C.workbook,S=C.addRowToXLS,E=C.initWorksheet;return[m,function(){return function(){var e;E(),t&&(null===t||void 0===t||null===(e=t.projects)||void 0===e||e.forEach((function(e){var t;S(e,"project"),null===(t=e.needs)||void 0===t||t.forEach((function(t){var n;t.project=e.project,S(t,"projectNeed"),(null===(n=t.allocations)||void 0===n?void 0:n.reduce((function(e,t){return"EXTERNAL_RESOURCE"!==t.person.id&&void 0!==e.find((function(e){var n,a;return(null===(n=e.person)||void 0===n?void 0:n.id)===(null===(a=t.person)||void 0===a?void 0:a.id)}))||e.push(t),e}),[])).forEach((function(n){n.project=e.project,n.projectNeed=t.projectNeed,S(n,"userAssignments")}))}))})))}(),d.success(a("export_toast_success")),Object(l.exportXLSWorkbook)({workbook:w.workbook,filename:"".concat(a("project_planning"),"_").concat(Object(s.localeMoment)().format("YYYY-MM-DD_HHmm"))})}]};function b(e){var t=e.allocationData,n=e.allocationsMode,a=Object(i.useTranslate)({capitalize:!0}),d=Object(i.useAlert)(),u=Object(r.useState)(!1),p=Object(o.a)(u,2),m=p[0];p[1];Object(r.useEffect)((function(){m&&d.show(a("export_toaster_info"),{timeout:0,type:"info"})}),[m]);var g=f(),v=g.getAllocationStyle,b=g.formatAllocationCell,x=g.getScheduleColumns,j=[{dataKey:"project",headerTitle:a("projects"),columnWidth:Object(c.b)("large"),xlsCellWithStyleRenderer:function(e){var t,n=e.node;return{cellContent:"totals"===n.kind?n.nbProjects:(null===(t=n.project)||void 0===t?void 0:t.name)||""}}},{dataKey:"projectNeed",headerTitle:a("needs"),columnWidth:Object(c.b)("large"),xlsCellWithStyleRenderer:function(e){var t,n=e.node;return{cellContent:"totals"===n.kind?n.nbNeeds:(null===(t=n.need)||void 0===t?void 0:t.name)||""}}},{dataKey:"allocationRate",headerTitle:a("allocation_rate_table_header"),columnWidth:Object(c.b)("small"),xlsCellWithStyleRenderer:function(e){var t=e.node;return{cellContent:b({min:t.minAssignees,max:t.maxHeadCount,rate:"totals"===t.kind?t.allocationRate:t.total},n),cellStyle:v("totals"===t.kind?t.allocationRate:t.total)}}}],y=x(t.periodType,t.startDate,t.endDate),O=j.concat(y.map((function(e,t){return{dataKey:"period".concat(t),headerTitle:e.startDate,columnWidth:Object(c.b)("small"),xlsCellWithStyleRenderer:function(e){var a=e.node;return{cellContent:a.byPeriod?b(a.byPeriod[t],n):"",cellStyle:a.byPeriod&&a.byPeriod[t]?v(a.byPeriod[t].rate):null}}}}))),D=h({title:a("projects_planning"),columns:O}),_=D.workbook,P=D.addRowToXLS,C=D.initWorksheet;return[m,function(){return C(),t&&(P(t.totals,"totals"),t.projectAllocations.forEach((function(e){var t;P(e,"project"),null===(t=e.needs)||void 0===t||t.forEach((function(t){t.project=e.project,P(t,"projectNeed")}))}))),d.success(a("export_toast_success")),Object(l.exportXLSWorkbook)({workbook:_.workbook,filename:"".concat(a("project_planning"),"_").concat(Object(s.localeMoment)().format("YYYY-MM-DD_HHmm"))})}]}var x=n(871),j=function(e){var t=e.planningData,n=e.fetchRowsPromise,a=e.totalCount,d=Object(i.useTranslate)({capitalize:!0}),u=Object(i.useAlert)(),p=Object(r.useState)(!1),m=Object(o.a)(p,2),g=m[0],v=m[1];Object(r.useEffect)((function(){g&&u.show(d("export_toaster_info"),{timeout:0,type:"info"})}),[g]);var b=f(),j=b.getAssignmentCellColor,y=b.getAssignmentsOnThisPeriodCellContent,O=b.getScheduleColumns,D=b.formatNextAvailability,_=[{dataKey:"user",headerTitle:d("users"),columnWidth:Object(c.b)("large"),xlsCellWithStyleRenderer:function(e){var t,n,a=e.node;return{cellContent:"userAssignments"===a.kind?"".concat((null===(t=a.person)||void 0===t?void 0:t.familyName)||""," ").concat((null===(n=a.person)||void 0===n?void 0:n.givenName)||""):""}}},{dataKey:"userTitle",headerTitle:d("user_title"),columnWidth:Object(c.b)("large"),xlsCellWithStyleRenderer:function(e){var t,n=e.node;return{cellContent:"userAssignments"===n.kind?null===(t=n.person)||void 0===t?void 0:t.title:""}}},{dataKey:"userLocation",headerTitle:d("location"),columnWidth:Object(c.b)("large"),xlsCellWithStyleRenderer:function(e){var t,n,a=e.node;return{cellContent:"userAssignments"===a.kind?null===(t=a.person)||void 0===t||null===(n=t.place)||void 0===n?void 0:n.label:""}}},{dataKey:"userGroups",headerTitle:d("groups_title"),columnWidth:Object(c.b)("large"),xlsCellWithStyleRenderer:function(e){var t,n,a=e.node;return"userAssignments"===a.kind?{cellContent:((null===(t=a.person)||void 0===t||null===(n=t.groups)||void 0===n?void 0:n.nodes)||[]).map((function(e){return e.name})).join(",")}:{cellContent:""}}},{dataKey:"allocationRate",headerTitle:d("allocation_rate_table_header"),columnWidth:Object(c.b)("small"),xlsCellWithStyleRenderer:function(e){var t=e.node;return t.assignmentEnd?D(t.assignmentEnd):{cellContent:""}}}],P=O(t.periodType,t.startDate,t.endDate),C=_.concat(P.map((function(e,t){return{dataKey:"period".concat(t),headerTitle:e.startDate,columnWidth:Object(c.b)("small"),xlsCellWithStyleRenderer:function(t){var n,a=t.node;if((null===(n=a.allocations)||void 0===n?void 0:n.length)>0){var o=a.allocations.filter((function(t){return t.startDate<=e.startDate&&t.endDate>e.startDate||t.startDate>e.startDate&&t.startDate<e.endDate})).sort((function(e,t){return e.rate-t.rate}));return o.length>0?{cellContent:y(o,a.projectNeed),cellStyle:{fill:{type:"pattern",pattern:"solid",fgColor:{argb:j(o).replace("#","FF")}}}}:{cellContent:""}}return{cellContent:""}}}}))),w=h({title:d("resources_planning"),columns:C}),S=w.workbook,E=w.addRowToXLS,A=w.initWorksheet;return[g,function(){var e=0;A(),v(!0);for(var o=n({variables:{after:String(e),first:300}}),r=function(){var r=e+=300;o=o.then((function(e){var o,i;e&&Object(x.b)({startDate:t.startDate,endDate:t.endDate,periodType:t.periodType},a||0,(null===(o=e.data)||void 0===o||null===(i=o.users)||void 0===i?void 0:i.nodes)||[]).data.persons.forEach((function(e){E(e,"userAssignments")}));return n({variables:{after:String(r),first:300}})}))};e<=(a||0);)r();return o.then((function(){return v(!1),u.removeAll(),u.success(d("export_toast_success")),Object(l.exportXLSWorkbook)({workbook:S.workbook,filename:"".concat(d("project_planning"),"_").concat(Object(s.localeMoment)().format("YYYY-MM-DD_HHmm"))})})).catch((function(e){u.removeAll(),u.error(d("export_toast_error")),v(!1),console.error("Export failed !!",e)}))}]},y=n(188);function O(e){var t=e.allocationData,n=e.allocationsMode,a=e.fetchRowsPromise,d=e.totalCount,u=Object(i.useTranslate)({capitalize:!0}),p=Object(i.useAlert)(),m=Object(r.useState)(!1),g=Object(o.a)(m,2),v=g[0],b=g[1];Object(r.useEffect)((function(){v&&p.show(u("export_toaster_info"),{timeout:0,type:"info"})}),[v]);var j=f(),O=j.getAllocationStyle,D=j.formatAllocationCell,_=j.getScheduleColumns,P=[{dataKey:"user",headerTitle:u("users"),columnWidth:Object(c.b)("large"),xlsCellWithStyleRenderer:function(e){var t,n,a,o=e.node;return{cellContent:"totals"===o.kind?o.nbPersons:"EXTERNAL_RESOURCE"===(null===(t=o.person)||void 0===t?void 0:t.id)?u("externalResource"):"".concat((null===(n=o.person)||void 0===n?void 0:n.familyName)||""," ").concat((null===(a=o.person)||void 0===a?void 0:a.givenName)||"")}}},{dataKey:"allocationRate",headerTitle:u("allocation_rate_table_header"),columnWidth:Object(c.b)("small"),xlsCellWithStyleRenderer:function(e){var t=e.node;return{cellContent:D({rate:"totals"===t.kind?t.allocationRate:t.total},n),cellStyle:O("totals"===t.kind?t.allocationRate:t.total)}}}],C=_(t.periodType,t.startDate,t.endDate),w=P.concat(C.map((function(e,t){return{dataKey:"period".concat(t),headerTitle:e.startDate,columnWidth:Object(c.b)("small"),xlsCellWithStyleRenderer:function(e){var a=e.node;return{cellContent:a.byPeriod?D(a.byPeriod[t],n):"",cellStyle:a.byPeriod&&a.byPeriod[t]?O(a.byPeriod[t].rate):null}}}}))),S=h({title:u("resources_planning"),columns:w}),E=S.workbook,A=S.addRowToXLS,T=S.initWorksheet;return[v,function(){var e=[],n=0;T(),b(!0);for(var o=a({variables:{after:String(n),first:300}}),r=function(){var t=n+=300;o=o.then((function(n){var o,r;n&&e.push.apply(e,Object(y.a)((null===(o=n.data)||void 0===o||null===(r=o.users)||void 0===r?void 0:r.nodes)||[]));return a({variables:{after:String(t),first:300}})}))};n<=(d||0);)r();return o.then((function(){T();var n=Object(x.a)({startDate:t.startDate,endDate:t.endDate,periodType:t.periodType},e,d);return A(n.totals,"totals"),null===n||void 0===n||n.allocations.forEach((function(e){A(e,"userAllocation")})),b(!1),p.removeAll(),p.success(u("export_toast_success")),Object(l.exportXLSWorkbook)({workbook:E.workbook,filename:"".concat(u("project_planning"),"_").concat(Object(s.localeMoment)().format("YYYY-MM-DD_HHmm"))})})).catch((function(e){p.removeAll(),p.error(u("export_toast_error")),b(!1),console.error("Export failed !!",e)}))}]}},1573:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return U}));var a=n(139),o=n.n(a),r=n(286),i=n(53),l=n(187),s=n(17),c=n(0),d=n(14),u=n(37),p=n(32),m=(n(995),n(19)),f=n(818),g=n(414),h=n(10),v=n(1001),b=n(1148),x=n(1153),j=n(996),y=n(1154),O=n(1013),D=n(785),_=n(765),P=n(1010),C=n(3),w=n(1004),S=n(23),E=n(773),A="success.3",T=-1,N=new Map([[f.PeriodType.DAY,m.AllocationRateAccuracy.Day],[f.PeriodType.WEEK,m.AllocationRateAccuracy.Week],[f.PeriodType.MONTH,m.AllocationRateAccuracy.Month]]),k=new Map([[m.ScheduledPeriodType.Project,f.AllocationType.WORK],[m.ScheduledPeriodType.Training,f.AllocationType.TRAINING],[m.ScheduledPeriodType.Absence,f.AllocationType.ABSENT]]),I=new Map([[m.ProjectAssignmentStatus.Confirmed,f.AllocationStatus.APPROVED],[m.ProjectAssignmentStatus.Planned,f.AllocationStatus.PROVISION],[m.ProjectAssignmentStatus.Provisional,f.AllocationStatus.PROVISION],[m.ProjectAssignmentStatus.Simulated,f.AllocationStatus.SIMULATION]]),M=new Map([[m.ProjectStatus.Past,f.ProjectStatus.PAST],[m.ProjectStatus.Ongoing,f.ProjectStatus.ONGOING],[m.ProjectStatus.Upcoming,f.ProjectStatus.UPCOMING]]);function R(e){return N.get(e)||m.AllocationRateAccuracy.Day}function F(e){return I.get(e)||f.AllocationStatus.APPROVED}function L(e){return M.get(e)||f.ProjectStatus.ONGOING}function B(e,t,n,a){var o=new Map,r=((null===t||void 0===t?void 0:t.projects.nodes)||[]).reduce((function(e,t){return e.nbProjects=e.nbProjects+1,e.nbNeeds=e.nbNeeds+t.projectNeeds.nodes.length,e}),{nbProjects:0,nbNeeds:0}),i={startDate:e.startDate.toDate(),endDate:e.endDate.toDate(),periodType:e.periodType,totals:r,projects:((null===t||void 0===t?void 0:t.projects)||{nodes:[]}).nodes.map((function(e){var t,r={id:e.id,name:e.name,customer:e.customer||"",startDate:e.startDate,endDate:e.endDate,status:L(e.status||m.ProjectStatus.Ongoing),colorHex:Object(m.maybeToOptional)(e.color)||A,capabilities:{canUpdate:e.capabilities.canUpdate,canDelete:e.capabilities.canDelete,canCreateNeed:e.capabilities.canCreateNeed}},i={name:e.name,startDate:e.startDate,endDate:e.endDate,groups:e.groups.nodes.map((function(e){return e.id})),place:e.place&&e.place.label&&e.place.location?{label:e.place.label,location:{latitude:e.place.location.latitude,longitude:null===(t=e.place.location)||void 0===t?void 0:t.longitude}}:void 0};o.set(e.id,{projectId:e.id,project:i});var l=e.allocationRates&&!0!==n?{total:e.allocationRates.totalSelectedPeriod,externalTotal:e.allocationRates.staffedAssigneesExternalSelectedPeriod,minAssignees:Object(E.getRoundedToOneDecimalOrZero)(e.allocationRates.staffedAssigneesSelectedPeriod),maxHeadCount:Object(E.getRoundedToOneDecimalOrZero)(e.allocationRates.requiredHeadcountSelectedPeriod)}:{total:T,externalTotal:T,minAssignees:T,maxHeadCount:T};return Object(s.a)(Object(s.a)({allocationRatesLoading:void 0==e.allocationRates||!0===n,project:r,startDate:e.startDate,endDate:e.endDate},l),{},{needs:(e.projectNeeds.nodes||[]).map((function(t){var l={id:t.id,name:t.name,priority:(null===t||void 0===t?void 0:t.priority)||1};o.set(t.id,{projectId:e.id,project:i,needId:t.id,need:Object(s.a)(Object(s.a)({},t),{},{resourceSearchPattern:t.resourceSearchPattern||void 0})});var c=t.allocationRates&&!0!==n?{allocationsNeed:t.allocationRates.totalSelectedPeriod,minAssignees:Object(E.getRoundedToOneDecimalOrZero)(t.allocationRates.staffedAssigneesSelectedPeriod),maxHeadCount:Object(E.getRoundedToOneDecimalOrZero)(t.allocationRates.requiredHeadcountSelectedPeriod),externalTotal:t.allocationRates.staffedAssigneesExternalSelectedPeriod,byPeriod:(t.allocationRates.byPeriod||[]).map((function(e){return null!==e?{min:e.minAssignees,max:e.maxHeadCount,rate:e.rate,external:e.externalAssignees}:null})),total:t.allocationRates.totalSelectedPeriod}:{allocationsNeed:T,total:T,externalTotal:T,minAssignees:T,maxHeadCount:T,byPeriod:[]};return Object(s.a)(Object(s.a)({projectNeed:l,isLocked:t.id===a,startDate:t.startDate,endDate:t.endDate,capabilities:{canUpdate:t.capabilities.canUpdate,canDelete:t.capabilities.canDelete,canAssign:t.capabilities.canAssign}},c),{},{allocations:(t.projectAssignments.nodes||[]).reduce((function(n,a){if(o.set(a.id,{projectId:e.id,project:i,needId:t.id,assignmentId:a.id}),"AssignmentExternalResource"===a.assignedUser.__typename)n.push({assignmentEnd:null,person:{id:a.assignedUser.id,displayName:a.assignedUser.displayName,givenName:void 0,familyName:void 0,avatarURL:a.assignedUser.avatarURL},assignments:[{id:a.id,isExternalAssignment:"AssignmentExternalResource"===a.assignedUser.__typename,assignmentId:a.id,project:r,startDate:new Date(a.startDate),endDate:new Date(a.endDate),rate:a.rate,type:f.AllocationType.WORK,status:F(a.status)}]});else if("User"===a.assignedUser.__typename){var l;n.push({assignmentEnd:a.assignedUser.nextAvailability,person:{id:a.assignedUser.id,displayName:a.assignedUser.displayName,avatarURL:Object(m.maybeToOptional)(a.assignedUser.avatarURL),familyName:Object(m.maybeToOptional)(a.assignedUser.familyName),givenName:Object(m.maybeToOptional)(a.assignedUser.givenName)},assignments:((null===(l=a.assignedUser.scheduledPeriods)||void 0===l?void 0:l.nodes)||[]).map((function(n){var l,s,c;o.set(n.id,{projectId:e.id,project:i,needId:t.id,assignmentId:a.id});var d,u=(d=n.type,k.get(d)||f.AllocationType.VACANCY),p=n.projectAssignment?{id:n.projectAssignment.project.id,name:n.projectAssignment.project.name,customer:Object(m.maybeToOptional)(n.projectAssignment.project.customer)||"",status:n.projectAssignment.project.status,place:null===(l=n.projectAssignment.project.place)||void 0===l?void 0:l.label,colorHex:n.projectAssignment.project.color||"",capabilities:{canUpdate:e.capabilities.canUpdate,canDelete:e.capabilities.canDelete,canCreateNeed:e.capabilities.canCreateNeed}}:r;return{id:n.id,isExternalAssignment:"AssignmentExternalResource"===a.assignedUser.__typename,assignmentId:u===f.AllocationType.WORK?null===(s=n.projectAssignment)||void 0===s?void 0:s.id:void 0,project:p,startDate:new Date(n.startDate),endDate:new Date(n.endDate),rate:n.rate,type:u,projectAndNeedName:Object(m.maybeToOptional)(n.name),status:F((null===(c=n.projectAssignment)||void 0===c?void 0:c.status)||m.ProjectStatus.Upcoming)}})).sort((function(e,t){return Object(S.sortByName)(e,t,(function(e){return(e.projectAndNeedName||"").toLowerCase()}))}))})}return n}),[])})}))})})).sort((function(e,t){return Object(S.sortByName)(e,t,(function(e){return e.project.name}))}))};return{keyMap:o,data:i}}var H=n(1),W={dataFiltersProject:{managedBy:{inUsers:["me"]}}},z={isQuickAssignModalOpened:!1,isAdvancedSearchModalOpened:!1,isAssignmentModalOpened:!1,isAddNeedModalOpened:!1,isSearchProfileModalOpen:!1,needResourcePattern:{must:[],should:[]},isExternalAssignment:!1,users:[],newProjectNeedName:"",newProjectNeedDescription:"",newProjectNeedId:"",newProjectNeedStartDate:"",newProjectNeedEndDate:"",newProjectNeedRate:100,projectId:"",isPercentage:!0,view:"planning",periodInput:{startDate:Object(u.localeMoment)().startOf("month").set("hours",12),endDate:Object(u.localeMoment)().startOf("month").set("hours",12).add(6,"months"),periodType:f.PeriodType.WEEK},selectedFilterKey:"my_projects",dataFilters:W,needLockId:void 0,isDisplayOptionsInitialized:!1};function K(e,t){switch(t.type){case"openQuickAssignModal":return Object(s.a)(Object(s.a)({},e),{},{needId:t.needId,assignmentStartDateInput:t.startDate,assignmentEndDateInput:t.endDate,isQuickAssignModalOpened:!0,isAdvancedSearchModalOpened:!1,isAssignmentModalOpened:!1});case"closeQuickAssignModal":return Object(s.a)(Object(s.a)({},e),{},{isQuickAssignModalOpened:!1});case"openAdvancedSearchModal":return Object(s.a)(Object(s.a)({},e),{},{needResourcePattern:t.needResourcePattern,isQuickAssignModalOpened:!1,isAdvancedSearchModalOpened:!0,isAssignmentModalOpened:!1});case"closeAdvancedSearchModal":return Object(s.a)(Object(s.a)({},e),{},{isAdvancedSearchModalOpened:!1});case"selectUsersToAssign":return Object(s.a)(Object(s.a)({},e),{},{isExternalAssignment:!0===t.isExternalAssignment,isAdvancedSearchModalOpened:!1,isQuickAssignModalOpened:!1,isAssignmentModalOpened:!0,users:t.users||[]});case"closeAssignmentModal":return Object(s.a)(Object(s.a)({},e),{},{isAssignmentModalOpened:!1});case"openAddNeedModal":return Object(s.a)(Object(s.a)({},e),{},{projectId:t.projectId,needStartDateInput:t.startDate,needEndDateInput:t.endDate,isAddNeedModalOpened:!0,isAdvancedSearchModalOpened:!1,isQuickAssignModalOpened:!1,isAssignmentModalOpened:!1});case"closeAddNeedModal":return Object(s.a)(Object(s.a)({},e),{},{isAddNeedModalOpened:!1});case"setNewSearchProfile":return Object(s.a)(Object(s.a)({},e),{},{newProjectNeedName:t.newProjectNeedName,newProjectNeedDescription:t.newProjectNeedDescription,newProjectNeedId:t.newProjectNeedId,newProjectNeedStartDate:t.newProjectNeedStartDate,newProjectNeedEndDate:t.newProjectNeedEndDate,projectId:t.projectId,isAddNeedModalOpened:!1,isSearchProfileModalOpen:!0});case"resetSearchProfile":return Object(s.a)(Object(s.a)({},e),{},{newProjectNeedName:z.newProjectNeedName,newProjectNeedDescription:z.newProjectNeedDescription,newProjectNeedId:z.newProjectNeedId,isSearchProfileModalOpen:!1});case"openEditNeedPanel":return Object(s.a)(Object(s.a)({},e),{},{needId:t.needId,assignmentId:void 0,isAddNeedModalOpened:!1,isAdvancedSearchModalOpened:!1,isQuickAssignModalOpened:!1,isAssignmentModalOpened:!1});case"openEditAssignmentPanel":return Object(s.a)(Object(s.a)({},e),{},{assignmentId:t.assignmentId,needId:void 0,isAddNeedModalOpened:!1,isAdvancedSearchModalOpened:!1,isQuickAssignModalOpened:!1,isAssignmentModalOpened:!1});case"reOrderNeed":return Object(s.a)(Object(s.a)({},e),{},{projectId:t.projectId});case"deleteAssignment":return Object(s.a)(Object(s.a)({},e),{},{projectId:t.projectId||""});case"initDisplayOptions":return Object(s.a)(Object(s.a)({},e),{},{isPercentage:t.isPercentage,view:t.view,periodInput:t.periodInput,selectedFilterKey:t.selectedFilterKey,dataFilters:t.dataFilters,isDisplayOptionsInitialized:!0});case"setIsPercentage":return Object(s.a)(Object(s.a)({},e),{},{isPercentage:t.isPercentage});case"setView":return Object(s.a)(Object(s.a)({},e),{},{view:t.view});case"setPeriodInput":return Object(s.a)(Object(s.a)({},e),{},{periodInput:t.periodInput});case"setSelectedFilterKeyAndDataFilters":return Object(s.a)(Object(s.a)({},e),{},{selectedFilterKey:t.selectedFilterKey,dataFilters:t.dataFilters});case"setDataFilters":return Object(s.a)(Object(s.a)({},e),{},{dataFilters:t.dataFilters});case"setNeedLockId":return Object(s.a)(Object(s.a)({},e),{},{needLockId:t.needLockId});default:return e}}var U=function(){var e,t,n,a,N,k,I,M,F,U,q=Object(d.useAlert)(),Y=Object(d.useTranslate)({capitalize:!0}),V=Object(h.useAppContext)(),G=V.getErrorMessage,Q=V.user,Z=V.userPreferences,J=V.userGroups,X=V.customFields,$=Object(d.useSwitch)(!1),ee=(e={},Object(l.a)(e,p.ProjectStatus.PAST,"completed"),Object(l.a)(e,p.ProjectStatus.ONGOING,"confirmed"),Object(l.a)(e,p.ProjectStatus.UPCOMING,"upcoming"),e),te=Object(c.useReducer)(K,z),ne=Object(i.a)(te,2),ae=ne[0],oe=ne[1],re=Object(h.useTableToolboxAdvancedFilters)({savedDataFilters:null===Z||void 0===Z?void 0:Z.savedDataFilters,category:"projectPlanning"}),ie=re.createAdvancedFilter,le=re.updateAdvancedFilter,se=re.deleteAdvancedFilter,ce=re.openDeleteAdvancedFilterModal,de=re.onCloseDeleteConfirmModal,ue=re.isOpenedDeleteConfirmModal,pe=re.isDeletingAdvancedFilter,me=re.filterNameToDelete,fe=re.selectedFilter,ge=re.setSelectedFilter,he=Object(c.useMemo)((function(){return[{name:Y("my_projects"),filters:Object(l.a)({},m.ProjectDataFiltersSchema.entity,{managedBy:{inUsers:["me"]}})},{name:Y("projects_of_my_groups"),filters:Object(l.a)({},m.ProjectDataFiltersSchema.entity,{groups:{inValues:J}})}]}),[J]);Object(c.useEffect)((function(){var e,t,n;("advanced"===(null===fe||void 0===fe?void 0:fe.type)&&"undefined"!==typeof(null===Z||void 0===Z||null===(e=Z.savedDataFilters)||void 0===e?void 0:e.projectPlanning)?t=Z.savedDataFilters.projectPlanning.find((function(e){return e.id===fe.id})):"standard"===(null===fe||void 0===fe?void 0:fe.type)&&(t=he.find((function(e){return e.name===fe.name}))),t)&&oe({type:"setSelectedFilterKeyAndDataFilters",selectedFilterKey:t.name,dataFilters:{dataFiltersProject:Object(s.a)({status:null===(n=ae.dataFilters.dataFiltersProject)||void 0===n?void 0:n.status},t.filters.project),dataFiltersProjectNeed:t.filters.projectNeed}})}),[Z,fe,he]);var ve="projectPlanningPage_displayOptions_".concat(Q.id),be=Object(m.useListProjectsForPlanningLazyQuery)(),xe=Object(i.a)(be,2),je=xe[0],ye=xe[1],Oe=ye.data,De=ye.loading,_e=Object(m.useListProjectsForAllocationRatesLazyQuery)(),Pe=Object(i.a)(_e,2),Ce=Pe[0],we=Pe[1],Se=we.data,Ee=we.loading,Ae=Object(m.useListProjectsForPlanningLazyQuery)({variables:{startDate:ae.periodInput.startDate,endDate:ae.periodInput.endDate,allocationAccuracy:R(ae.periodInput.periodType),dataFiltersProject:Object(s.a)(Object(s.a)({},ae.dataFilters.dataFiltersProject),{},{startDate:{lte:ae.periodInput.endDate},endDate:{gte:ae.periodInput.startDate}}),dataFiltersProjectNeed:Object(s.a)(Object(s.a)({},ae.dataFilters.dataFiltersProjectNeed),{},{startDate:{lte:ae.periodInput.endDate},endDate:{gte:ae.periodInput.startDate}}),fetchAllocationRates:!0},onCompleted:function(){oe({type:"setNeedLockId",needLockId:void 0}),q.success(Y("success"))},onError:function(){oe({type:"setNeedLockId",needLockId:void 0})}}),Te=Object(i.a)(Ae,2),Ne=Te[0],ke=Te[1],Ie=ke.data,Me=ke.loading,Re=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return Ne({variables:{startDate:ae.periodInput.startDate,endDate:ae.periodInput.endDate,allocationAccuracy:R(ae.periodInput.periodType),dataFiltersProject:Object(s.a)(Object(s.a)({},ae.dataFilters.dataFiltersProject),{},{startDate:{lte:ae.periodInput.endDate},endDate:{gte:ae.periodInput.startDate}}),dataFiltersProjectNeed:Object(s.a)(Object(s.a)({},ae.dataFilters.dataFiltersProjectNeed),{},{startDate:{lte:ae.periodInput.endDate},endDate:{gte:ae.periodInput.startDate}}),fetchAllocationRates:t}})},Fe=Object(m.useUpdateProjectAssignmentMutation)({ignoreResults:!0,onError:function(e){q.error(G(e))}}),Le=Object(i.a)(Fe,1)[0],Be=Object(m.useUpdateScheduledPeriodDatesMutation)({ignoreResults:!0,optimisticResponse:function(e){var t=e.id,n=e.startDate,a=e.endDate;return{updateScheduledPeriodDates:t.startsWith("PRA")?{assignment:{__typename:"ProjectAssignment",id:t,startDate:n,endDate:a}}:{scheduledPeriod:{__typename:"ScheduledPeriod",id:t,startDate:n,endDate:a}}}},onCompleted:function(e){var t,n,a,o,r=(null===(t=e.updateScheduledPeriodDates)||void 0===t||null===(n=t.assignment)||void 0===n?void 0:n.id)||(null===(a=e.updateScheduledPeriodDates)||void 0===a||null===(o=a.scheduledPeriod)||void 0===o?void 0:o.id);if(r&&$e.has(r)){var i=$e.get(r).projectId;Re(i,!0)}},onError:function(e){return q.error(G(e))}}),He=Object(i.a)(Be,1)[0],We=Object(m.useUpdateProjectNeedMutation)({onCompleted:function(e){ae.projectId&&Re(ae.projectId,!0)},onError:function(e){console.error("ERROR updating need",e),q.error(G(e))}}),ze=Object(i.a)(We,1)[0],Ke=Object(m.useCreateProjectNeedMutation)(),Ue=Object(i.a)(Ke,2),qe=Ue[0],Ye=Ue[1].loading,Ve=Object(m.useDeleteProjectAssignmentMutation)({onCompleted:function(){Re(ae.projectId,!0),q.success(Y("success"))},onError:function(e){console.error("ERROR deleting assignment",e),q.error(G(e))}}),Ge=Object(i.a)(Ve,1)[0],Qe=function(){var e=Object(r.a)(o.a.mark((function e(t){var n,a,r,i;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=t.id,r=t.startDate,i=t.endDate,oe({type:"setNeedLockId",needLockId:null===(n=$e.get(a))||void 0===n?void 0:n.needId}),He({variables:{id:a,startDate:r.toISOString(),endDate:i.toISOString()},onCompleted:function(){q.success(Y("success")),Re(),oe({type:"setNeedLockId",needLockId:void 0})},onError:function(e){q.error(G(e))}});case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();Object(c.useEffect)((function(){var e=Object(g.getLocalStorage)({label:ve});if(null!==e){var t=e.periodInput;if(oe({type:"initDisplayOptions",view:e.view,periodInput:{startDate:Object(u.localeMoment)(t.startDate),endDate:Object(u.localeMoment)(t.endDate),periodType:t.periodType},isPercentage:e.isPercentage,selectedFilterKey:e.selectedFilterKey,dataFilters:e.dataFilters}),e.selectedFilterKey){var n,a,o=null===Z||void 0===Z||null===(n=Z.savedDataFilters)||void 0===n||null===(a=n.projectPlanning)||void 0===a?void 0:a.find((function(t){var n;return t.name===e.selectedFilterKey||t.id===(null===(n=e.selectedFilter)||void 0===n?void 0:n.id)})),r=he.find((function(t){var n;return t.name===Y(e.selectedFilterKey)||t.name===(null===(n=e.selectedFilter)||void 0===n?void 0:n.name)}));ge(o?{type:"advanced",id:o.id}:r?{type:"standard",name:r.name}:{type:"standard",name:Y("my_projects")})}else ge({type:"standard",name:Y("my_projects")})}else{var i={startDate:ae.periodInput.startDate,endDate:ae.periodInput.endDate,periodType:f.PeriodType.WEEK};oe({type:"initDisplayOptions",view:"planning",isPercentage:!0,periodInput:i,selectedFilterKey:Y(ae.selectedFilterKey),dataFilters:W}),ge({type:"standard",name:Y("my_projects")})}}),[]),Object(c.useEffect)((function(){ae.isDisplayOptionsInitialized&&Object(g.setLocalStorage)({label:ve,value:{view:ae.view,periodInput:ae.periodInput,isPercentage:ae.isPercentage,selectedFilterKey:ae.selectedFilterKey,selectedFilter:fe,dataFilters:ae.dataFilters}})}),[ae,fe]),Object(c.useEffect)((function(){var e={startDate:ae.periodInput.startDate,endDate:ae.periodInput.endDate,allocationAccuracy:R(ae.periodInput.periodType),dataFiltersProject:Object(s.a)(Object(s.a)({},ae.dataFilters.dataFiltersProject),{},{startDate:{lte:ae.periodInput.endDate},endDate:{gte:ae.periodInput.startDate}}),dataFiltersProjectNeed:Object(s.a)(Object(s.a)({},ae.dataFilters.dataFiltersProjectNeed),{},{startDate:{lte:ae.periodInput.endDate},endDate:{gte:ae.periodInput.startDate}}),fetchAllocationRates:!0};"planning"===ae.view&&ae.isDisplayOptionsInitialized?je({variables:e}):"allocationRate"===ae.view&&ae.isDisplayOptionsInitialized&&Ce({variables:e})}),[ae.view,ae.periodInput.startDate.toISOString(),ae.periodInput.endDate.toISOString(),ae.periodInput.periodType,ae.dataFilters]),Object(c.useEffect)((function(){"undefined"!==typeof ae.needLockId&&oe({type:"setNeedLockId",needLockId:void 0})}),[Oe,Ie]);var Ze={data:{totals:{nbProjects:0,nbNeeds:0},projects:[],startDate:ae.periodInput.startDate.toDate(),endDate:ae.periodInput.endDate.toDate(),periodType:ae.periodInput.periodType,getLinkToUserProfile:function(e){return C.b.USER_PROFILE.getRoute({userId:e})},getLinkToProject:function(e){return C.b.STAFFING_PROJECTS.getRoute({projectId:e})}},callbacks:{},isPercentage:ae.isPercentage},Je={data:{totals:{nbProjects:0,nbNeeds:0,allocationRate:0,minAssignees:0,maxHeadCount:0,byPeriod:[]},projectAllocations:[],startDate:ae.periodInput.startDate.toDate(),endDate:ae.periodInput.endDate.toDate(),periodType:ae.periodInput.periodType,getLinkToUserProfile:function(e){return C.b.USER_PROFILE.getRoute({userId:e})},getLinkToProject:function(e){return C.b.STAFFING_PROJECTS.getRoute({projectId:e})}},isPercentage:ae.isPercentage,callbacks:{}},Xe=B(ae.periodInput,Ie||Oe,Me,ae.needLockId),$e=Xe.keyMap,et=Xe.data;Ze.data=Object(s.a)(Object(s.a)({},et),{},{getLinkToUserProfile:Ze.data.getLinkToUserProfile,getLinkToProject:Ze.data.getLinkToProject}),Je.data=Object(s.a)(Object(s.a)({},function(e,t,n){var a=((null===t||void 0===t?void 0:t.projects.nodes)||[]).reduce((function(e,t){var n,a,o,r;return e.nbProjects=e.nbProjects+1,e.nbNeeds=e.nbNeeds+t.projectNeeds.nodes.length,e.allocationRate=(e.allocationRate||0)+((null===(n=t.allocationRates)||void 0===n?void 0:n.totalSelectedPeriod)||0),e.minAssignees=Object(E.getRoundedToOneDecimalOrZero)(e.minAssignees||0)+Object(E.getRoundedToOneDecimalOrZero)(null===(a=t.allocationRates)||void 0===a?void 0:a.staffedAssigneesSelectedPeriod),e.maxHeadCount=Object(E.getRoundedToOneDecimalOrZero)(e.maxHeadCount||0)+Object(E.getRoundedToOneDecimalOrZero)(null===(o=t.allocationRates)||void 0===o?void 0:o.requiredHeadcountSelectedPeriod),null===(r=t.allocationRates)||void 0===r||r.byPeriod.forEach((function(t,n){var a,o,r;e.byPeriod.length>n?null!=t&&(e.byPeriod[n]=null!=e.byPeriod[n]?{min:((null===(a=e.byPeriod[n])||void 0===a?void 0:a.min)||0)+t.minAssignees,max:((null===(o=e.byPeriod[n])||void 0===o?void 0:o.max)||0)+t.maxHeadCount,rate:t.rate+((null===(r=e.byPeriod[n])||void 0===r?void 0:r.rate)||0)}:{min:t.minAssignees,max:t.maxHeadCount,rate:t.rate}):e.byPeriod.push(null!=t?{min:t.minAssignees||0,max:t.maxHeadCount||0,rate:t.rate||0}:null)})),e}),{byPeriod:[],nbProjects:0,nbNeeds:0,minAssignees:0,maxHeadCount:0,allocationRate:0});return a.allocationRate=a.allocationRate/(a.nbProjects||1),a.byPeriod=a.byPeriod.map((function(e){return e?{rate:e.rate/(a.nbProjects||1),min:e.min,max:e.max}:e})),{startDate:e.startDate.toDate(),endDate:e.endDate.toDate(),periodType:e.periodType,totals:a,projectAllocations:((null===t||void 0===t?void 0:t.projects.nodes)||[]).map((function(e){var t=e.allocationRates&&!0!==n?{byPeriod:e.allocationRates.byPeriod.map((function(e){return null!==e?{min:e.minAssignees,max:e.maxHeadCount,rate:e.rate}:null})),total:e.allocationRates.totalSelectedPeriod,minAssignees:Object(E.getRoundedToOneDecimalOrZero)(e.allocationRates.staffedAssigneesSelectedPeriod),maxHeadCount:Object(E.getRoundedToOneDecimalOrZero)(e.allocationRates.requiredHeadcountSelectedPeriod)}:{byPeriod:[],total:T,minAssignees:T,maxHeadCount:T};return Object(s.a)(Object(s.a)({allocationRatesLoading:void 0==e.allocationRates||!0===n,project:{id:e.id,name:e.name,startDate:e.startDate,endDate:e.endDate,colorHex:Object(m.maybeToOptional)(e.color)||A,customer:e.customer||"",status:L(e.status||m.ProjectStatus.Ongoing),capabilities:{canUpdate:e.capabilities.canUpdate,canDelete:e.capabilities.canDelete,canCreateNeed:e.capabilities.canCreateNeed}}},t),{},{needs:e.projectNeeds.nodes.map((function(e){var t=e.allocationRates&&!0!==n?{byPeriod:e.allocationRates.byPeriod.map((function(e){return null!==e?{min:e.minAssignees,max:e.maxHeadCount,rate:e.rate,external:e.externalAssignees}:null})),total:e.allocationRates.totalSelectedPeriod,minAssignees:Object(E.getRoundedToOneDecimalOrZero)(e.allocationRates.staffedAssigneesSelectedPeriod),maxHeadCount:Object(E.getRoundedToOneDecimalOrZero)(e.allocationRates.requiredHeadcountSelectedPeriod)}:{byPeriod:[],total:T,minAssignees:T,maxHeadCount:T};return Object(s.a)({need:e},t)}))})})).sort((function(e,t){return Object(S.sortByName)(e,t,(function(e){return e.project.name}))}))}}(ae.periodInput,Se)),{},{getLinkToUserProfile:Je.data.getLinkToUserProfile,getLinkToProject:Ze.data.getLinkToProject});var tt=Object(D.b)({projectNeedId:ae.needId,projectAssignmentId:ae.assignmentId}),nt=tt.setProjectNeedId,at=tt.setProjectAssignmentId,ot=tt.projectNeedId,rt=tt.projectAssignmentId,it=tt.isOpened,lt=tt.close,st=Object(_.b)({scheduledPeriodId:void 0}),ct=st.setScheduledPeriodId,dt=st.scheduledPeriodId,ut=st.isOpened,pt=st.close,mt=Object(c.useMemo)((function(){var e=$e.get(ae.needId||ae.newProjectNeedId||""),t=null===e||void 0===e?void 0:e.project,n=null===e||void 0===e?void 0:e.need;if("undefined"!==typeof t&&"undefined"!==typeof n){var a,o,r=(null===(a=ae.assignmentStartDateInput)||void 0===a?void 0:a.toISOString())||n.startDate,i=(null===(o=ae.assignmentEndDateInput)||void 0===o?void 0:o.toISOString())||n.endDate;return Object(P.b)({projectNeed:{startDate:r,endDate:i},project:{startDate:new Date(t.startDate),endDate:new Date(t.endDate),groups:t.groups,place:"undefined"!==typeof t.place?{label:t.place.label,location:t.place.location}:void 0},projectNeedResourceSearchPattern:ae.needResourcePattern||n.resourceSearchPattern})}}),[$e,ae]),ft=Object(c.useMemo)((function(){var e=$e.get(ae.needId||ae.newProjectNeedId||"");if("undefined"!==typeof(null===e||void 0===e?void 0:e.need))return{must:[],should:[]}}),[$e,ae]);Object(c.useEffect)((function(){ot&&oe({type:"openEditNeedPanel",needId:ot})}),[ot]),Object(c.useEffect)((function(){rt&&oe({type:"openEditAssignmentPanel",assignmentId:rt})}),[rt]);var gt=function(e){oe({type:"selectUsersToAssign",users:e,isExternalAssignment:!1})},ht=function(){var e=Object(r.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=3;break}return e.next=3,ze({variables:{id:ae.newProjectNeedId,resourceSearchPattern:Object(s.a)({},t)}}).then((function(){q.success(Y("success")),oe({type:"resetSearchProfile"})})).catch((function(e){console.error("Failed to update need !!",e),q.error(G(e))}));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),vt=Object(w.b)({planningData:null===Ze||void 0===Ze?void 0:Ze.data,allocationsMode:ae.isPercentage?"percentage":"headcount"}),bt=Object(i.a)(vt,2),xt=(bt[0],bt[1]),jt=Object(w.a)({allocationData:null===Je||void 0===Je?void 0:Je.data,allocationsMode:ae.isPercentage?"percentage":"headcount"}),yt=Object(i.a)(jt,2),Ot=(yt[0],yt[1]),Dt="allocationRate"===ae.view?Ee?Object(H.jsx)(d.Loader,{}):Je.data.projectAllocations.length>0?Object(H.jsx)(f.AllocationProjects,{data:null===Je||void 0===Je?void 0:Je.data,isPercentage:ae.isPercentage,callbacks:{onChangeAssignmentDates:function(){},onAssignResource:function(){},onAddNeed:function(){},onAddAssignment:function(){},onEditNeed:function(){},onEditAssignment:function(){},onReOrderNeed:function(){}}}):Object(H.jsx)(h.NoDataToDisplay,{}):De?Object(H.jsx)(d.Loader,{}):Ze.data.projects.length>0?Object(H.jsx)(f.PlanningProjects,{data:null===Ze||void 0===Ze?void 0:Ze.data,isPercentage:ae.isPercentage,callbacks:{onChangeAssignmentDates:function(e,t,n){Qe({id:e,startDate:t,endDate:n})},onAssignResource:function(e,t,n){var a,o=null===(a=$e.get(e))||void 0===a?void 0:a.need,r=(null===o||void 0===o?void 0:o.startDate)?new Date(o.startDate):void 0,i=(null===o||void 0===o?void 0:o.endDate)?new Date(o.endDate):void 0;oe({type:"openQuickAssignModal",needId:e,startDate:t||r,endDate:n||i})},onAddNeed:function(e,t,n){var a,o=null===(a=$e.get(e))||void 0===a?void 0:a.project,r=(null===o||void 0===o?void 0:o.startDate)?new Date(o.startDate):void 0,i=(null===o||void 0===o?void 0:o.endDate)?new Date(o.endDate):void 0;oe({type:"openAddNeedModal",projectId:e,startDate:t||r,endDate:n||i})},onAddAssignment:function(e){var t=e.userId,n=e.needId,a=e.startDate,o=e.endDate;console.log("ASSIGNMENT",{needId:n,userId:t,startDate:a,endDate:o})},onEditNeed:function(e){nt(e),oe({type:"openEditNeedPanel",needId:e})},onEditAssignment:function(e){at(e),oe({type:"openEditAssignmentPanel",assignmentId:e})},onEditScheduledPeriod:function(e){ct(e)},onDeleteAssignment:function(e,t){!function(e,t){var n;oe({type:"deleteAssignment",projectId:t}),oe({type:"setNeedLockId",needLockId:null===(n=$e.get(e))||void 0===n?void 0:n.needId}),Ge({variables:{id:e}}).finally((function(){oe({type:"setNeedLockId",needLockId:void 0})}))}(e,t)},onReOrderNeed:function(e,t){var n,a,o,r=null===(n=$e.get(e||""))||void 0===n?void 0:n.projectId,i=(null===(a=$e.get(e||""))||void 0===a||null===(o=a.need)||void 0===o?void 0:o.priority)||1;if(r){var l,s,c,d,u=(null===(l=et.projects.find((function(e){return e.project.id===r})))||void 0===l?void 0:l.needs)||[],p=u.findIndex((function(t){return t.projectNeed.id===e})),m="top"===t?u[p-1]:u[p+1],f=null===m||void 0===m||null===(s=m.projectNeed)||void 0===s?void 0:s.id,g=(null===(c=$e.get(f))||void 0===c||null===(d=c.need)||void 0===d?void 0:d.priority)||1;Promise.all([ze({variables:{id:e,priority:g}}).catch((function(e){console.error(e)}))].concat(f?[ze({variables:{id:f,priority:i}}).catch((function(e){console.error(e)}))]:[])),oe({type:"reOrderNeed",projectId:r})}},onChangeExternalResourceName:function(e,t){Le({variables:{id:e,externalResourceDisplayName:t}})}}}):Object(H.jsx)(h.NoDataToDisplay,{}),_t="planning"===ae.view&&(null===Ze||void 0===Ze||null===(t=Ze.data)||void 0===t||null===(n=t.projects)||void 0===n?void 0:n.length)>0&&!De||"allocationRate"===ae.view&&(null===Je||void 0===Je||null===(a=Je.data)||void 0===a||null===(N=a.projectAllocations)||void 0===N?void 0:N.length)>0&&!Ee;return Object(H.jsxs)(h.PageLayout,{pb:"0px",pr:"0px",children:[Object(H.jsx)(v.a,{advancedFilters:(null===Z||void 0===Z||null===(k=Z.savedDataFilters)||void 0===k?void 0:k.projectPlanning)||[],quickFilters:[{id:"status",title:Y("status"),type:h.QuickFilterTypes.MultiSelect,isOpened:$.active,elements:ee,value:(null===(I=ae.dataFilters.dataFiltersProject)||void 0===I||null===(M=I.status)||void 0===M?void 0:M.inValues)||[],onOpen:$.on,onClose:$.off,isSelected:function(){var e,t,n;return!!(null===(e=ae.dataFilters)||void 0===e||null===(t=e.dataFiltersProject)||void 0===t||null===(n=t.status)||void 0===n?void 0:n.inValues)&&ae.dataFilters.dataFiltersProject.status.inValues.length>0}(),onApplyFilter:function(e){oe({type:"setDataFilters",dataFilters:Object(s.a)(Object(s.a)({},ae.dataFilters),{},{dataFiltersProject:Object(s.a)(Object(s.a)({},ae.dataFilters.dataFiltersProject),{},{status:{inValues:e.map((function(e){return e}))}})})})},onClearFilter:function(){oe({type:"setDataFilters",dataFilters:Object(s.a)(Object(s.a)({},ae.dataFilters),{},{dataFiltersProject:Object(s.a)(Object(s.a)({},ae.dataFilters.dataFiltersProject),{},{status:void 0})})})}}],advancedFiltersSchema:[Object(m.getDataFiltersSchemaWithCustomFields)(m.ProjectDataFiltersSchema,X.projectFields),Object(m.getDataFiltersSchemaWithCustomFields)(m.ProjectNeedDataFiltersSchema,X.projectNeedFields)],standardFilters:he,selectedFilter:fe,onSelectFilter:ge,standardFiltersSchema:[m.ProjectDataFiltersSchema],onNewFilter:function(e){ie(e)},onUpdateFilter:function(e){le(e)},onDeleteFilter:function(e){ce(e)},view:ae.view,planningType:"project",isPercentage:ae.isPercentage,startDate:ae.periodInput.startDate.toDate(),endDate:ae.periodInput.endDate.toDate(),periodType:ae.periodInput.periodType,canExport:_t,callbacks:{onChangeView:function(e){oe({type:"setView",view:e})},onChangeDisplayMode:function(e){oe({type:"setIsPercentage",isPercentage:e})},onChangePeriod:function(e,t,n){oe({type:"setPeriodInput",periodInput:{startDate:Object(u.localeMoment)(e),endDate:Object(u.localeMoment)(t),periodType:n}})},onChangeFilters:function(){},onExport:function(){"allocationRate"===ae.view?Ot():xt()}}},ae.selectedFilterKey),Dt,Object(H.jsx)(x.a,{isOpened:ae.isQuickAssignModalOpened,onClose:function(){oe({type:"closeQuickAssignModal"})},onSelectUser:function(e){gt([e])},onClickAdvancedSearch:function(){var e,t=$e.get(ae.needId||""),n=(null===t||void 0===t||null===(e=t.need)||void 0===e?void 0:e.resourceSearchPattern)||{must:[],should:[]};oe({type:"openAdvancedSearchModal",needResourcePattern:n})},onClickAddExternalResource:function(){oe({type:"selectUsersToAssign",users:[],isExternalAssignment:!0})}}),Object(H.jsx)(y.a,{isOpened:ae.isAdvancedSearchModalOpened,onClose:function(){oe({type:"closeAdvancedSearchModal"})},resourceSearchPattern:mt||{must:[],should:[]},rawTextForSuggests:"",onSubmit:function(e){var t=e.selection;gt(t)},onUpdatePattern:function(e){var t=e.pattern;"undefined"!==typeof ae.needId&&ze({variables:{id:ae.needId,resourceSearchPattern:t}})}},"advancedSearchModal_".concat(ae.needId||ae.newProjectNeedId)),Object(H.jsx)(j.a,{isOpened:ae.isAddNeedModalOpened,onClose:function(){oe({type:"closeAddNeedModal"})},initialProjectId:ae.projectId||"",minStartDate:ae.needStartDateInput,maxEndDate:ae.needEndDateInput,isLoading:Ye,onSubmit:function(e){return qe({variables:Object(s.a)({},e),onCompleted:function(t){var n,a,o,r,i,l;Re(ae.projectId,!0),oe({type:"setNewSearchProfile",newProjectNeedName:e.name,newProjectNeedDescription:e.description||"",newProjectNeedId:(null===t||void 0===t||null===(n=t.createProjectNeed)||void 0===n||null===(a=n.projectNeed)||void 0===a?void 0:a.id)||"",newProjectNeedStartDate:Object(u.localeMoment)(null===t||void 0===t||null===(o=t.createProjectNeed)||void 0===o||null===(r=o.projectNeed)||void 0===r?void 0:r.startDate).format("YYYY-MM-DD"),newProjectNeedEndDate:Object(u.localeMoment)(null===t||void 0===t||null===(i=t.createProjectNeed)||void 0===i||null===(l=i.projectNeed)||void 0===l?void 0:l.endDate).format("YYYY-MM-DD"),projectId:ae.projectId}),q.success(Y("success"))},onError:function(e){console.error("ERROR: creating need",e),q.error(G(e))}}).then((function(){}))}},"projectNeedModal".concat(ae.isAddNeedModalOpened?"_"+ae.projectId||!1:"")),Object(H.jsx)(O.a,{initialPattern:ft,isOpened:ae.isSearchProfileModalOpen&&"undefined"!==typeof ft,onClose:function(){return oe({type:"resetSearchProfile"})},onSubmit:ht,cancelButtonLabel:Y("not_now"),projectNeedForSuggestions:{name:ae.newProjectNeedName,description:ae.newProjectNeedDescription,project:{name:null===(F=$e.get(ae.projectId))||void 0===F||null===(U=F.project)||void 0===U?void 0:U.name,description:void 0}}},"searchProfileModal_".concat(ae.needId||ae.newProjectNeedId)),Object(H.jsx)(b.a,{isOpened:ae.isAssignmentModalOpened,needId:ae.needId||"",initialStartDate:ae.assignmentStartDateInput,initialEndDate:ae.assignmentEndDateInput,assignUsersData:{format:ae.isExternalAssignment?"external":(ae.users||[]).length>1?"multi":"single",users:ae.users||[]},onClose:function(){oe({type:"closeAssignmentModal"})},onSubmit:function(e){e.createdAssignments;var t=$e.get(ae.needId||"").projectId;Re(t,!0),q.success(Y("success")),oe({type:"closeAssignmentModal"})}},"".concat(ot,"_").concat(ae.isExternalAssignment?"external":"multi","_").concat((ae.users||[]).sort().join("-"))),Object(H.jsx)(D.a,{isOpened:it,onClose:lt,projectNeedId:ot,projectAssignmentId:rt,onChangeProjectAssignmentId:at,onDeletedProjectNeed:function(){var e,t=null===(e=$e.get(ot||""))||void 0===e?void 0:e.projectId;t&&Re(t,!0),q.success(Y("success")),lt()},onDeletedProjectAssignment:function(){var e,t=null===(e=$e.get(rt||""))||void 0===e?void 0:e.projectId;t&&Re(t,!0),q.success(Y("success")),lt()},onUpdatedProjectAssignment:function(){var e=Object(r.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.startDate,t.endDate,t.status,t.rate,rt&&(oe({type:"setNeedLockId",needLockId:null===(n=$e.get(rt))||void 0===n?void 0:n.needId}),Re());case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),onUpdatedProjectNeed:function(){oe({type:"setNeedLockId",needLockId:ot}),Re()}},"".concat(ot,"_").concat(rt)),Object(H.jsx)(_.a,{scheduledPeriodId:dt,isOpened:ut,onClose:pt,onDeletedScheduledPeriod:pt}),Object(H.jsx)(h.DeleteAdvancedFilterConfirmModal,{filterName:me,isOpened:ue,onConfirm:function(){se()},onCancel:de,isLoading:pe})]})}},765:function(e,t,n){"use strict";n.d(t,"a",(function(){return T})),n.d(t,"b",(function(){return F}));var a=n(17),o=n(139),r=n.n(o),i=n(286),l=n(285),s=n(0),c=n(14),d=n(10),u=n(187),p=n(53),m=n(751),f=n(32),g=n(23),h=n(61),v=n(1),b=["label","isActive"],x=Object(h.default)(c.Text)((function(){return{fontWeight:"bold",borderRadius:0,textTransform:"uppercase"}}),(function(e){var t=e.isActive,n=e.theme;return t?{backgroundColor:n.colors.grey[2]}:{color:n.colors.grey[6]}})),j=function(e){var t=e.label,n=e.isActive,o=Object(l.a)(e,b);return Object(v.jsx)(x,Object(a.a)(Object(a.a)({isActive:n,p:1},o),{},{children:t}))},y=["value","onChange"],O=function(e){return{type:(null===e||void 0===e?void 0:e.type)||f.ScheduledPeriodType.ABSENCE,description:(null===e||void 0===e?void 0:e.description)||"",name:(null===e||void 0===e?void 0:e.name)||"",startDate:(null===e||void 0===e?void 0:e.startDate)||(new Date).toISOString(),endDate:(null===e||void 0===e?void 0:e.endDate)||(new Date).toISOString(),rate:(null===e||void 0===e?void 0:e.rate)||100}},D=function(e){var t=e.value,n=e.onChange,o=Object(l.a)(e,y),r=Object(s.useState)(O(t)),i=Object(p.a)(r,2),d=i[0],h=i[1],b=Object(c.useTranslate)({capitalize:!0}),x=Object(s.useCallback)(Object(m.debounce)((function(e){return n(e)}),500),[n]);Object(s.useEffect)((function(){h(O(t))}),[t]);var D=function(e){return function(){_("type")(e)}},_=function(e){return function(t){var n=Object(a.a)(Object(a.a)({},d),{},Object(u.a)({},e,t));h(n),x(n)}};return Object(v.jsxs)(c.Box,Object(a.a)(Object(a.a)({},o),{},{children:[Object(v.jsx)(c.Label,{content:b("name"),mb:2,required:!0,children:Object(v.jsx)(c.Input,{placeholder:b("unavailability_name"),value:d.name,onChange:_("name")})}),Object(v.jsxs)(c.Line,{justifyContent:"space-around",my:2,children:[Object(v.jsx)(j,{label:Object(g.maj)(b("absence")),onClick:D(f.ScheduledPeriodType.ABSENCE),isActive:d.type===f.ScheduledPeriodType.ABSENCE}),Object(v.jsx)(j,{label:Object(g.maj)(b("training",1)),onClick:D(f.ScheduledPeriodType.TRAINING),isActive:d.type===f.ScheduledPeriodType.TRAINING})]}),Object(v.jsx)(c.TextArea,{mb:2,value:d.description,onChange:_("description"),placeholder:b("details")}),Object(v.jsx)(c.PeriodPicker,{startDate:d.startDate,endDate:d.endDate,startDateLabel:b("from"),endDateLabel:b("to"),isFlex:!1,onChange:function(e){var t=Object(a.a)(Object(a.a)({},d),e);h(t),x(t)},mb:2,width:"100%"}),Object(v.jsx)(c.Label,{mb:2,content:"".concat(b("rate")," (%)"),children:Object(v.jsxs)(c.Line,{children:[Object(v.jsx)(c.Input,{mr:2,width:100,min:0,max:100,type:"number",rightElement:Object(v.jsx)(c.Text,{as:"span",children:"%"}),value:d.rate,onChange:function(e){return _("rate")(Number(e))}}),Object(v.jsx)(c.Slider,{flex:1,graduations:null,value:d.rate,max:100,onChange:function(e){return _("rate")(Number(e))}})]})})]}))},_=n(841),P=n(19),C=n(749),w=["onDelete"],S=function(e){var t=e.onDelete,n=Object(l.a)(e,w),o=Object(c.useSwitch)(!1),r=o.active,i=o.on,s=o.off,d=Object(c.useTranslate)({capitalize:!0});return Object(v.jsxs)(c.Column,Object(a.a)(Object(a.a)({alignItems:"flex-start"},n),{},{children:[Object(v.jsxs)(c.Line,{width:"100%",justifyContent:"space-between",mb:2,children:[Object(v.jsx)(c.Box,{children:Object(v.jsx)(c.Text,{fontWeight:"semiBold",children:d("unavailability")})}),Object(v.jsxs)(c.MenuSelect.Target,{px:1,children:[Object(v.jsx)(c.IconButton,{iconAs:C.a,onClick:i,isActive:r}),Object(v.jsx)(c.MenuSelect,{onClose:s,isOpened:r,children:Object(v.jsx)(c.MenuOption,{onClick:function(){t&&t(),s()},children:d("delete")})})]})]}),Object(v.jsx)(c.Line,{children:Object(v.jsx)(c.Text,{fontWeight:"bold",fontSize:"big",children:d("unavailability_details")})})]}))},E=["scheduledPeriodId","onUpdatedScheduledPeriod","onDeletedScheduledPeriod","isOpened","onClose"],A=["value","onChange","isLoading"],T=function(e){var t=e.scheduledPeriodId,n=e.onUpdatedScheduledPeriod,o=e.onDeletedScheduledPeriod,u=e.isOpened,m=e.onClose,f=Object(l.a)(e,E),g=Object(c.useTranslate)({capitalize:!0}),h=Object(d.useAppContext)().getErrorMessage,b=Object(c.useSwitch)(!1),x=Object(c.useAlert)(),j=function(e){var t=e.scheduledPeriodId,n=Object(P.useGetScheduledPeriodLazyQuery)({fetchPolicy:"cache-first",nextFetchPolicy:"network-only"}),a=Object(p.a)(n,2),o=a[0],l=a[1],c=l.data,d=l.loading,u=l.refetch,m=Object(P.useUpdatePeriodMutation)({awaitRefetchQueries:!0,refetchQueries:P.refetchQueries.onMutateScheduledPeriod,update:function(e,t){u&&u()}}),f=Object(p.a)(m,1)[0],g=Object(P.useDeleteScheduledPeriodMutation)({awaitRefetchQueries:!0,refetchQueries:P.refetchQueries.onMutateScheduledPeriod}),h=Object(p.a)(g,2),v=h[0],b=h[1].loading,x=function(){var e=Object(i.a)(r.a.mark((function e(n){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=2;break}return e.abrupt("return",f({variables:{input:{id:t,name:n.name,description:n.description,startDate:n.startDate,endDate:n.endDate,type:n.type,rate:n.rate}}}).then((function(){})).catch((function(e){throw new Error(e)})));case 2:return e.abrupt("return");case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),j=function(){var e=Object(i.a)(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=2;break}return e.abrupt("return",v({variables:{input:{id:t}}}).then((function(){})).catch((function(e){throw new Error(e)})));case 2:return e.abrupt("return");case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),y=Object(s.useMemo)((function(){if(null===c||void 0===c?void 0:c.scheduledPeriod)return{id:c.scheduledPeriod.id,name:Object(P.maybeToOptional)(c.scheduledPeriod.name),description:Object(P.maybeToOptional)(c.scheduledPeriod.description),startDate:c.scheduledPeriod.startDate,endDate:c.scheduledPeriod.endDate,rate:c.scheduledPeriod.rate,type:c.scheduledPeriod.type}}),[c]);return Object(s.useEffect)((function(){t&&o({variables:{id:t}})}),[t]),{scheduledPeriod:y,isLoadingScheduledPeriod:d,isDeletingScheduledPeriod:b,updateScheduledPeriod:x,deleteScheduledPeriod:j}}({scheduledPeriodId:t}),y=j.scheduledPeriod,O=j.isLoadingScheduledPeriod,D=j.isDeletingScheduledPeriod,C=j.updateScheduledPeriod,w=j.deleteScheduledPeriod,A=function(){var e=Object(i.a)(r.a.mark((function e(a){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",C(a).then((function(){x.success(g("your_availability_has_been_updated")),n&&n()})).catch((function(e){x.error(h(e)),console.error("Error updating scheduledPeriod ".concat(t),e)})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)(_.a,Object(a.a)(Object(a.a)({isOpened:u,onClose:m,renderHeader:function(){return Object(v.jsx)(S,{onDelete:b.on})}},f),{},{children:"undefined"!==typeof y&&Object(v.jsx)(N,{isLoading:O,value:y,onChange:A,mt:1})})),Object(v.jsx)(c.ConfirmModal,{isOpened:b.active,onConfirm:function(){w().then((function(){x.success(g("success")),o&&o(),b.off()})).catch((function(e){x.error(h(e)),console.error("Error deleting scheduledPeriod ".concat(t),e)}))},onCancel:b.off,isLoading:D,children:Object(v.jsx)(c.Box,{display:"flex",flexDirection:"column",children:Object(v.jsx)(c.Text,{fontSize:"big",fontWeight:"bold",children:g("confirm_delete_unavailability")})})})]})},N=function(e){var t=e.value,n=e.onChange,o=e.isLoading,r=Object(l.a)(e,A);return o?Object(v.jsx)(c.Loader,{}):Object(v.jsx)(D,Object(a.a)({value:t,onChange:n},r))},k=n(15),I="scheduledPeriodId",M=function(e){return"undefined"!==typeof e.scheduledPeriodId},R=function(e,t){switch(t.type){case"setScheduledPeriodId":return Object(a.a)(Object(a.a)({},e),{},{scheduledPeriodId:t.scheduledPeriodId,isOpened:M({scheduledPeriodId:t.scheduledPeriodId})});case"open":return Object(a.a)(Object(a.a)({},e),{},{isOpened:M({scheduledPeriodId:e.scheduledPeriodId})});case"close":return Object(a.a)(Object(a.a)({},e),{},{isOpened:!1});default:return e}},F=function(e){var t=Object(s.useReducer)(R,{scheduledPeriodId:e.scheduledPeriodId,isOpened:M({scheduledPeriodId:e.scheduledPeriodId})}),n=Object(p.a)(t,2),a=n[0],o=a.isOpened,r=a.scheduledPeriodId,i=n[1],l=Object(k.useLocation)(),c=Object(k.useHistory)();Object(s.useEffect)((function(){o&&r?c.push("?".concat(I,"=").concat(r)):c.push(l.pathname)}),[o,r]),Object(s.useEffect)((function(){var e=new URLSearchParams(l.search).get(I);e&&e!==r?i({type:"setScheduledPeriodId",scheduledPeriodId:e}):e||i({type:"close"})}),[l.search]);return{isOpened:o,scheduledPeriodId:r,setScheduledPeriodId:function(e){i({type:"setScheduledPeriodId",scheduledPeriodId:e})},open:function(){i({type:"open"})},close:function(){i({type:"close"})}}}},795:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a,o=n(0),r=["title","titleId"];function i(){return(i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function l(e,t){if(null==e)return{};var n,a,o=function(e,t){if(null==e)return{};var n,a,o={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function s(e,t){var n=e.title,s=e.titleId,c=l(e,r);return o.createElement("svg",i({viewBox:"0 0 10 16",xmlns:"http://www.w3.org/2000/svg",ref:t,"aria-labelledby":s},c),n?o.createElement("title",{id:s},n):null,a||(a=o.createElement("path",{d:"M2.16667 0L0 2.27368L5.66667 8L0 13.7263L2.16667 16L10 8L2.16667 0Z"})))}var c=o.forwardRef(s);n.p},799:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));n(0);var a=n(14),o=n(1),r=function(e){var t=e.renderHeader,n=e.children;return Object(o.jsxs)(a.Box,{width:"100%",height:"100%",bg:"white",display:"flex",flexDirection:"column",backgroundColor:"white",children:[Object(o.jsx)(a.Box,{flexGrow:0,p:2,children:t()}),Object(o.jsx)(a.Box,{px:2,children:Object(o.jsx)(a.Separator,{width:"100%"})}),Object(o.jsx)(a.Box,{flexGrow:1,overflow:"auto",p:2,width:"100%",children:n})]})}},818:function(e,t,n){var a=n(1133),o=["title"],r=["title"],i=["title"],l=["title"],s=["title"],c=["title"];!function(e,t,n,d,u,p,m,f,g,h,v,b,x,j,y,O){"use strict";var D="default"in t?t.default:t;function _(e,t){void 0===t&&(t={});var n=t.insertAt;if(e&&"undefined"!==typeof document){var a=document.head||document.getElementsByTagName("head")[0],o=document.createElement("style");o.type="text/css","top"===n&&a.firstChild?a.insertBefore(o,a.firstChild):a.appendChild(o),o.styleSheet?o.styleSheet.cssText=e:o.appendChild(document.createTextNode(e))}}f=f&&Object.prototype.hasOwnProperty.call(f,"default")?f.default:f,g=g&&Object.prototype.hasOwnProperty.call(g,"default")?g.default:g,x=x&&Object.prototype.hasOwnProperty.call(x,"default")?x.default:x,y=y&&Object.prototype.hasOwnProperty.call(y,"default")?y.default:y,_("@import url(http://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,700italic,300,400,700);\n._app_cc-icon__3PrY8 {\n  display: block;\n  font-style: normal;\n  font-weight: normal;\n  line-height: 1;\n  user-select: none;\n  fill: currentColor;\n  width: 1em;\n  height: 1em; }\n  ._app_cc-icon__3PrY8._app_cc--inline__2Jl6Q {\n    display: inline-block; }\n\n._app_cc-scheduler-top-left__2dQy_ {\n  box-shadow: 3px 3px 3px #0f094526;\n  clip-path: inset(0px -15px 0px 0px);\n  z-index: 1; }\n\n._app_cc-scheduler-top-right__bz3sv {\n  -ms-overflow-style: none;\n  scrollbar-width: none; }\n  ._app_cc-scheduler-top-right__bz3sv::-webkit-scrollbar {\n    display: none; }\n\n._app_cc-scheduler-bottom-left__WFoYX {\n  box-shadow: 3px -3px 3px #0f094526;\n  clip-path: inset(0px -15px 0px 0px);\n  z-index: 1; }\n\n._app_cc-scheduler-custom-scrollbar__KOMij {\n  scrollbar-color: #F2F2FA #d6d6e9;\n  scrollbar-width: thin;\n  border-right: 1px solid #e6e6f5;\n  border-bottom: 1px solid #e6e6f5; }\n  ._app_cc-scheduler-custom-scrollbar__KOMij::-webkit-scrollbar {\n    background-color: #F2F2FA;\n    width: 5px; }\n  ._app_cc-scheduler-custom-scrollbar__KOMij::-webkit-scrollbar-thumb {\n    background-color: #d6d6e9;\n    width: 5px; }\n\n._app_cc-scheduler-container__1Az1W {\n  width: 100%;\n  height: calc(100% - 71px);\n  border-bottom: 1px solid black; }\n\n._app_cc-scheduler-header__1z_Oh {\n  display: flex;\n  height: 10%; }\n  ._app_cc-scheduler-header-left__kRVT1 {\n    width: 28%;\n    height: 100%;\n    display: flex;\n    align-items: flex-end;\n    background: white;\n    box-shadow: 3px 3px 3px #0f094526;\n    clip-path: inset(0px -15px 0px 0px);\n    z-index: 1; }\n  ._app_cc-scheduler-header-calendar__1B702 {\n    height: 100%;\n    width: 72%;\n    background: white;\n    display: flex;\n    overflow-x: scroll;\n    z-index: 0;\n    flex-direction: row; }\n    ._app_cc-scheduler-header-calendar-up__CDqzg {\n      height: 50%;\n      display: flex;\n      flex-direction: row;\n      align-items: flex-end;\n      padding-left: 5px;\n      font-weight: 600;\n      border-bottom: 0.5px solid #e6e6f5; }\n      ._app_cc-scheduler-header-calendar-up-text__2XTwc {\n        position: relative;\n        font-size: 13.5px; }\n    ._app_cc-scheduler-header-calendar-down__1wukc {\n      height: 50%;\n      display: flex;\n      flex-direction: row;\n      align-items: center;\n      border-bottom: 1px solid black;\n      border-bottom: 1px solid black; }\n      ._app_cc-scheduler-header-calendar-down-item__zb10L {\n        border-right: 0.5px solid #e6e6f5;\n        height: 100%;\n        width: 50px;\n        font-size: 13px;\n        display: flex;\n        flex-direction: column;\n        justify-content: center;\n        font-weight: bold; }\n        ._app_cc-scheduler-header-calendar-down-item-index__2Pun- {\n          color: #a7a7bc;\n          position: relative;\n          left: 5px;\n          font-size: 10px;\n          font-weight: 600; }\n        ._app_cc-scheduler-header-calendar-down-item-text__1Cm2h {\n          position: relative;\n          left: 5px;\n          font-size: 12px; }\n  ._app_cc-scheduler-header-calendar__1B702::-webkit-scrollbar {\n    display: none; }\n\n._app_cc-scheduler-content__1wOS0 {\n  display: flex;\n  height: 90%; }\n\n._app_cc-scheduler-side-bar__1to5k {\n  background: white;\n  width: 28%;\n  height: 100%;\n  overflow-y: auto;\n  box-shadow: 3px -3px 3px #0f094526;\n  clip-path: inset(0px -15px 0px 0px);\n  z-index: 1; }\n  ._app_cc-scheduler-side-bar-item__3abvS {\n    width: 100%;\n    margin-bottom: 10px; }\n  ._app_cc-scheduler-side-bar-assign__UpOLd {\n    height: 50px;\n    flex-direction: row;\n    align-items: center;\n    display: flex;\n    padding-left: 20px;\n    font-size: 15px;\n    cursor: pointer;\n    transition: 0.3s; }\n  ._app_cc-scheduler-side-bar-assign__UpOLd:hover {\n    background-color: #e6e6f5; }\n\n._app_cc-scheduler-side-bar__1to5k::-webkit-scrollbar {\n  display: none; }\n\n._app_cc-scheduler-content-right__3-aup {\n  display: flex;\n  flex-direction: column;\n  background: #F2F2FA;\n  width: 72%;\n  height: 100%;\n  overflow-y: auto;\n  overflow-x: auto; }\n  ._app_cc-scheduler-content-right-row__1-68K {\n    display: flex;\n    flex-direction: row; }\n\n._app_cc-scheduler-content-right__3-aup::-webkit-scrollbar {\n  display: none; }\n\n._app_cc-scheduler-default-height__2nXMC {\n  height: 50px; }\n\n._app_cc-scheduler-default-width__3zJA7 {\n  width: 50px; }\n\n._app_divider__2bElr {\n  flex-shrink: 0; }\n\n._app_cc-scheduler-container__1Az1W ._app_locked__2STIq {\n  opacity: 0.75;\n  background-color: #e6e6f5; }\n\n._app_cc-planning-projects-content-item__3xGQ6 {\n  min-width: 50px;\n  min-height: 50px;\n  border: 0.5px solid black;\n  overflow-wrap: normal; }\n\n._app_cc-planning-projects-side-bar-item__2JZVb {\n  height: 50px;\n  width: 100%;\n  border-bottom: 0.5px solid #e6e6f5;\n  display: flex;\n  align-items: center;\n  padding-left: 20px;\n  flex-direction: row;\n  justify-content: space-between; }\n\n._app_cc-planning-projects-side-bar-left-info__2CBng {\n  display: flex;\n  position: relative;\n  align-items: center;\n  right: 52px;\n  flex-direction: column;\n  font-size: 11px; }\n\n._app_cc-planning-projects-side-bar-left-period__dQ4eO {\n  color: #a1a1a1;\n  font-size: 12px; }\n\n._app_cc-top-header-container__2r1l- {\n  width: 100%;\n  height: 85px;\n  padding: 10px 20px 10px 20px;\n  flex-direction: row;\n  display: flex;\n  justify-content: space-between;\n  align-items: center; }\n\n._app_cc-top-header-drop-down__2BJYs {\n  display: flex;\n  flex-direction: row;\n  width: 15%;\n  padding-left: 15px;\n  align-items: center; }\n  ._app_cc-top-header-drop-down-item__3RKqq {\n    width: 100%;\n    height: 50px;\n    align-items: center;\n    display: flex;\n    font-size: 14px;\n    cursor: pointer;\n    overflow: hidden;\n    transition: 0.3s; }\n    ._app_cc-top-header-drop-down-item-text__1yB99 {\n      margin-left: 15px; }\n  ._app_cc-top-header-drop-down-item__3RKqq:hover {\n    background-color: #e6e6f5; }\n  ._app_cc-top-header-drop-down-txt__3sV2y {\n    font-size: 14px;\n    font-weight: 600; }\n  ._app_cc-top-header-drop-down-icon__ikp7x {\n    margin-left: 10px;\n    cursor: pointer; }\n\n._app_cc-top-header-period-select__29n-L {\n  display: flex;\n  flex-direction: row;\n  width: 70%;\n  align-items: center; }\n  ._app_cc-top-header-period-select-text__1ARFj {\n    margin: 0px 12px 0px 12px;\n    font-size: 13px;\n    font-weight: 600; }\n  ._app_cc-top-header-period-select-arrow__FTPfU {\n    margin: 0px 13px 0px 13px; }\n  ._app_cc-top-header-period-select-button__3BO0a {\n    margin-left: 25px;\n    font-size: 13px;\n    font-weight: 600; }\n  ._app_cc-top-header-period-select-date__2AWbE {\n    font-size: 12px; }\n\n._app_cc-top-header-actions__qwaTV {\n  width: 15%;\n  display: flex;\n  flex-direction: row-reverse;\n  justify-content: space-between;\n  align-items: center; }\n  ._app_cc-top-header-actions-filter__-U2fA {\n    display: flex;\n    flex-direction: row;\n    align-items: center;\n    cursor: pointer; }\n    ._app_cc-top-header-actions-filter-txt__A6KdV {\n      font-weight: bold;\n      margin-left: 5px;\n      font-size: 14px;\n      font-weight: 700; }\n  ._app_cc-top-header-actions-export__13FlI {\n    font-size: 14px; }\n\n._app_cc-top-header-border-btn__3967Y {\n  border: 0.5px solid #d7d7d7;\n  border-radius: 4px;\n  cursor: pointer;\n  padding: 5px 15px 5px 15px;\n  height: 20px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  transition: 0.3s; }\n\n._app_cc-top-header-border-btn__3967Y:hover {\n  background-color: #e6e6f5; }\n\n._app_cc-scheduler-square__1gmBd {\n  min-width: 50px;\n  min-height: 50px;\n  border-bottom: 0.5px solid #e6e6f5;\n  border-right: 0.5px solid #e6e6f5;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  background-color: white; }\n  ._app_cc-scheduler-square-bar__3tAb9 {\n    width: 100%;\n    height: 100%;\n    background-color: #e6e6f5;\n    cursor: pointer;\n    justify-content: flex-end;\n    display: flex; }\n    ._app_cc-scheduler-square-bar-hover__3inbL {\n      position: absolute;\n      background-color: black;\n      color: white;\n      top: -30px;\n      font-size: 12px;\n      padding: 5px 15px;\n      z-index: 100;\n      border-radius: 3px; }\n    ._app_cc-scheduler-square-bar-container__1orOi {\n      width: 100%;\n      height: 5px;\n      margin-bottom: 8px; }\n    ._app_cc-scheduler-square-bar-filled__3HFZY {\n      width: 100%;\n      height: 100%;\n      background-color: red; }\n  ._app_cc-scheduler-square-content__2Nn-n {\n    font-size: 12.5px;\n    font-weight: 600; }\n  ._app_cc-scheduler-square-selected__3LmF9 {\n    border: 1px dashed #bfbdcc;\n    background-color: #fff7f5;\n    width: 100%;\n    height: 24px; }\n\n._app_cc-scheduler-allocation__2yKI6 {\n  position: absolute;\n  border-radius: 2px;\n  overflow: hidden;\n  white-space: nowrap;\n  height: 24px;\n  display: flex;\n  align-items: center;\n  box-shadow: 0px 1.5px 3px #636363;\n  justify-content: space-between;\n  cursor: pointer;\n  align-items: center; }\n  ._app_cc-scheduler-allocation-hatched__2ME1S {\n    background: repeating-linear-gradient(-45deg, transparent, transparent 2px, transparent 2px, rgba(0, 0, 0, 0.132) 4px); }\n  ._app_cc-scheduler-allocation-time__13Aot {\n    position: absolute;\n    top: 14px;\n    color: #636363;\n    font-size: 12px; }\n  ._app_cc-scheduler-allocation-extend-left__1ruXN {\n    background-color: inherit;\n    filter: brightness(0.8);\n    height: 60%;\n    width: 5px; }\n  ._app_cc-scheduler-allocation-extend-right__2ILyL {\n    background-color: inherit;\n    filter: brightness(0.8);\n    height: 60%;\n    width: 5px; }\n  ._app_cc-scheduler-allocation-text__qn20q {\n    font-size: 11.5px;\n    text-overflow: ellipsis;\n    position: relative;\n    color: #253a47;\n    width: calc(100% - 30px);\n    font-weight: 600;\n    height: 100%;\n    display: flex;\n    align-items: center; }\n    ._app_cc-scheduler-allocation-text-overflow__2cpQa {\n      overflow: hidden;\n      white-space: nowrap;\n      text-overflow: ellipsis; }\n  ._app_cc-scheduler-allocation-drag__yPBMY {\n    width: 25px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    height: 100%;\n    background-color: inherit; }\n\nbody {\n  font-family: 'Open Sans', sans-serif; }\n");var P,C,w,S=function(){return(S=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function E(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var o=0;for(a=Object.getOwnPropertySymbols(e);o<a.length;o++)t.indexOf(a[o])<0&&Object.prototype.propertyIsEnumerable.call(e,a[o])&&(n[a[o]]=e[a[o]])}return n}function A(e,t){var n="function"===typeof Symbol&&e[Symbol.iterator];if(!n)return e;var a,o,r=n.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(a=r.next()).done;)i.push(a.value)}catch(l){o={error:l}}finally{try{a&&!a.done&&(n=r.return)&&n.call(r)}finally{if(o)throw o.error}}return i}function T(e,t){for(var n=0,a=t.length,o=e.length;n<a;n++,o++)e[o]=t[n];return e}(w=e.AllocationStatus||(e.AllocationStatus={})).PROVISION="provision",w.SIMULATION="simulation",w.APPROVED="approved",(C=e.AllocationType||(e.AllocationType={})).VACANCY="vacancy",C.ABSENT="absent",C.TRAINING="training",C.WORK="work",(P=e.PeriodType||(e.PeriodType={})).DAY="day",P.WEEK="week",P.MONTH="month";var N=Array.from({length:12},(function(e,t){return p.localeMoment.months(t).toUpperCase()})),k=Array.from({length:7},(function(e,t){return p.localeMoment.weekdaysMin(t)})),I=Object.fromEntries(Array.from({length:12},(function(e,t){return[p.localeMoment.monthsShort(t).toUpperCase(),t+1]}))),M=Object.keys(I),R=e.PeriodType.WEEK,F=e.PeriodType.DAY,L=e.PeriodType.MONTH,B=function(e,t,n,a,o){var r,i;return r=!1===(null===o||void 0===o?void 0:o.isAllowEndDateOverlap)?e<a:e<=a,i=!1===(null===o||void 0===o?void 0:o.isAllowStartDateOverlap)?n<t:n<=t,r&&i},H=function(){var e=n.useTranslate(),a=t.useCallback((function(e){return e<10?"0"+e:e}),[]),o=t.useCallback((function(t,n){if(n===F||n===R){var a=t.split("/"),o=new Date(a[2]+"-"+a[1]+"-"+a[0]);if(n===F)return""+k[o.getDay()];if(n===R){var r=p.localeMoment(o).isoWeek();return""+e("week_abbreviation")+r}}return n===L?""+e("month_abbreviation")+I[t]:null}),[]),r=t.useCallback((function(e){if(e){var t=null===e||void 0===e?void 0:e.length;if(1===t)return{height:51,lines:[[{startDate:e[0].startDate,endDate:e[0].endDate,id:e[0].id}]]};if(t>1){for(var n=[[{startDate:e[0].startDate,endDate:e[0].endDate,id:e[0].id}]],a=0,o=1;o<t;o++){for(var r=!1,i=0;i<n.length;i++){for(var l=!0,s=0;s<n[i].length;s++)if(B(n[i][s].startDate,n[i][s].endDate,e[o].startDate,e[o].endDate)){l=!1;break}l&&(n[i].push(e[o]),r=!0)}r||(n.push([e[o]]),a++)}return{height:32*a+50,lines:n}}}return{height:51,lines:[]}}),[B]);return{dateRangeOverlaps:B,padToTwo:a,getDateIndexByPeriod:o,multipleDateRangeOverlaps:r}},W=function(e){var t=e.calendarStructure,n=e.periodType,a=E(e,["calendarStructure","periodType"]),o=H().getDateIndexByPeriod;return D.createElement("div",S({},a,{id:"top-scroll",className:"cc-scheduler-header-calendar"}),t.map((function(e,t){return D.createElement("div",{key:t},D.createElement("div",{className:"cc-scheduler-header-calendar-up"},D.createElement("text",{className:"cc-scheduler-header-calendar-up-text"},e.name)),D.createElement("div",{className:"cc-scheduler-header-calendar-down"},e.squares.map((function(e,t){return D.createElement("div",{className:"cc-scheduler-header-calendar-down-item",key:t},D.createElement("text",{className:"cc-scheduler-header-calendar-down-item-index"},o(e,n)),D.createElement("text",{className:"cc-scheduler-header-calendar-down-item-text"},e.substring(0,5)))}))))})))},z=D.memo(W),K=function(e){var t=e.children;return D.createElement("div",{id:"content-scroll",className:"cc-scheduler-content-right"},t)};D.memo(K);var U=function(e){var t=e.children,n=E(e,["children"]);return D.createElement("div",S({},n,{className:"cc-scheduler-header-left"}),t)},q=function(e){var t=e.children;return D.createElement("div",{id:"sidebar-scroll",className:"cc-scheduler-side-bar"},t)};D.memo(q);var Y={onAddNeed:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];alert(JSON.stringify(e))},onAddAssignment:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];alert(JSON.stringify(e))},onAssignResource:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];alert(JSON.stringify(e))},onChangeAssignmentDates:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];alert(JSON.stringify(e))},onEditAssignment:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];alert(JSON.stringify(e))},onEditNeed:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];alert(JSON.stringify(e))},onDeleteAssignment:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];alert(JSON.stringify(e))},onReOrderNeed:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];alert(JSON.stringify(e))},onChangeExternalResourceName:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];alert(JSON.stringify(e))}},V=t.createContext(Y);function G(){return t.useContext(V)}var Q=function(e){var t=e.callbacks,n=e.children,a=S(S({},Y),t);return D.createElement(V.Provider,{value:a},n)},Z=function(e,t,n,a,o){for(var r=new Date(Date.UTC(t,e,1,12)),i=[],l=new Date(Date.UTC(n.getFullYear(),n.getUTCMonth(),n.getUTCDate(),12)),s=new Date(Date.UTC(a.getFullYear(),a.getUTCMonth(),a.getUTCDate(),12));r.getUTCMonth()===e;){var c=new Date(r);c>=l&&c<=s&&i.push(o(c)),r.setUTCDate(r.getUTCDate()+1)}return i},J=function(e,t,n,a){for(var o=new Date(t,e,1,12),r=o.getMonth(),i=new Set,l=p.localeMoment(n).isoWeekday(1);o.getMonth()===r;){var s=p.localeMoment(o).hour(12).clone().isoWeekday(1);s.isSameOrAfter(l.toDate())&&s.isSameOrBefore(p.localeMoment(a))&&i.add({label:p.localeMoment(s).format("DD/MM/YYYY").toString(),startDate:s.toDate(),endDate:s.add(6,"d").toDate()}),o.setDate(o.getDate()+7)}return T([],A(i))},X=function(t,n,a,o,r){var i=[];return t===e.PeriodType.DAY&&i.push({name:N[n]+" "+a,squares:Z(n,a,o,r,(function(e){return{startDate:e,endDate:p.localeMoment(e).add(1,"d").toDate(),label:e.toDateString()}}))}),t===e.PeriodType.WEEK&&i.push({name:N[n]+" "+a,squares:J(n,a,o,r)}),t===e.PeriodType.MONTH&&i.push({name:""+a,squares:[{startDate:new Date(a,n,1,12),endDate:new Date(a,n+1,0,12),label:M[n]}]}),i},$=function(e,t,n){var a=[];if(t.getFullYear()===n.getFullYear())for(var o=t.getMonth();o<=n.getMonth();o++)a=a.concat(X(e,o,t.getFullYear(),t,n));else for(var r=t.getFullYear();r<=n.getFullYear();r++)for(o=0;o<12;o++)r===t.getFullYear()?o>=t.getMonth()&&(a=a.concat(X(e,o,r,t,n))):r===n.getFullYear()?o<=n.getMonth()&&(a=a.concat(X(e,o,r,t,n))):a=a.concat(X(e,o,r,t,n));return a},ee=function(n,a,o){var r=A(t.useState([]),2),i=r[0],l=r[1],s=H().padToTwo,c=t.useCallback((function(e,t,n,a){for(var o=new Date(t,e,1,12),r=o.getMonth(),i=new Set,l=p.localeMoment(n).isoWeekday(1);o.getMonth()===r;){var s=p.localeMoment(o).hour(12).clone().isoWeekday(1).toDate();s>=l.toDate()&&s<=a&&i.add(p.localeMoment(s).format("DD/MM/YYYY").toString()),o.setDate(o.getDate()+7)}return T([],A(i))}),[]),d=t.useCallback((function(t,n,a,o,r){var i=[];if(t===e.PeriodType.DAY){var d=Z(n,a,o,r,(function(e){return e.toDateString()})).map((function(e){return e.substring(8,10)+"/"+s(n+1)+"/"+s(a)}));i.push({name:N[n]+" "+a,squares:d})}t===e.PeriodType.WEEK&&i.push({name:N[n]+" "+a,squares:c(n,a,o,r)}),t===e.PeriodType.MONTH&&i.push({name:""+a,squares:[M[n]]}),l((function(n){if(t!==e.PeriodType.MONTH){var a=[];n.forEach((function(e){return a.push(e.squares)}));var o=new Set(a.flat());i[0].squares=Array.from(new Set(i[0].squares)).filter((function(e){return!o.has(e)}))}return T(T([],A(n)),A(i))}))}),[c,s]),u=t.useCallback((function(e){e.setHours(12),e.setMinutes(0),e.setSeconds(0),e.setMilliseconds(0)}),[]);return t.useEffect((function(){u(a),u(o),l([]);var e=n;if(a.getFullYear()===o.getFullYear())for(var t=a.getMonth();t<=o.getMonth();t++)d(e,t,a.getFullYear(),a,o);else for(var r=a.getFullYear();r<=o.getFullYear();r++)for(t=0;t<12;t++)r===a.getFullYear()?t>=a.getMonth()&&d(e,t,r,a,o):r===o.getFullYear()?t<=o.getMonth()&&d(e,t,r,a,o):d(e,t,r,a,o)}),[n,d,a,o]),{getDaysInMonthUTC:Z,calendarStructure:i}},te=function(n,a,o,r){var i=A(t.useState(0),2),l=i[0],s=i[1],c=A(t.useState(!1),2),d=c[0],u=c[1],f=H().dateRangeOverlaps,g=oe().selectedAssignment,h=G().onChangeAssignmentDates,v=void 0===h?function(){}:h,b=m.useTheme(),x=function(){return u(!0)},j=function(){return u(!1)},y=t.useMemo((function(){var e=b.colors,t=e.error,n=e.secondary,a=e.success;return l>100?t[3]:100===l?n[4]:l<100?a[3]:void 0}),[l]),O=t.useMemo((function(){return{justifyContent:l>100?"flex-start":"flex-end",background:b.colors.secondary[4]}}),[l]),D=t.useMemo((function(){return{width:l>=200?"100%":l<=100?100-l+"%":l-100+"%",backgroundColor:y}}),[y,l]),_=t.useMemo((function(){var e=b.colors.grey;return!1===o?{backgroundColor:e[1]}:l>100?{backgroundColor:l>100?"#E5AEC466":"white"}:{}}),[l,o]);return t.useEffect((function(){if(a){var t=0,o=p.localeMoment(a,"DD/MM/YYYY").hours(12).toDate(),i=p.localeMoment(o);r===e.PeriodType.DAY?i.add(1,"day"):r===e.PeriodType.WEEK?i.add(1,"week"):r===e.PeriodType.MONTH&&i.add(1,"month"),null===n||void 0===n||n.forEach((function(e){f(e.startDate,e.endDate,o,i.toDate(),{isAllowEndDateOverlap:!1,isAllowStartDateOverlap:!1})&&(t+=e.rate)})),s(t)}}),[n,a,f,r]),{barBackgroundColor:y,barStyleContent:O,barStyle:D,squareStyle:_,onDrop:function(e){if(a&&g){var t=g.startDate,n=g.endDate,o=g.id,r=a.split("/"),i=new Date(r[2]+"-"+r[1]+"-"+r[0]),l=new Date(i),s=Math.abs(t.getTime()-n.getTime()),c=Math.ceil(s/864e5);l.setDate(l.getDate()+c),v(o,p.getDateDay(i).toDate(),p.getDateDay(l).toDate()),e.preventDefault()}},onDragOver:function(e){e.preventDefault()},onMouseLeave:j,onMouseOver:x,isHovered:d,available:l}},ne=t.createContext({calendarStructure:[],contentSquares:[],selectedAssignment:null,setSelectedAssignment:function(e){},periodType:e.PeriodType,startDate:new Date,endDate:new Date}),ae=function(n){var a=n.sideBarChildren,o=n.contentChildren,r=n.fixedHeaderChildren,i=n.periodType,l=n.startDate,s=n.endDate,c=n.type,u=n.totalCount,p=n.loadMoreRows,m=void 0===p?function(){}:p,f=n.getLinkToUserProfile,g=n.getLinkToProject,h=t.useRef(null),v=ee(i,l,s).calendarStructure,b=A(t.useState(null),2),x=b[0],j=b[1];t.useEffect((function(){h&&h.current.recomputeGridSize()}),[a,o]);var y=t.useMemo((function(){return i===e.PeriodType.MONTH?v.reduce((function(e,t){return T(T([],A(e)),A(t.squares.map((function(e){return"01/"+I[e]+"/"+t.name}))))}),[]):v.reduce((function(e,t){return T(T([],A(e)),A(t.squares))}),[])}),[v,i]),O=function(e){var t=e.columnIndex,n=e.key,l=e.rowIndex,s=e.style;if(0===l){if(0===t)return D.createElement(U,{style:s,key:n},r);if(1===t)return D.createElement(z,{style:s,key:n,periodType:i,calendarStructure:v})}var c=0===t?a&&a[l-1]:o&&o[l-1],d=c.component,u=c.props;return D.createElement(d,S({},u,{style:s,key:n}))},_=t.useCallback((function(e){switch(e.index){case 0:return 364;case 1:return 51*y.length;default:return 364}}),[y.length]),P=t.useCallback((function(e){var t=e.index;return 0===t?102:o&&o[t-1].height?o[t-1].height:a&&a[t-1].height?a[t-1].height:51}),[o,a]),C={calendarStructure:v,contentSquares:y,selectedAssignment:x,setSelectedAssignment:j,periodType:i,startDate:l,endDate:s,getLinkToUserProfile:f,getLinkToProject:g};function w(e){var t=e.index;return!!o&&!!o[t]}var E=function(e){return function(t){t.columnStartIndex,t.columnStopIndex;var n=t.rowStartIndex,a=t.rowStopIndex;e({startIndex:n,stopIndex:a})}};return D.createElement(ne.Provider,{value:S({},C)},D.createElement("div",{className:"cc-scheduler-container"},D.createElement(d.AutoSizer,null,(function(e){var t=e.height,n=e.width;return D.createElement(d.InfiniteLoader,{isRowLoaded:w,loadMoreRows:m,rowCount:u||((null===o||void 0===o?void 0:o.length)||0)+1},(function(e){var r=e.onRowsRendered;return e.registerChild,D.createElement(d.MultiGrid,S({ref:h,cellRenderer:O,columnCount:2,columnWidth:_,height:t,rowCount:((null===o||void 0===o?void 0:o.length)||0)+1,rowHeight:P,width:n,fixedColumnCount:1,fixedRowCount:"allocations"===c?2:1,overscanRowsCount:10,onSectionRendered:E(r),enableFixedColumnScroll:!0,hideBottomLeftGridScrollbar:!0,enableFixedRowScroll:!0,classNameTopLeftGrid:"cc-scheduler-top-left",classNameTopRightGrid:"cc-scheduler-top-right",classNameBottomLeftGrid:"cc-scheduler-bottom-left cc-scheduler-custom-scrollbar",classNameBottomRightGrid:"cc-scheduler-custom-scrollbar"},{sideBarChildren:a,contentChildren:o,periodType:i,startDate:l,endDate:s}))}))}))))};function oe(){return t.useContext(ne)}var re=D.memo(ae),ie=f(n.Box)((function(e){e.theme;var t=e.isColoredBackground,n=e.backgroundColor;return{border:"none",alignItems:"center",justifyContent:"center",minWidth:"50px",minHeight:"51px",display:"flex",flexDirection:"row",background:t?n:"none"}})),le=f(n.Box)((function(e){var t=e.theme,n=e.isColoredBackground,a=e.isFirstNeed;return{display:"flex",flexGrow:1,alignItems:"center",paddingLeft:"15px",paddingRight:"27px",minHeight:"inherit",minWidth:"inherit",borderTop:n||a?"2px solid black":"0.5px solid "+t.colors.grey[1]}})),se=function(e){e.className;var t=e.isColoredBackground,a=void 0!==t&&t,o=e.isFirstNeed,r=void 0!==o&&o,i=(e.contentClassName,e.children),l=e.total,s=e.minAssignees,c=e.maxHeadCount,d=e.onClick,u=e.isPercentage,p=e.backgroundColor,f=E(e,["className","isColoredBackground","isFirstNeed","contentClassName","children","total","minAssignees","maxHeadCount","onClick","isPercentage","backgroundColor"]),g=m.useTheme();return D.createElement(ie,S({},f,{theme:g,onClick:d,isColoredBackground:a,backgroundColor:p}),D.createElement(le,{theme:g,isColoredBackground:a,isFirstNeed:r},D.createElement(n.Box,{display:"flex",flexGrow:1,maxWidth:"calc(100% - 60px)"},i),D.createElement(nt,{isPercentage:u,value:{min:s,max:c,rate:l}})))};function ce(e,t){return e(t={exports:{}},t.exports),t.exports}var de=ce((function(e){!function(){var t={}.hasOwnProperty;function n(){for(var e=[],a=0;a<arguments.length;a++){var o=arguments[a];if(o){var r=typeof o;if("string"===r||"number"===r)e.push(o);else if(Array.isArray(o)&&o.length){var i=n.apply(null,o);i&&e.push(i)}else if("object"===r)for(var l in o)t.call(o,l)&&o[l]&&e.push(l)}}return e.join(" ")}e.exports?(n.default=n,e.exports=n):window.classNames=n}()})),ue={root:"index-module_root__1FYIT",name:"index-module_name__1XZID"};_(".index-module_root__1FYIT {\n  position: sticky;\n  top: 0;\n  z-index: 10; }\n\n.index-module_name__1XZID {\n  color: #142C3B;\n  letter-spacing: 0;\n  margin-bottom: 3px;\n  font: normal normal 600 14px/19px Open Sans; }\n");var pe=function(e){var t=e.className,n=e.text,a=e.total,o=e.minAssignees,r=e.maxHeadCount,i=e.isPercentage,l=E(e,["className","text","total","minAssignees","maxHeadCount","isPercentage"]),s=de(ue.root,t);return D.createElement(se,S({},l,{className:s,isPercentage:i,total:a,minAssignees:o,maxHeadCount:r}),D.createElement("div",{className:ue.name},n))},me={root:"index-module_root__1BdbQ","first-project-child":"index-module_first-project-child__2PbHc","last-project-child":"index-module_last-project-child__30JM6","project-line":"index-module_project-line__1Ugty",square:"index-module_square__1nbiK","project-square":"index-module_project-square__jVTge","empty-square":"index-module_empty-square__2t1iO","selected-square":"index-module_selected-square__1bAjx",value:"index-module_value__3JCKO"};_(".index-module_root__1BdbQ {\n  display: flex;\n  align-items: center;\n  border-bottom: none; }\n\n.index-module_first-project-child__2PbHc {\n  border-top: 2px solid black; }\n\n.index-module_last-project-child__30JM6 {\n  border-bottom: 2px solid black; }\n\n.index-module_project-line__1Ugty {\n  border-top: 2px solid black; }\n\n.index-module_square__1nbiK {\n  align-items: center;\n  justify-content: center;\n  background-color: white; }\n\n.index-module_project-square__jVTge {\n  align-items: center;\n  justify-content: center;\n  background-color: #DDDFF2; }\n\n.index-module_empty-square__2t1iO {\n  background-color: #F0F1FF; }\n\n.index-module_selected-square__1bAjx {\n  background-color: #66bf3c; }\n\n.index-module_value__3JCKO {\n  flex-grow: 1;\n  display: flex;\n  justify-content: center; }\n");var fe=function(e){var t=e.text,a=e.value,o=e.valueFontWeight,r=e.isBottomBorder,i=void 0===r||r,l=E(e,["text","value","valueFontWeight","isBottomBorder"]),s=m.useTheme();return D.createElement(n.Line,S({width:"100%",justifyContent:"space-between",borderBottom:i?"1px solid "+s.colors.grey[4]:void 0,py:1},l),D.createElement(n.Text,{fontSize:"small",fontWeight:"semiBold"},t),D.createElement(n.Text,{fontSize:"small",fontWeight:o},a))},ge=function(e){var t=e.totalAssignees,a=e.assignees,o=e.externalAssignees,r=e.isOpened,i=e.onClose,l=E(e,["totalAssignees","assignees","externalAssignees","isOpened","onClose"]),s=n.useTranslate({capitalize:!0});return D.createElement(n.Popover,{content:D.createElement(n.Card,{bg:"white",boxShadow:"small",width:300,p:2,pt:0},D.createElement(fe,{text:s("assignees_stats_total"),value:t,valueFontWeight:"semiBold"}),D.createElement(fe,{text:s("assignees_stats_internal"),value:a,valueFontWeight:"medium"}),D.createElement(fe,{text:s("assignees_stats_external"),value:o,valueFontWeight:"medium",isBottomBorder:!1}),D.createElement(n.Text,{fontSize:"tiny",color:"grey.5",mt:2},s("assignees_stats_warning_message"))),isOpened:r,onClose:i},l.children)},he=function(e){var t=e.assigneesStats,n=e.isOpened,a=e.onClose,o=e.children;return"undefined"!==typeof t?D.createElement(ge,{assignees:t.assignees,externalAssignees:t.externalAssignees,totalAssignees:t.totalAssignees,isOpened:n,onClose:a},o):D.createElement(D.Fragment,null,o)};function ve(){return(ve=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}var be=D.createElement("g",{clipPath:"url(#externalResource_svg__clip0_3002_944)"},D.createElement("path",{d:"M9.933 12.075c0-1.142.325-2.2.867-3.067a.815.815 0 00-.208-.433.811.811 0 00-.592-.242H5V6.667h1.667a.811.811 0 00.591-.242.811.811 0 00.242-.592V4.167h1.667c.458 0 .85-.167 1.175-.492.325-.325.491-.717.491-1.175v-.333A6.408 6.408 0 0113.867 4.6c.441.658.741 1.358.925 2.1.625 0 1.225.142 1.775.383a7.993 7.993 0 00-.559-2.008 8.478 8.478 0 00-1.783-2.65A8.537 8.537 0 0011.583.642a8.064 8.064 0 00-3.25-.659c-1.15 0-2.233.217-3.25.659a8.339 8.339 0 00-2.65 1.783A8.479 8.479 0 00.65 5.075a8.065 8.065 0 00-.658 3.25c0 1.15.216 2.233.658 3.25a8.302 8.302 0 001.783 2.642A8.477 8.477 0 005.083 16c.8.342 1.642.55 2.534.625.591-1.167 1.5-2.125 2.616-2.725a5.98 5.98 0 01-.291-1.825h-.009zM7.5 14.958c-1.683-.208-3.075-.941-4.175-2.208-1.1-1.267-1.658-2.733-1.658-4.417 0-.25.016-.5.05-.75.033-.25.075-.5.116-.75l4 4v.834c0 .458.167.85.492 1.175.325.325.717.491 1.175.491v1.625z"}),D.createElement("path",{d:"M12.358 8.975a2.927 2.927 0 00-.891 2.142c0 .833.3 1.55.891 2.141a2.94 2.94 0 002.142.892c.825 0 1.55-.3 2.142-.892a2.94 2.94 0 00.891-2.141c0-.825-.3-1.55-.891-2.142a2.94 2.94 0 00-2.142-.892c-.825 0-1.55.3-2.142.892zm3.5 2.142c0 .375-.133.691-.4.958-.266.267-.583.4-.958.4s-.692-.133-.958-.4a1.303 1.303 0 01-.4-.958c0-.375.133-.692.4-.959.266-.266.583-.4.958-.4s.683.134.958.4c.267.267.4.584.4.959zM19.692 16.65a2.145 2.145 0 00-.825-.833 9.57 9.57 0 00-2.15-.859 8.688 8.688 0 00-4.434 0 9.978 9.978 0 00-2.15.859 2.202 2.202 0 00-.825.833A2.376 2.376 0 009 17.842V20h11v-2.158c0-.434-.1-.834-.308-1.192zm-1.267 1.675h-7.858v-.475c0-.117.025-.217.075-.317a.63.63 0 01.2-.216 8.67 8.67 0 011.808-.734 7.048 7.048 0 013.675 0 8.283 8.283 0 011.808.725.65.65 0 01.209.217c.05.092.075.2.075.317v.475l.008.008z"})),xe=D.createElement("defs",null,D.createElement("clipPath",{id:"externalResource_svg__clip0_3002_944"},D.createElement("path",{d:"M0 0h20v20H0z"}))),je=function(e){var t=e.title,n=a(e,o);return D.createElement("svg",ve({viewBox:"0 0 20 20"},n),t?D.createElement("title",null,t):null,be,xe)},ye=f(n.Box)((function(){return{width:"100%",height:"100%",position:"absolute"}})),Oe=f(n.Box)((function(){return{top:"0px",right:"0px",position:"absolute"}})),De=function(e){var t=e.size,a=void 0===t?9:t,o=e.isShowIcon,r=e.onClick,i=E(e,["size","isShowIcon","onClick"]);return D.createElement(ye,{onClick:r},o&&D.createElement(Oe,S({width:a,height:a,display:"flex",alignItems:"center",justifyContent:"center",p:"1px"},i),D.createElement(n.Icon,{as:je,size:a})))},_e=function(e){var t=e.isAssignmentSquare,a=e.content,o=e.style,r=void 0===o?{}:o,i=e.className,l=e.date,s=e.assignments,c=void 0===s?[]:s,d=e.isSelected,u=e.isAssignable,p=e.isAllocationLoading,m=e.assigneesStats,f=e.isExternalAssignees,g=void 0!==f&&f,h=E(e,["isAssignmentSquare","content","style","className","date","assignments","isSelected","isAssignable","isAllocationLoading","assigneesStats","isExternalAssignees"]),v=n.useTranslate({capitalize:!0}),b=de("cc-scheduler-square",i),x=n.useSwitch(!1),j=x.active,y=x.on,O=x.off,_=oe().periodType,P=te(c,l,u,_),C=P.barStyle,w=P.squareStyle,A=P.onDrop,T=P.onDragOver,N=P.onMouseLeave,k=P.onMouseOver,I=P.isHovered,M=P.available,R=P.barStyleContent;return D.createElement(he,{assigneesStats:m,isOpened:j,onClose:O},D.createElement("div",S({onDragOver:T,onDrop:A,style:S(S({},w),r),className:b},h),D.createElement(Pe,{isEnabled:"undefined"!==typeof m},"undefined"!==typeof m&&D.createElement(De,{isShowIcon:g,onClick:y,mt:"1px"}),I&&D.createElement("div",{className:"cc-scheduler-square-bar-hover"},v("allocation_rate")+": "+M+"%"),t&&D.createElement("div",{className:"cc-scheduler-square-bar-container",onMouseLeave:N,onMouseOver:k},D.createElement("div",{style:S({},R),className:"cc-scheduler-square-bar"},D.createElement("div",{style:S({},C),className:"cc-scheduler-square-bar-filled"}))),d&&D.createElement("div",{className:"cc-scheduler-square-selected"}),!0===p?D.createElement(n.LoaderSkeleton.Point,null):D.createElement(n.Text,{fontSize:"small",color:r.color,fontWeight:"bold"},a))))},Pe=function(e){var t=e.isEnabled,a=E(e,["isEnabled"]);return t?D.createElement(n.Box,S({width:"100%",height:"100%",position:"relative",display:"flex",justifyContent:"center",alignItems:"center"},a),a.children):D.createElement(D.Fragment,null,a.children)},Ce=D.memo(_e),we=function(e){if(e&&e.split){var t=e.split("/");return new Date(t[2]+"-"+t[1]+"-"+t[0])}return new Date},Se=function(t){var n=t.start,a=t.end,o=t.values,r=t.periodType;if(n>a){var i=n;n=a,a=i}return r===e.PeriodType.WEEK?{startDate:we(o[n]),endDate:g(we(o[a])).add(6,"days").toDate()}:r===e.PeriodType.MONTH?{startDate:we(o[n]),endDate:g(we(o[a])).subtract(1,"days").add(1,"months").toDate()}:{startDate:we(o[n]),endDate:we(o[a])}},Ee=function(e,n){t.useEffect((function(){var t=function(t){e.current&&!e.current.contains(t.target)&&n(t)};return document.addEventListener("mousedown",t),document.addEventListener("touchstart",t),function(){document.removeEventListener("mousedown",t),document.removeEventListener("touchstart",t)}}),[e,n])},Ae=function(){return t.createContext({values:new Array,reset:function(){return new Array},parentProps:{},getItemProps:function(e){return{}}})},Te=function(e){return Array.from({length:e},(function(){return!1}))},Ne=function(e){var n=e.context,a=e.children,o=e.length,r=e.onEnd,i=A(t.useState([]),2),l=i[0],s=i[1],c=A(t.useState(null),2),d=c[0],u=c[1],p=A(t.useState(null),2),m=p[0],f=p[1],g=t.useRef(),h=t.useCallback((function(){return s([]),[]}),[o]),v=t.useCallback((function(e){var t=e.currValues,n=void 0===t?l:t,a=e.currSelectionStartIndex,o=void 0===a?d:a,r=e.index;if(n[r]=!0,null!==o)if(r>o)for(var i=o;i<r;i++)n[i]=!0;else for(i=o;i>r;i--)n[i]=!0;return s(T([],A(n))),n}),[e,l,d]),b=t.useCallback((function(e){return{draggable:!0,onDragStart:function(t){var n=new Image;return n.src="",t.dataTransfer.setDragImage(n,window.outerWidth,window.outerHeight),u(e),v({currSelectionStartIndex:e,currValues:Te(o),index:e})},onDragEnter:function(){return null!==d?(f(e),v({index:e})):l},onDragEnd:function(){return r&&"function"===typeof r&&(null===d||null===m?console.error("Something went wrong with the selection"):r(d,m)),u(null),f(null),l}}}),[d,m,l]);Ee(g,h);var x=t.useMemo((function(){return{values:l,reset:h,parentProps:{ref:g},getItemProps:b}}),[l,h,g,b]);return D.createElement(n.Provider,{value:x},a)},ke=Ae();function Ie(e){return void 0===e&&(e=ke),t.useContext(e)}var Me=function(e){var t=e.className,n=e.selectionContext,a=e.squareClassName,o=e.isAssignmentSquare,r=e.isPercentage,i=e.isProjectLine,l=e.isFirstChild,s=e.isLocked,c=e.assignments,d=e.byPeriod,u=e.squareValues,p=e.squareStyle,m=E(e,["className","selectionContext","squareClassName","isAssignmentSquare","isPercentage","isProjectLine","isFirstChild","isLocked","assignments","byPeriod","squareValues","squareStyle"]),f=Ie(n),g=f.values,h=f.parentProps,v=f.getItemProps;return D.createElement("div",S({},m,n?h:{},{className:t+" "+(i?"project-line":"")+" "+(l?"first-project-child":"")}),u.map((function(e,t){var l,u=g[t]||!1,m=i?de(me["project-square"],a):de(me.square,a,((l={})[me["empty-square"]]=null===e.value,l)),f=!((null===d||void 0===d?void 0:d.length)>t&&null===d[t]);return D.createElement(Ce,S({},n?v(t):{},{key:t,isSelected:u,className:m+" "+(s?"locked":""),style:p,isAssignmentSquare:o,isAssignable:f,isLocked:s,assignments:c,date:e.date,content:null!==e.value&&"number"===typeof e.value.rate&&D.createElement("div",{className:me.value},D.createElement(nt,{isPercentage:r,value:e.value}))}))})))},Re=function(e){var n=e.isSelectable,a=void 0!==n&&n,o=e.isLocked,r=e.className,i=e.isPercentage,l=e.isProjectLine,s=void 0!==l&&l,c=e.isFirstChild,d=void 0!==c&&c,u=e.values,p=e.assignType,m=e.id,f=e.byPeriod,g=E(e,["isSelectable","isLocked","className","isPercentage","isProjectLine","isFirstChild","values","assignType","id","byPeriod"]),h=de(me.root,r),v=oe(),b=v.contentSquares,x=v.periodType,j=G(),y=j.onAddAssignment,O=j.onAssignResource,_=j.onAddNeed,P=t.useMemo((function(){if(a)return Ae()}),[a]),C=t.useMemo((function(){return b.map((function(e,t){return{date:e,value:u[t]||null}}))}),[b,u]),w=t.useCallback((function(e,t){var n=Se({start:e,end:t,values:u,periodType:x}),a=n.startDate,o=n.endDate;p&&("need"===p&&_&&_(m,a,o),"resource"===p&&O&&O(m,a,o),"assignment"===p&&y&&m&&y({needId:g.needId,userId:m,startDate:a,endDate:o}))}),[u,x,p,_,O,y]);return a&&P?D.createElement(Ne,{context:P,length:C.length,onEnd:w},D.createElement(Me,S({},g,{isFirstChild:d,isProjectLine:s,isPercentage:i,isLocked:o,className:h,squareValues:C,byPeriod:f,selectionContext:P}))):D.createElement(Me,S({},g,{isFirstChild:d,isProjectLine:s,isPercentage:i,isLocked:o,className:h,squareValues:C,byPeriod:f}))};function Fe(){return(Fe=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}var Le=D.createElement("path",{d:"M24 7.75L20.59 4.5 12 13 3.41 4.5 0 7.75 12 19.5 24 7.75z"}),Be=function(e){var t=e.title,n=a(e,r);return D.createElement("svg",Fe({viewBox:"0 0 24 24"},n),t?D.createElement("title",null,t):null,Le)},He=f(n.Icon)((function(e){return{padding:"10px",position:"relative",cursor:"pointer",zIndex:5,flexShrink:0,flexGrow:0,fontSize:"medium",color:"black",transform:e.isCollapsed?"rotate(180deg)":"rotate(0deg)",transition:"transform 0.2s ease"}})),We=function(e){var t=e.isCollapsed,n=void 0!==t&&t;return D.createElement(He,{as:Be,size:35,color:"black",isCollapsed:n})},ze="EXTERNAL_RESOURCE",Ke="externalResource",Ue=function(e){var t,a=e.onChangeExternalUserName,o=e.user,r=n.useTranslate({capitalize:!0}),i=oe().getLinkToUserProfile;return i&&o.id!==ze&&(t=i(o.id)),o.id!==ze?D.createElement(h.UserBasicInfo,{key:o.id,user:{id:o.id,displayName:o.displayName,familyName:o.familyName,givenName:o.givenName,avatarURL:o.avatarURL},size:"small",linkTo:t}):D.createElement(n.Line,{width:"100%"},D.createElement(h.UserAvatar,{size:"tiny",user:o}),D.createElement(n.TextEditable,{fontSize:"tiny",fontWeight:"semiBold",getIsValueValid:function(e){return e.trim().length>0},onSubmit:function(e){"undefined"!==typeof a&&e.trim().length>0&&e!==o.displayName&&a(e.trim())},readOnly:"undefined"===typeof a,value:o.displayName}),o.displayName!==Ke&&D.createElement(n.InfoTooltip,{size:16,title:D.createElement(n.Text,{color:"white",fontSize:"small"},r("external_resource_shortcut")),position:"right"}))},qe={root:"index-module_root__1Czx4","column-1":"index-module_column-1__1HvHu","column-2":"index-module_column-2__1c87H"};_(".index-module_root__1Czx4 {\n  flex-grow: 1;\n  display: flex;\n  flex-direction: row;\n  justify-content: space-between;\n  align-items: center;\n  padding-left: 15px;\n  padding-right: 0px;\n  border-bottom: 0.5px solid #e6e6f5; }\n\n.index-module_column-1__1HvHu {\n  font: normal normal bold 11px/24px Open Sans;\n  text-transform: uppercase; }\n\n.index-module_column-2__1c87H {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  font: normal normal bold 11px/15px Open Sans;\n  text-transform: uppercase; }\n");var Ye=function(e){var t=e.className,n=e.columns,a=de(qe.root,t);return D.createElement("div",{className:a},D.createElement("div",{className:qe["column-1"]},n[0]),D.createElement("div",{className:qe["column-2"]},n[1]))},Ve=function(e){var t=e.className,n=de("cc-icon",t);return D.createElement("svg",S({className:n},e,{width:"20",height:"20",viewBox:"0 0 24 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"}),D.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M14.0598 0C13.7669 0.00151589 13.481 0.0905226 13.2386 0.255714C12.9961 0.420906 12.808 0.654827 12.698 0.927763C12.5881 1.2007 12.5613 1.50033 12.6211 1.7886C12.6809 2.07687 12.8245 2.34077 13.0338 2.54677L18.9646 8.5095H1.48268C1.08945 8.5095 0.712323 8.66656 0.434267 8.94612C0.15621 9.22567 0 9.60484 0 10.0002C0 10.3955 0.15621 10.7747 0.434267 11.0543C0.712323 11.3338 1.08945 11.4909 1.48268 11.4909H18.9655L13.0338 17.4565C12.895 17.5941 12.7846 17.7579 12.7089 17.9385C12.6333 18.1192 12.594 18.3131 12.5933 18.5091C12.5926 18.7051 12.6304 18.8993 12.7047 19.0805C12.779 19.2617 12.8882 19.4264 13.026 19.5649C13.1639 19.7035 13.3276 19.8133 13.5079 19.888C13.6881 19.9627 13.8813 20.0007 14.0762 20C14.2711 19.9993 14.464 19.9597 14.6437 19.8837C14.8234 19.8077 14.9863 19.6967 15.1231 19.5571L23.4851 11.1422C23.6713 10.9853 23.8162 10.7846 23.9068 10.5579C23.9228 10.5174 23.9369 10.4762 23.9491 10.4343L23.9558 10.414C23.9654 10.3786 23.9741 10.3429 23.9817 10.3068V10.2894V10.2701C23.9856 10.2444 23.9891 10.2189 23.9923 10.1938C23.9955 10.1687 23.9981 10.1491 24 10.1349V10.1185C24 10.105 24 10.0918 24 10.0789C24 10.0467 24 10.0145 24 9.98232V9.96397C23.9946 9.75224 23.9443 9.54412 23.8523 9.35356C23.7604 9.163 23.6289 8.99442 23.4669 8.85912L15.1097 0.456815C14.9723 0.314733 14.8081 0.201718 14.6266 0.124426C14.4451 0.0471344 14.2501 0.00712689 14.053 0.00676044L14.0598 0Z",fill:"#030E2D"}))},Ge=f(n.Box)((function(e){return{cursor:e.isSortDisabled?"default":"pointer",flex:1,display:"flex",padding:"0 6px",overflow:"hidden",minWidth:0,alignItems:"center",whiteSpace:"nowrap",userSelect:"none",height:"30px"}})),Qe=f(n.Text)((function(){return{display:"flex",flexDirection:"column",alignItems:"center"}})),Ze=f(Ve)((function(e){var t=e.isArrowUp,n=e.isInvisible,a=e.theme;return{display:"flex",width:"10px",height:"10px",marginLeft:a.space[0],transform:t?"rotate(-90deg)":"rotate(90deg)",visibility:n?"hidden":"visible",":hover":{background:a.colors.grey[2]}}})),Je=function(e){return"desc"===e?"DESC":"asc"===e?"ASC":null},Xe=function(e){var n=e.children,a=e.useSort,o=e.sortKey,r=e.initialSortValue,i=e.onRessourcePlanningSort,l=e.isSortDisabled,s=m.useTheme(),c=a(),d=c.onSort,u=c.sortKeys,p=r||u[o]||null,f=t.useCallback((function(){var e=null===p?"desc":"desc"===p?"asc":null;l||(!i||"familyName"!==o&&"nextAvailability"!==o||i({sortBy:o,sortDirection:Je(e)}),d&&d({sortKey:o,sortValue:e}))}),[p,d,o]);return D.createElement(Ge,{onClick:f,isSortDisabled:l},D.createElement(Qe,{fontSize:"small",fontWeight:"bold"},n),null===p&&D.createElement(Ze,{theme:s,isInvisible:!0}),"desc"===p&&D.createElement(Ze,{theme:s,isArrowUp:!0}),"asc"===p&&D.createElement(Ze,{theme:s}))},$e=function(e){if(!0===e.isPercentage){var t=e.rate*e.external/e.min||0;return{totalAssignees:v.getRoundedToTwoDecimalsOrZero(e.rate)+"%",externalAssignees:v.getRoundedToTwoDecimalsOrZero(t)+"%",assignees:v.getRoundedToTwoDecimalsOrZero(e.rate-t)+"%",isExternalAssignees:e.external>0}}return{totalAssignees:e.min+" / "+e.max,externalAssignees:e.external+" / "+e.max,assignees:v.getRoundedToTwoDecimalsOrZero(e.min-e.external)+" / "+e.max,isExternalAssignees:e.external>0}},et=f(n.Box)((function(){return{width:"60px",height:"23px"}})),tt=f(n.Text)((function(e){var t=e.isOverValued,n=e.theme;return{color:t?n.colors.error[3]:void 0,font:"normal normal 600 12px/17px Open Sans",letterSpacing:0,lineHeight:"12px"}})),nt=function(e){var t,a,o=e.value,r=e.isPercentage,i=e.isShowAssignationStats,l=void 0!==i&&i,s=m.useTheme(),c=n.useSwitch(!1),d=c.active,u=c.on,p=c.off,f=0;r&&"undefined"!==typeof(null===o||void 0===o?void 0:o.rate)?(f=o.rate,t=Math.ceil(o.rate)+" %","undefined"!==typeof o.external&&l&&(a=$e({isPercentage:!0,rate:f,external:o.external,min:o.min}))):r||"undefined"===typeof(null===o||void 0===o?void 0:o.min)||"undefined"===typeof(null===o||void 0===o?void 0:o.max)||(f=100*o.min/o.max,t=v.getRoundedToOneDecimalOrZero(o.min)+" / "+v.getRoundedToOneDecimalOrZero(o.max),"undefined"!==typeof o.external&&l&&(a=$e({isPercentage:!1,external:o.external,min:o.min,max:o.max})));var g=function(e){return e>100||0===e?s.colors.error[0]:100===e?s.colors.success[0]:s.colors.alert[0]};return D.createElement(he,{isOpened:d,onClose:p,assigneesStats:"undefined"!==typeof a?{totalAssignees:a.totalAssignees,externalAssignees:a.externalAssignees,assignees:a.assignees}:void 0},D.createElement(et,{alignItems:"center",bg:g(f),display:"flex",justifyContent:"center",position:"relative"},"undefined"!==typeof a&&D.createElement(De,{isShowIcon:a.isExternalAssignees,onClick:u}),"undefined"!==typeof t&&D.createElement(tt,{theme:s,isOverValued:f>100,as:"span"},t)))},at={root:"ProjectDetailsHeader-module_root__2koIi",content:"ProjectDetailsHeader-module_content__1KQRn",name:"ProjectDetailsHeader-module_name__w3l_P","name-overflow":"ProjectDetailsHeader-module_name-overflow__3FaNJ","customer-wrapper":"ProjectDetailsHeader-module_customer-wrapper__1e0aD",customer:"ProjectDetailsHeader-module_customer__2svcR",suitcase:"ProjectDetailsHeader-module_suitcase__lLqP6"};function ot(){return(ot=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}_(".ProjectDetailsHeader-module_root__2koIi {\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  cursor: pointer; }\n\n.ProjectDetailsHeader-module_content__1KQRn {\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  flex-grow: 1;\n  cursor: default; }\n\n.ProjectDetailsHeader-module_name__w3l_P {\n  color: #142C3B;\n  letter-spacing: 0;\n  margin-bottom: 3px;\n  font: normal normal bold 13px/18px Open Sans;\n  width: 240px;\n  display: flex; }\n  .ProjectDetailsHeader-module_name-overflow__3FaNJ {\n    overflow: hidden;\n    white-space: nowrap;\n    text-overflow: ellipsis; }\n\n.ProjectDetailsHeader-module_customer-wrapper__1e0aD {\n  display: flex;\n  align-items: center; }\n\n.ProjectDetailsHeader-module_customer__2svcR {\n  margin-left: 7px;\n  font: normal normal 600 12px/17px Open Sans;\n  letter-spacing: 0;\n  color: #88889A; }\n\n.ProjectDetailsHeader-module_suitcase__lLqP6 {\n  width: 10px;\n  height: 10px;\n  margin-bottom: 5px;\n  filter: opacity(0.5) drop-shadow(0 0 0 #a7a7bc); }\n");var rt=D.createElement("path",{d:"M.6 6.3a.6.6 0 00-.6.6v14a.6.6 0 00.6.6h22.8a.6.6 0 00.6-.6v-14a.6.6 0 00-.6-.6H.6zm2.79 12.55a.6.6 0 01-.6-.6V9.54a.6.6 0 01.6-.6H21a.2.2 0 01.2.2v9.11a.6.6 0 01-.6.6H3.39zM8.3 4.8a.2.2 0 00.2-.2V3.04c0-.14.19-.28.37-.28H15c.18 0 .37.14.37.28V4.6c0 .11.09.2.2.2h2.37a.2.2 0 00.2-.2V2.62A2.39 2.39 0 0015.53.5H8.32a2.39 2.39 0 00-2.6 2.12V4.6c0 .11.09.2.2.2H8.3z"}),it=function(e){var t=e.title,n=a(e,i);return D.createElement("svg",ot({viewBox:"0 0 24 22",fill:"none"},n),t?D.createElement("title",null,t):null,rt)},lt=f(b.Link)({color:"#142C3B",textDecoration:"none",overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"}),st=f(n.Box)((function(){return{display:"flex",flexDirection:"column",justifyContent:"center",flexGrow:1,maxWidth:"230px",cursor:"default"}})),ct=f(n.Box)((function(e){var t=e.theme;return{color:t.colors.black[2],letterSpacing:0,marginBottom:"3px",fontSize:t.fontSizes.small,fontWeight:"bold",width:"240px",display:"flex"}})),dt=function(e){var t=e.className,a=e.name,o=e.customer,r=e.total,i=e.minAssignees,l=e.maxHeadCount,s=e.isCollapsed,c=e.isPercentage,d=e.handleHeaderClick,u=E(e,["className","name","customer","total","minAssignees","maxHeadCount","isCollapsed","isPercentage","handleHeaderClick"]),p=de(at.root,t),f=m.useTheme(),g=oe().getLinkToProject;return D.createElement(se,S({},u,{isColoredBackground:!0,backgroundColor:f.colors.grey[2],contentClassName:p,total:r,minAssignees:i,maxHeadCount:l,isPercentage:c}),D.createElement(st,null,D.createElement(ct,{theme:f},g?D.createElement(lt,{to:g(e.id),target:"_blank"},a):D.createElement(n.Text,{ellipsis:!0},a)),D.createElement(n.Box,{display:"flex",alignItems:"center"},D.createElement(n.Icon,{size:10,mr:0,color:f.colors.grey[6],as:it}),D.createElement(n.Text,{fontSize:"small",color:f.colors.grey[6]},o))),D.createElement(n.Box,{onClick:d},D.createElement(We,{isCollapsed:s})))},ut={container:"ProjectDetailsNeed-module_container__u5gwd",name:"ProjectDetailsNeed-module_name__cK8Q-","name-overflow":"ProjectDetailsNeed-module_name-overflow__bBbE5",arrows:"ProjectDetailsNeed-module_arrows__yxuRh",arrowDown:"ProjectDetailsNeed-module_arrowDown__Ml85t",arrowUp:"ProjectDetailsNeed-module_arrowUp__1cCEl",arrow:"ProjectDetailsNeed-module_arrow__1J73Y"};_(".ProjectDetailsNeed-module_container__u5gwd {\n  color: #142C3B;\n  letter-spacing: 0;\n  margin-bottom: 3px;\n  font: normal normal 600 14px/19px Open Sans;\n  cursor: pointer;\n  display: flex;\n  flex-direction: row;\n  align-items: center; }\n\n.ProjectDetailsNeed-module_name__cK8Q- {\n  max-width: 260px;\n  display: flex; }\n  .ProjectDetailsNeed-module_name-overflow__bBbE5 {\n    overflow: hidden;\n    white-space: nowrap;\n    text-overflow: ellipsis; }\n\n.ProjectDetailsNeed-module_name__cK8Q-:hover {\n  max-width: 220px;\n  border-bottom: 1px solid black; }\n\n.ProjectDetailsNeed-module_arrows__yxuRh {\n  display: flex;\n  flex-direction: row;\n  position: relative;\n  width: 40px;\n  align-items: center;\n  justify-content: center;\n  top: 3px; }\n\n.ProjectDetailsNeed-module_arrowDown__Ml85t {\n  display: flex;\n  width: 15px;\n  height: 15px;\n  transform: rotate(90deg);\n  margin-right: 3px; }\n\n.ProjectDetailsNeed-module_arrowUp__1cCEl {\n  display: flex;\n  width: 15px;\n  height: 15px;\n  transform: rotate(-90deg);\n  margin-right: 3px; }\n\n.ProjectDetailsNeed-module_arrow__1J73Y {\n  cursor: pointer;\n  transition: 0.4s;\n  padding: 2px; }\n\n.ProjectDetailsNeed-module_arrow__1J73Y:hover {\n  background-color: #e6e6f5; }\n");var pt=function(){var e=A(t.useState(!1),2),n=e[0],a=e[1];return{onMouseEnter:function(){return a(!0)},onMouseLeave:function(){return a(!1)},isHovered:n}},mt=f(n.Box)((function(e){var t=e.theme;return{color:t.colors.black[2],letterSpacing:0,marginBottom:"3px",fontSize:t.fontSizes.small,fontWeight:"bold",width:"240px",display:"flex"}})),ft=f(n.Box)((function(e){return{display:"flex",flexDirection:"row",position:"relative",width:e.isFirstOrLastNeed?"15px":"30px",alignItems:"center",justifyContent:"center",top:"1px"}})),gt=f(n.Box)((function(){return{cursor:"pointer",transition:"0.4s",padding:"2px"}})),ht=f(Ve)((function(e){return{display:"flex",width:"15px",height:"15px",transform:e.isArrowUp?"rotate(-90deg)":"rotate(90deg)",":hover":{background:e.theme.colors.grey[2]}}})),vt=f(n.Text)((function(){return{cursor:"pointer",transition:"0.5s",paddingLeft:"0px",":hover":{background:"none",textDecoration:"underline"}}})),bt=function(e){var t=e.id,a=e.isFirstNeed,o=e.isLastNeed,r=e.className,i=e.isPercentage,l=e.name,s=e.total,c=e.minAssignees,d=e.maxHeadCount,u=e.onClick,p=void 0===u?function(){}:u,f=E(e,["id","isFirstNeed","isLastNeed","className","isPercentage","name","total","minAssignees","maxHeadCount","onClick"]),g=m.useTheme(),h=de(ut.root,r),v=pt(),b=v.onMouseEnter,x=v.onMouseLeave,j=v.isHovered,y=G().onReOrderNeed,O=void 0===y?function(){}:y;return D.createElement(se,S({},f,{isColoredBackground:!0,backgroundColor:g.colors.grey[1],isFirstNeed:a,isPercentage:i,className:h,total:s,minAssignees:c,maxHeadCount:d}),D.createElement(mt,{theme:g,onMouseEnter:b,onMouseLeave:x},j&&D.createElement(ft,{isFirstOrLastNeed:a||o,mr:1},!a&&D.createElement(gt,{onClick:function(){O(t,"top")},theme:g},D.createElement(ht,{theme:g,isArrowUp:!0})),!o&&D.createElement(gt,{onClick:function(){O(t,"bottom")},theme:g},D.createElement(ht,{theme:g}))),D.createElement(n.Box,{maxWidth:"200px",display:"flex",onClick:p},D.createElement(vt,{fontSize:"small",fontWeight:"semiBold",ellipsis:!0},l))))},xt=function(){return t.createContext({metadataMap:{}})},jt={isCollapsed:!0},yt=function(e){var t,n=e.result,a=e.obj,o=e.existingMetadataMap,r=e.fieldKey,i="string"===typeof r?x.get(a,r):"function"===typeof r?r(a):void 0;return S(S({},n),((t={})[i]=S({},o[i]?o[i]:jt),t))},Ot=function(e){var n=e.data,a=e.fieldKey,o=e.children,r=e.context,i=A(t.useState({}),2),l=i[0],s=i[1],c=t.useRef(null),d=A(t.useState(c),2),u=d[0],p=d[1],m=A(t.useState(614),2),f=m[0],g=m[1];t.useEffect((function(){s(n.reduce((function(e,t){return yt({result:e,obj:t,existingMetadataMap:l,fieldKey:a})}),{}))}),[n,a]);var h=function(e){g(e)},v=function(e){p(e)},b=t.useCallback((function(e){var t,n=e.metadata,a=e.key,o=S(S({},l),((t={})[a]=S(S({},l[a]),n),t));return s(o),o}),[l,s]),x=t.useMemo((function(){return{metadataMap:l,metadataMapAsArray:function(){return Object.values(l)},setIsCollapsed:function(e){var t=e.value,n=e.key;return b({metadata:{isCollapsed:t},key:n})},get:function(e){return l[e]||jt},ref:u,setRefFn:v,sidebarRightLimit:f,setSidebarRightLimitFn:h}}),[l,jt]);return D.createElement(r.Provider,{value:x},o)};function Dt(){return t.createContext({data:{},sortKeys:{},onSort:function(e){}})}function _t(e){var n=e.onSort,a=e.data,o=e.children,r=e.context,i=A(t.useState(S({},a)),2),l=i[0],s=i[1],c=A(t.useState({}),2),d=c[0],u=c[1];t.useEffect((function(){s(S({},a))}),[a]);var p=t.useCallback((function(e){var t,o=e.sortKey,r=e.sortValue,i=((t={})[o]=r,t);u(i);var l=n({sortKeys:i,data:x.cloneDeep(a)});return s(l),l}),[a,d]),m=t.useMemo((function(){return{data:l,sortKeys:d,onSort:p}}),[l,d]);return D.createElement(r.Provider,{value:m},o)}var Pt=xt(),Ct=Dt(),wt=function(e){var t=e.sortKeys,n=e.data;return t["projects-and-needs"]&&(n.projectAllocations=x.orderBy(n.projectAllocations,(function(e){return e.project.name}),t["projects-and-needs"])),t["allocation-rate"]&&(n.projectAllocations=x.orderBy(n.projectAllocations,(function(e){return e.total}),t["allocation-rate"])),n},St=function(e){var t=e.children,n=e.callbacks,a=e.data;return D.createElement(_t,{onSort:wt,context:Ct,data:a},D.createElement(Ct.Consumer,null,(function(e){var a=e.data;return D.createElement(Q,{callbacks:n},D.createElement(Ot,{context:Pt,data:null===a||void 0===a?void 0:a.projectAllocations,fieldKey:"project.id"},t))})))};function Et(){return t.useContext(Pt)}function At(){return t.useContext(Ct)}var Tt=function(e){var a=e.totals,o=e.allocations,r=e.isPercentage,i=n.useTranslate(),l=Et(),s=G().onEditNeed;return t.useMemo((function(){return T([{component:pe,props:{text:i("num_staffing_project",a.nbProjects)+", "+i("staffing_project_need_num",a.nbNeeds),total:a.allocationRate,minAssignees:a.minAssignees,maxHeadCount:a.maxHeadCount,isPercentage:r}}],A(o.reduce((function(e,t){var n=function(e){s&&s(e)},a=function(){l.setIsCollapsed({value:!o,key:t.project.id})},o=l.get(t.project.id).isCollapsed;return T(T(T([],A(e)),[{component:dt,props:S(S({total:t.total,minAssignees:t.minAssignees,maxHeadCount:t.maxHeadCount},t.project),{isCollapsed:o,handleHeaderClick:a,isPercentage:r})}]),A(o?[]:t.needs.map((function(e,a){var o=e.need,i=e.total,l=e.minAssignees,s=e.maxHeadCount;return{component:bt,props:{onClick:function(){return n(o.id)},isPercentage:r,name:o.name,total:i,minAssignees:l,maxHeadCount:s,isFirstNeed:0===a,isLastNeed:a+1===t.needs.length,id:o.id}}}))))}),[])))}),[o,l,s,a])},Nt={row:"index-module_row__6a5hf"};_(".index-module_row__6a5hf {\n  min-height: 51px;\n  height: 51px; }\n");var kt=function(e){var n=e.totals,a=e.allocations,o=e.isPercentage,r=Et();return t.useMemo((function(){return T([{component:Re,props:{values:n.byPeriod,className:Nt.row,isSelectable:!1,isPercentage:o}}],A(a.reduce((function(e,t){var n=r.get(t.project.id).isCollapsed;return T(T(T([],A(e)),[{component:Re,props:{values:t.byPeriod,className:Nt.row,isSelectable:!1,isPercentage:o,isProjectLine:!0}}]),A(n?[]:t.needs.map((function(e,t){var n=0===t;return{component:Re,props:{values:e.byPeriod,className:Nt.row,isSelectable:!1,isPercentage:o,isFirstChild:n}}}))))}),[])))}),[a,r])},It=function(e){var t=e.isPercentage,a=n.useTranslate(),o=At().data,r=Tt({totals:o.totals,allocations:o.projectAllocations,isPercentage:t}),i=kt({totals:o.totals,allocations:o.projectAllocations,isPercentage:t}),l=D.createElement(Ye,{columns:[D.createElement(Xe,{useSort:At,sortKey:"projects-and-needs"},a("staffing_project",10)),D.createElement(Xe,{useSort:At,sortKey:"allocation-rate"},a("allocationRatesView",10))]});return D.createElement(re,{periodType:o.periodType,startDate:o.startDate,endDate:o.endDate,getLinkToProject:o.getLinkToProject,fixedHeaderChildren:l,sideBarChildren:r,contentChildren:i,isPercentage:t,type:"allocations"})},Mt=function(e){var t=e.data,n=e.isPercentage,a=e.callbacks;return D.createElement(St,{callbacks:a,data:t},D.createElement(It,{isPercentage:n}))},Rt={name:"index-module_name__12mWA","customer-wrapper":"index-module_customer-wrapper__3q8jq",customer:"index-module_customer__27ooe"};_(".index-module_name__12mWA {\n  color: #142C3B;\n  letter-spacing: 0;\n  margin-bottom: 3px;\n  font: normal normal bold 13px/18px Open Sans; }\n\n.index-module_customer-wrapper__3q8jq {\n  display: flex;\n  align-content: center; }\n\n.index-module_customer__27ooe {\n  margin-left: 7px;\n  font: normal normal 600 12px/17px Open Sans;\n  letter-spacing: 0;\n  color: #88889A; }\n");var Ft=function(e){var t=e.className,n=e.person,a=e.total,o=e.isFirstChild,r=(e.isLastChild,E(e,["className","person","total","isFirstChild","isLastChild"])),i=de(Rt.root,t);return D.createElement(se,S({},r,{isFirstNeed:o,className:i,total:a}),D.createElement(Ue,{user:n}))},Lt=function(e){var a=e.totals,o=e.allocations,r=e.isPercentage,i=n.useTranslate({capitalize:!0});return t.useMemo((function(){return T([{component:pe,props:{text:i("num_resources",a.nbPersons),total:a.allocationRate,isPercentage:r}}],A(o.reduce((function(e,t,n){return T(T([],A(e)),[{component:Ft,props:{person:t.person,total:t.total,isPercentage:r,isFirstChild:0===n,isLastChild:n===o.length-1}}])}),[])))}),[o,a.nbPersons,a.allocationRate])},Bt={row:"index-module_row__1Tte2"};_(".index-module_row__1Tte2 {\n  min-height: 51px;\n  height: 51px; }\n");var Ht=function(e){var n=e.totals,a=e.allocations;return t.useMemo((function(){return T([{component:Re,props:{className:Bt.row,values:n.byPeriod,byPeriod:n.byPeriod,isSelectable:!1,isPercentage:!0}}],A(a.reduce((function(e,t,n){var a;return T(T([],A(e)),[{component:Re,props:{key:null===(a=t.person)||void 0===a?void 0:a.id,className:Bt.row,values:t.byPeriod,byPeriod:t.byPeriod,isSelectable:!1,isPercentage:!0,isFirstChild:0===n}}])}),[])))}),[a])},Wt=Dt(),zt=function(e){var t=e.children,n=e.data,a=function(e){var t=e.sortKeys,n=e.data;return t["allocation-rate"]&&(n.allocations=x.orderBy(n.allocations,(function(e){return e.total}),t["allocation-rate"])),t.resources&&(n.allocations=x.orderBy(n.allocations,(function(e){return e.person.familyName+" "+e.person.givenName}),t.resources)),n};return D.createElement(_t,{onSort:a,context:Wt,data:n},t)};function Kt(){return t.useContext(Wt)}var Ut=function(e){var t=e.isPercentage,a=e.totalCount,o=e.loadMoreRows,r=e.onRessourcePlanningSort,i=e.familyNameSortDirection,l=e.allocationRatesTotalSortDirection,s=n.useTranslate(),c=Kt().data,d=Lt({totals:c.totals,allocations:c.allocations,isPercentage:t}),u=Ht({totals:c.totals,allocations:c.allocations}),p=D.createElement(Ye,{columns:[D.createElement(Xe,{useSort:Kt,initialSortValue:i,onRessourcePlanningSort:r,sortKey:"familyName"},D.createElement(n.Text,{fontWeight:"bold",fontSize:11},s("resources"))),D.createElement(Xe,{useSort:Kt,isSortDisabled:!0,initialSortValue:l,onRessourcePlanningSort:r,sortKey:"allocationRates.total"},D.createElement(n.Text,{fontWeight:"bold",fontSize:11},s("allocation_rate")))]});return D.createElement(re,{startDate:c.startDate,endDate:c.endDate,periodType:c.periodType,fixedHeaderChildren:p,getLinkToUserProfile:c.getLinkToUserProfile,sideBarChildren:d,contentChildren:u,totalCount:a,loadMoreRows:o,type:"allocations"})},qt=function(e){var t=e.data,n=e.isPercentage,a=e.totalCount,o=e.loadMoreRows,r=e.onRessourcePlanningSort,i=e.familyNameSortDirection,l=e.allocationRatesTotalSortDirection;return D.createElement(zt,{data:t},D.createElement(Ut,{isPercentage:n,totalCount:a,loadMoreRows:o,onRessourcePlanningSort:r,familyNameSortDirection:i,allocationRatesTotalSortDirection:l}))},Yt=xt(),Vt=xt(),Gt=Dt(),Qt=function(e,t,n){return void 0===n&&(n=function(e){return e.name}),n(t).toLowerCase().localeCompare(n(e).toLowerCase())},Zt=function(e){return e?e.reduce((function(e,t){return T(T([],A(e)),A(t.needs||[]))}),[]).map((function(e){var t=e.allocations;if(t.length>0){var n=[],a=[];return t.forEach((function(e){"externalResource"!==e.person.displayName?n.push(e):a.push(e)})),n.sort((function(e,t){return j.sortByName(e,t,(function(e){return e.person.familyName||"zzzzzzzzzzzzzzzzzzzzzzzzzz"}))})),e.allocations=T(T([],A(n)),A(a)),e}return e})):[]},Jt=function(e){var t=e.sortKeys,n=e.data;return t.projects&&"desc"===t.projects&&(n.projects=n.projects.sort((function(e,t){return Qt(e,t,(function(e){return e.project.name}))}))),t["projects-allocation-rate"]&&(n.projects=x.orderBy(n.projects,(function(e){return e.total}),t["projects-allocation-rate"])),n},Xt=function(e){var t=e.children,n=e.data,a=e.callbacks;return D.createElement(Q,{callbacks:a},D.createElement(_t,{onSort:Jt,context:Gt,data:n},D.createElement(Gt.Consumer,null,(function(e){var n=e.data;return D.createElement(Ot,{context:Yt,data:(null===n||void 0===n?void 0:n.projects)?n.projects:[],fieldKey:"project.id"},D.createElement(Ot,{context:Vt,data:Zt(n.projects),fieldKey:"projectNeed.id"},t))}))))};function $t(){return t.useContext(Yt)}function en(){return t.useContext(Vt)}function tn(){return t.useContext(Gt)}var nn={noborder:"index-module_noborder__3H4fn"};_(".index-module_noborder__3H4fn {\n  border-bottom: 0px solid transparent; }\n");var an=f(n.Box)((function(e){var t=e.theme,n=e.contentSquares,a=e.style,o=e.isLocked;return S({width:51*n.length,display:"flex",flexDirection:"row",position:"relative",borderTop:"2px solid black",borderBottom:"1.5px solid black",borderRight:"0.5px solid "+t.colors.grey[0],opacity:o?"0.75":"none",background:o?t.colors.grey[2]:"none"},a)})),on=function(e){var t=e.className,n=e.assignType,a=e.id,o=e.style,r=e.isPercentage,i=e.isLocked,l=oe().contentSquares,s=m.useTheme();return D.createElement(an,{style:o,contentSquares:l,theme:s,isLocked:i},D.createElement(Re,{isSelectable:!i,isLocked:i,isPercentage:r,id:a,assignType:n,values:l,byPeriod:[],squareClassName:nn.noborder,className:t}))};function rn(){return(rn=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}var ln=function(e){var t=e.title,n=a(e,l);return D.createElement("svg",rn({viewBox:"0 0 1000 1000"},n),t?D.createElement("title",null,t):null,"&gt;",D.createElement("path",{d:"M555.856 230.551a40.004 40.004 0 00-27.866 68.688l160.612 160.613H215.256a40.148 40.148 0 100 80.289h473.346L527.99 700.754a40.004 40.004 0 1056.569 56.569l226.525-226.528a40.004 40.004 0 0011.43-15.74 40.148 40.148 0 000-.002 40.004 40.004 0 001.156-3.32 40.148 40.148 0 00.184-.559 40.004 40.004 0 00.691-2.898 40.148 40.148 0 00.023-.098 40.004 40.004 0 00.112-.469 40.148 40.148 0 00.105-.51 40.004 40.004 0 00.283-2.064 40.004 40.004 0 00.211-1.576 40.148 40.148 0 00.034-.469 40.004 40.004 0 00.043-1.074 40.004 40.004 0 00.085-2.623 40.148 40.148 0 00-.006-.12 40.004 40.004 0 00-.02-.378 40.004 40.004 0 000-.012 40.004 40.004 0 00-.001-.031 40.004 40.004 0 00-14.436-29.762l-226.42-226.42a40.004 40.004 0 00-28.702-12.119z",style:{lineHeight:"normal",textIndent:0,textAlign:"start",textDecorationLine:"none",textDecorationStyle:"solid",textDecorationColor:"#000",textTransform:"none",blockProgression:"tb",whiteSpace:"normal",isolation:"auto",mixBlendMode:"normal",solidColor:"#000",solidOpacity:1},color:"#000",fontWeight:400,fontFamily:"sans-serif",overflow:"visible",fillRule:"evenodd"}))},sn={info:"index-module_info__3wWPt",name:"index-module_name__2KNbj",status:"index-module_status__K0PQ_",confirmed:"index-module_confirmed__3Cqup",lead:"index-module_lead__2q32x",relative:"index-module_relative__2-2ae",project:"index-module_project__14CHr"};_(".index-module_info__3wWPt {\n  display: flex;\n  flex-direction: row;\n  position: absolute;\n  align-items: center;\n  left: 20px;\n  height: 50px; }\n\n.index-module_name__2KNbj {\n  font-size: 12px;\n  font-weight: bold; }\n\n.index-module_status__K0PQ_ {\n  margin-left: 40px;\n  width: 120px;\n  height: 28px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  background-color: #ccfae3;\n  font-size: 12px;\n  font-weight: bold;\n  border-radius: 3px; }\n\n.index-module_confirmed__3Cqup {\n  background-color: #ccfae3; }\n\n.index-module_lead__2q32x {\n  background-color: #f2f2ff; }\n\n.index-module_relative__2-2ae {\n  position: relative;\n  border-top: 0.5px solid black;\n  border-bottom: 0.5px solid black;\n  border-right: 0.5px solid #e6e6f5; }\n\n.index-module_project__14CHr {\n  background-color: #DDDFF2;\n  border-right: 0.5px solid #DDDFF2; }\n");var cn=f(n.Box)((function(e){var t=e.theme,n=e.contentSquares,a=e.style;return S({width:51*n.length,display:"flex",flexDirection:"row",position:"relative",borderTop:"2px solid black",borderRight:"0.5px solid "+t.colors.grey[0]},a)})),dn=f(n.Box)((function(){return{display:"flex",flexDirection:"row",position:"absolute",alignItems:"center",left:"20px",height:"50px"}})),un=function(e){var t=e.project,a=e.style,o=oe().contentSquares,r=m.useTheme();return D.createElement(cn,{style:a,contentSquares:o,theme:r},D.createElement(dn,null,D.createElement(h.ProjectStatus,{status:t.status,ml:1}),D.createElement(n.Text,{fontSize:"small",fontWeight:"bold",color:"grey.6",ml:2},p.localeMoment(t.startDate).format("DD/MM/YYYY")),D.createElement(n.Icon,{color:"grey.6",as:ln,size:16,ml:1}),D.createElement(n.Text,{fontSize:"small",fontWeight:"bold",color:"grey.6",ml:1},p.localeMoment(t.endDate).format("DD/MM/YYYY"))),o.map((function(e,t){return D.createElement(Ce,{className:sn.project,date:e,key:t})})))},pn=function(){var e=m.useTheme();return{squareStyle:D.useCallback((function(t){var n,a;return"number"!==typeof t?n=e.colors.grey[1]:t>100?(n=e.colors.error[0],a=e.colors.primary[3]):100===t?(n=e.colors.success[0],a=e.colors.black[3]):t<100&&t>0?(n=e.colors.alert[0],a=e.colors.black[3]):(n=e.colors.error[0],a=e.colors.black[3]),{backgroundColor:n,alingItems:"center",justifyContent:"center",fontWeight:"bold",color:a}}),[e])}},mn=f(n.Box)((function(e){var t=e.isFirstNeed,n=e.contentSquares,a=e.style;return S({display:"flex",flexDirection:"row",width:51*n.length,borderTop:t?"2px solid black":"0.5px solid black"},a)})),fn=function(e){var t=e.isAllocationLoading,n=e.isFirstNeed,a=e.need,o=e.style,r=e.isPercentage,i=oe().contentSquares,l=pn().squareStyle;return D.createElement(mn,{style:o,contentSquares:i,isFirstNeed:n},i.map((function(e,n){var o,i,s=a.byPeriod[n]||void 0,c=null;return"undefined"!==typeof s&&(r?(o=(c=s.rate||0)+"%",i=$e({isPercentage:!0,external:s.external,min:s.min,rate:c})):(c=s.min/s.max*100,o=s.min+" / "+s.max,i=$e({isPercentage:!1,external:s.external,min:s.min,max:s.max}))),D.createElement(Ce,{style:l(c),content:o||"",isAllocationLoading:t,key:n,date:e,assigneesStats:"undefined"!==typeof i?{assignees:i.assignees,externalAssignees:i.externalAssignees,totalAssignees:i.totalAssignees}:void 0,isExternalAssignees:null===i||void 0===i?void 0:i.isExternalAssignees})})))},gn={edges:{left:!0,right:!0,bottom:!1,top:!1}},hn={edges:{left:!1,right:!1,bottom:!1,top:!1}},vn=864e5,bn=36e5,xn=50,jn=30,yn=7,On=e.AllocationType.WORK,Dn=e.AllocationStatus.PROVISION,_n=e.AllocationStatus.SIMULATION,Pn=function(e,t,a,o,r){var i=n.useTranslate({capitalize:!0}),l=A(D.useState(!1),2),s=l[0],c=l[1],d=A(D.useState(!1),2),u=d[0],p=d[1],m=H().dateRangeOverlaps,f=G(),g=f.onEditAssignment,h=f.onEditScheduledPeriod,v=oe().setSelectedAssignment,b=function(){return p(!0)},x=function(){return p(!1)},y=function(t){p(!0),v(e),c(!0),t.stopPropagation()},O=function(e){v(null),p(!1),c(!1),e.stopPropagation()},_=D.useMemo((function(){for(var t=-1,n=0;n<o.length;n++)if(-1!==o[n].findIndex((function(t){return t.id===e.id}))){t=n;break}return 32*t+10}),[t,m,a]),P=D.useMemo((function(){var t,n;return{display:s?"none":"flex",top:_,backgroundColor:e.type===On?null===(t=e.project)||void 0===t?void 0:t.colorHex:"#C1C1D8",opacity:e.type===On&&r?(null===(n=e.project)||void 0===n?void 0:n.name)===r||u?1:.5:1}}),[e,s,_,u,r]),C=D.useCallback((function(e,t){var n,a;if(e.type===On){var o="";return e.status===Dn?o="["+i("provisional")+"]":e.status===_n&&(o="["+i("simulation")+"]"),e.isExternalAssignment?o+" "+(null===(n=e.project)||void 0===n?void 0:n.name)+" - "+(t?t+" -":"")+" "+e.rate+"%":o+" "+(null===(a=e.projectAndNeedName)||void 0===a?void 0:a.replace("@"," - "))+" - "+e.rate+"%"}return j.maj(e.type)}),[]);return{indexPosition:_,dragStart:y,styles:P,dragEnd:O,onMouseLeave:x,onMouseOver:b,isHovered:u,onClickAssignment:function(e){if(g&&"function"===typeof g)return g(e)},onClickScheduledPeriod:function(e){if(h&&"function"===typeof h)return h(e)},assignmentName:C}},Cn=function(n,a,o,r){var i=A(D.useState(!1),2),l=i[0],s=i[1],c=G().onChangeAssignmentDates,d=(oe().calendarStructure,D.useCallback((function(e){return p.localeMoment(e).startOf("isoWeek").hour(12).toDate()}),[])),u=D.useCallback((function(e){return p.localeMoment(e).startOf("month").hour(12).toDate()}),[]),m=D.useCallback((function(t){var n=t.dateA,a=t.dateB,o=t.selectedPeriodStartDate,r=t.selectedPeriodEndDate,i=t.assignmentStartDate,l=t.assignmentEndDate,s=t.periodType,c=t.data;if(n===a)return{value:0,isInRange:!0};if(p.localeMoment(i).isAfter(p.localeMoment(r))||p.localeMoment(l).isBefore(p.localeMoment(o)))return{value:0,isInRange:!1};n.setHours(12,0,0,0),a.setHours(12,0,0,0);var m=p.localeMoment(i).isBefore(p.localeMoment(o)),f=function(){if("left"===c){if(s===e.PeriodType.WEEK)return d(n);if(s===e.PeriodType.MONTH)return u(n)}return"width"===c&&m?new Date(d(o).getTime()):new Date(n.getTime())}().getTime()-a.getTime();return{value:function(){var t=Math.abs(Math.round(f/vn)),n=s===e.PeriodType.WEEK?7:1;return"left"===c?m?0-n:t:m?t+n+(s===e.PeriodType.DAY?1:0):t+(s===e.PeriodType.DAY||s===e.PeriodType.MONTH||s===e.PeriodType.WEEK?1:0)}(),isInRange:!0}}),[u,d]),f=D.useCallback((function(){var t=o===e.PeriodType.WEEK?d(n):n,i=m({selectedPeriodStartDate:t,selectedPeriodEndDate:r,dateA:t,dateB:a.startDate,assignmentStartDate:a.startDate,assignmentEndDate:a.endDate,periodType:o,data:"left"}).value;return o===e.PeriodType.WEEK?i/yn:o===e.PeriodType.MONTH?i/jn:o===e.PeriodType.DAY?i:0}),[m,a,n,o]),g=D.useCallback((function(){var t=m({selectedPeriodStartDate:n,selectedPeriodEndDate:r,dateA:a.startDate,dateB:a.endDate,assignmentStartDate:a.startDate,assignmentEndDate:a.endDate,periodType:o,data:"width"}).value;return o===e.PeriodType.WEEK?t/yn:o===e.PeriodType.MONTH?t/jn:o===e.PeriodType.DAY?t:0}),[m,a,o]),h=A(D.useState({x:0,lastX:0,width:0,lastWidth:0,sd:p.localeMoment(p.getDateDay(new Date(a.startDate))),ed:p.localeMoment(p.getDateDay(new Date(a.endDate))),isInRange:!0}),2),v=h[0],b=h[1];return t.useEffect((function(){b({x:f()*xn,lastX:f()*xn,width:g()*xn,lastWidth:g()*xn,sd:p.localeMoment(new Date(a.startDate)),ed:p.localeMoment(new Date(a.endDate)),isInRange:m({selectedPeriodStartDate:n,selectedPeriodEndDate:r,dateA:n,dateB:a.startDate,assignmentStartDate:a.startDate,assignmentEndDate:a.endDate,periodType:o,data:"left"}).isInRange})}),[a,f,g]),{onResizeEnd:function(){b((function(e){var t=e.width,n=e.lastWidth,o=e.lastX,r=e.x,i=e.ed,l=e.sd,s=e.isInRange,d=Math.ceil(o/xn)*xn-o,u=n-d-Math.floor((n-d)/xn)*xn,m=n,f=o,g=function(){var e=t-n;return d>0&&r!==o||u>0&&r===o?e-(xn-d):e}(),h=Math.ceil(g/xn)*xn;return r!==o?(m+=h,f-=h,d&&(m+=xn-d,f-=xn-d),c&&"function"===typeof c&&c(a.id,p.getDateDay(l).toDate(),p.getDateDay(i).toDate())):(m+=h,u>0&&(m+=xn-u),c&&"function"===typeof c&&c(a.id,p.getDateDay(l).toDate(),p.getDateDay(i).toDate())),{width:m,x:f,lastWidth:m,lastX:f,ed:p.getDateDay(i),sd:p.getDateDay(l),isInRange:s}})),s(!1)},onResizeMove:function(t){s(!0);var a=t.rect.width,r=t.deltaRect.left;b((function(t){var i=t.sd,l=t.ed,s=t.x+r,c=new Date(p.getDateDay(i).toDate()),u=new Date(p.getDateDay(l).toDate()),m=t.x===t.lastX&&0===r,f=Math.floor(s/xn),g=Math.floor((s+a)/xn);if(o===e.PeriodType.DAY&&(m?u.setTime(n.getTime()+g*vn-bn):c.setTime(n.getTime()+f*vn)),o===e.PeriodType.WEEK){var h=d(n);if(f*=yn,g*=yn,m){var v=new Date(h);p.localeMoment(new Date(v)).add(g,"days").toDate(),u.setTime(h.getTime()+g*vn-vn)}else c.setTime(h.getTime()+f*vn)}return o===e.PeriodType.MONTH&&(g*=jn,f*=jn,m?(u.setTime(n.getTime()+g*vn),u.setDate(1),u.setTime(u.getTime()-vn)):(c.setTime(n.getTime()+f*vn),c.setDate(1))),S(S({},t),{x:s,width:a,ed:p.localeMoment(u),sd:p.localeMoment(c)})}))},coordinate:v,calculateWidth:g,calculateLeft:f,isResizing:l}},wn=27,Sn=60,En=f(n.Box)((function(e){return{position:"sticky",left:e.leftPosition}})),An=f(n.Box)((function(){return{position:"absolute",borderRadius:"2px",overflow:"hidden",whiteSpace:"nowrap",height:"24px",alignItems:"center",boxShadow:"0px 1.5px 3px #636363",justifyContent:"space-between",cursor:"pointer"}}),(function(t){var n=t.status;return n===e.AllocationStatus.SIMULATION?{backgroundImage:"repeating-linear-gradient(-45deg, transparent, transparent 2px, transparent 2px, rgba(0, 0, 0, 0.132) 4px)"}:n===e.AllocationStatus.PROVISION?{backgroundImage:"radial-gradient(circle, rgba(0, 0, 0, 0.132) 1px, transparent 1px), radial-gradient(circle, rgba(0, 0, 0, 0.132) 1px, transparent 1px)",backgroundSize:"5px 5px"}:{}})),Tn=function(a){var o=a.assignment,r=a.assignments,i=a.index,l=a.getRef,s=a.sidebarRightLimit,c=a.width,d=a.x,u=a.need,m=a.isResizing,f=a.isInRange,g=a.currentProjectName,h=a.sd,v=a.ed,b=a.contentLines,x=(a.periodType,Pn(o,r,i,b,g)),y=x.styles,O=x.dragStart,_=x.dragEnd,P=x.onMouseLeave,C=x.onMouseOver,w=x.isHovered,S=x.indexPosition,E=x.onClickAssignment,A=x.onClickScheduledPeriod,T=x.assignmentName,N=G().onDeleteAssignment,k=t.useRef(null),I=n.useTranslate(),M=n.useSwitch(!1),R=M.active,F=M.on,L=M.off,B=n.useSwitch(!1),H=function(e){N&&(e.preventDefault(),F())},W=function(){var e;B.off(),N&&o.assignmentId&&N(o.assignmentId,null===(e=o.project)||void 0===e?void 0:e.id,o.userId)},z=D.useMemo((function(){return m||w}),[m,w]),K=t.useMemo((function(){if(null===k||void 0===k?void 0:k.current)return k.current.getBoundingClientRect().left}),[w,null===k||void 0===k?void 0:k.current]),U=t.useMemo((function(){return"undefined"!==typeof K?s>K?s-K+15+(d<0?Sn:wn):d<0?Sn:wn:wn}),[K,s,d]),q=t.useMemo((function(){var e=w?30:10;return Math.max(Math.round(c)-e,0)+"px"}),[c,w]),Y=t.useMemo((function(){return 0===c?1.5:c}),[c]),V=t.useMemo((function(){return j.getContrastedTextColorFromBackgroundHexColor(y.backgroundColor)}),[y.backgroundColor]);return f?D.createElement("div",null,z&&D.createElement("div",{style:{left:d-75,top:S+3},className:"cc-scheduler-allocation-time"},p.localeMoment(h).format("DD/MM/YYYY")),D.createElement(An,{ref:l,status:o.status,left:d,width:Y,top:y.top,display:y.display?y.display:"flex",opacity:y.opacity,bg:y.backgroundColor,draggable:!0,onMouseOver:C,onMouseLeave:P,onDragStart:O,onDragEnd:_,onContextMenu:H},D.createElement("div",{className:z?"cc-scheduler-allocation-drag":""},z&&D.createElement("div",{className:"cc-scheduler-allocation-extend-left"})),D.createElement(n.MenuSelect.Target,{width:o.type===e.AllocationType.WORK?"inherit":"100%",m:"0px"},D.createElement(n.Box,{onClick:function(){o.type===e.AllocationType.WORK&&o.assignmentId?E(o.assignmentId):A(o.id)},display:"flex",justifyContent:"flex-start",width:o.type===e.AllocationType.WORK?"inherit":"100%",className:"cc-scheduler-allocation-text"},D.createElement(En,{leftPosition:U,ref:k,maxWidth:q},D.createElement(n.TextWithAutoTooltipOnEllipsis,{tooltipTitle:T(o,u),fontSize:"small",color:V,fontWeight:"semiBold"},T(o,u)))),D.createElement(n.MenuSelect,{onClose:L,isOpened:R},D.createElement(n.MenuOption,{onClick:function(){L(),B.on()}},I("delete")))),D.createElement("div",{className:z?"cc-scheduler-allocation-drag":""},z&&D.createElement("div",{className:"cc-scheduler-allocation-extend-right"}))),z&&D.createElement("div",{style:{left:d+c+15,top:S+3},className:"cc-scheduler-allocation-time"},p.localeMoment(v).format("DD/MM/YYYY")),D.createElement(n.ConfirmModal,{isOpened:B.active,onConfirm:W,onCancel:B.off},D.createElement(n.Box,{display:"flex",flexDirection:"column"},D.createElement(n.Text,{fontSize:"big",fontWeight:"bold"},I("confirm_delete_staffing_project_assignment"))))):null},Nn=D.memo(Tn),kn=y(Nn),In=function(e){var t=Cn(e.startDate,e.assignment,e.periodType,e.endDate),n=t.coordinate,a=t.onResizeMove,o=t.onResizeEnd,r=t.isResizing;return D.createElement(kn,S({key:e.assignment.id+"_"+e.startDate+"_"+e.endDate,resizable:!0===e.isLocked?hn:gn,onResizeMove:a,onResizeEnd:o,isResizing:r},e,n))},Mn=D.memo(In),Rn={top:"index-module_top__34tKQ"};_(".index-module_top__34tKQ {\n  justify-content: flex-start; }\n");var Fn=function(e){var t=e.lines,n=e.endDate,a=e.allocation,o=e.startDate,r=e.periodType,i=e.need,l=e.byPeriod,s=e.projectName,c=e.style,d=e.height,u=e.isPercentage,p=e.isLocked,m=oe().contentSquares,f=$t().sidebarRightLimit;return D.createElement("div",{style:S({position:"relative",width:50.5*(m.length+1),display:"flex"},c)},a.assignments.map((function(e,l){return D.createElement(Mn,{isLocked:p,sidebarRightLimit:f,contentLines:t,startDate:o,endDate:n,periodType:r,index:l,key:l,assignment:e,assignments:a.assignments,need:i.name,currentProjectName:s})})),D.createElement("div",{className:"cc-scheduler-content-right-row"},D.createElement(Re,{id:a.person.id,needId:i.id,isAssignmentSquare:!0,isPercentage:u,squareClassName:Rn.top,squareStyle:{height:d},assignType:"assignment",assignments:a.assignments,byPeriod:l,values:m,isLocked:p})))},Ln={project:"index-module_project__2KILy",bordersassign:"index-module_bordersassign__2CAZm"};_(".index-module_project__2KILy {\n  border-top: 0.5px solid black;\n  border-bottom: 0.5px solid black; }\n\n.index-module_bordersassign__2CAZm {\n  border-top: 0.5px solid black; }\n");var Bn=function(e,n){var a=e.projects,o=e.startDate,r=e.endDate,i=e.periodType,l=en(),s=$t(),c=H().multipleDateRangeOverlaps;return t.useMemo((function(){return T([],A(a.reduce((function(e,t){var a=t.needs,d=s.get(t.project.id).isCollapsed;return T(T(T(T([],A(e)),[{component:un,props:{project:t.project}}]),A(d?[]:a.reduce((function(e,a,s){var d=l.get(a.projectNeed.id).isCollapsed;return T(T(T(T([],A(e)),[{component:fn,props:{isAllocationLoading:!0===t.allocationRatesLoading,need:a,isPercentage:n,isFirstNeed:0===s}}]),A(d?[]:a.allocations.map((function(e){var l=c(e.assignments),s=l.height,d=l.lines;return{component:Fn,props:{lines:d,projectName:t.project.name,startDate:o,endDate:r,periodType:i,allocation:e,need:a.projectNeed,height:s,isPercentage:n,isLocked:!0===a.isLocked},height:s}})))),A(d?[]:[{component:on,props:{id:a.projectNeed.id,assignType:"resource",isPercentage:n,isLocked:!0===a.isLocked}}]))}),[]))),A(d?[]:[{component:on,props:{id:t.project.id,assignType:"need",className:Ln.bordersassign}}]))}),[])))}),[l,s,o,c,i,a])};function Hn(){return(Hn=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}var Wn=D.createElement("path",{d:"M20.5 10H14V3.5c0-.3-.2-.5-.5-.5h-3c-.3 0-.5.2-.5.5V10H3.5c-.3 0-.5.2-.5.5v3c0 .3.2.5.5.5H10v6.5c0 .3.2.5.5.5h3c.3 0 .5-.2.5-.5V14h6.5c.3 0 .5-.2.5-.5v-3c0-.3-.2-.5-.5-.5z"}),zn=function(e){var t=e.title,n=a(e,s);return D.createElement("svg",Hn({viewBox:"0 0 24 24"},n),t?D.createElement("title",null,t):null,Wn)};function Kn(){return(Kn=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}var Un=D.createElement("path",{d:"M10.997 8.6a4.56 4.56 0 001.707-4.92 4.641 4.641 0 00-1.56-2.601A4.625 4.625 0 008.311 0h-.539a4.636 4.636 0 00-2.88 1.071A4.652 4.652 0 003.312 3.71a4.518 4.518 0 001.637 4.85c-3.234.63-5.16 3.44-4.93 7.19V16h2.265v-.29a4.298 4.298 0 012.106-4.25 7.335 7.335 0 017.226 0 4.336 4.336 0 012.136 4.24v.29h2.235v-.25c.19-3.74-1.736-6.51-4.99-7.14zm-.799-2.24a2.347 2.347 0 01-2.195 1.1h-.19a2.362 2.362 0 01-2.146-1.15 3.005 3.005 0 010-3 2.257 2.257 0 011.996-1.06h.41a2.342 2.342 0 012.136 1.15 3.004 3.004 0 01.03 2.96h-.04z"}),qn=function(e){var t=e.title,n=a(e,c);return D.createElement("svg",Kn({width:16,height:16,fill:"none"},n),t?D.createElement("title",null,t):null,Un)},Yn=function(e){var t=e.isLocked,a=e.name,o=e.isProjectNeed,r=void 0!==o&&o,i=e.onClick,l=e.style,s=m.useTheme(),c=f(n.Button)((function(){return{borderTop:r?"2px solid black":"0.5px solid black",fontWeight:s.fontWeights.semiBold,fontSize:s.fontSizes.small,color:s.colors.black[2],justifyContent:"flex-start"}}));return D.createElement(c,{width:"100%",onClick:i,disabled:t,appearance:"clean",maxWidth:500,style:l,icon:r?zn:qn},a)},Vn=f(n.Box)((function(e){var t=e.theme,n=e.styles;return S({height:50,width:"100%",borderBottom:"0.5px solid "+t.colors.grey[2],display:"flex",alignItems:"center",paddingLeft:20,flexDirection:"row",position:"relative",justifyContent:"space-between"},n)})),Gn=f(n.Box)((function(e){var t=e.isLocked,n=e.theme;return{display:"flex",position:"relative",alignItems:"center",flexDirection:"column",opacity:t?.75:1,backgroundColor:t?n.colors.grey[2]:void 0}})),Qn=function(e){var t=e.isLocked,a=e.allocation,o=e.style,r=e.height,i=m.useTheme(),l=G().onChangeExternalResourceName,s=O.getIsExternal(a.person),c=function(e){a.person.id===ze&&a.assignments.length>0&&"undefined"!==typeof l&&l(a.assignments[0].id,e)};return D.createElement(Vn,{theme:i,height:r,styles:o},D.createElement(n.Box,{display:"flex",justifyContent:"flex-start",flexGrow:1},D.createElement(Ue,{onChangeExternalUserName:c,user:a.person})),D.createElement(Gn,{isLocked:t,theme:i,width:"fit-content",display:"flex",justifyContent:"flex-start"},!s&&D.createElement(h.NextAvailability,{textSize:"tiny",width:"170px",justifyContent:"flex-start",date:(null===a||void 0===a?void 0:a.assignmentEnd)?p.localeMoment(a.assignmentEnd).toISOString():p.localeMoment().subtract(1,"day").toISOString()})))},Zn=f(n.Box)((function(e){return{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",paddingLeft:"20px",height:"51px",background:e.theme.colors.grey[2],borderTop:" 2px solid black"}})),Jn=f(n.Box)((function(){return{display:"flex",flexDirection:"column",width:"75%",marginRight:"5%"}})),Xn=f(n.Box)((function(e){return S({position:"relative",right:"5px",padding:"3px 6px",borderRadius:"20px",transition:"0.3s",cursor:"pointer"},e.style)})),$n=f(b.Link)((function(e){return{color:"#142C3B",textDecoration:"none",fontSize:e.theme.fontSizes.small,fontWeight:"bold",overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"}})),ea=function(e){var a,o=e.project,r=e.isAllocationLoading,i=e.minAssignees,l=e.maxHeadCount,s=e.total,c=e.externalTotal,d=e.isPercentage,u=e.style,p=m.useTheme(),f=$t(),g=f.get(o.id).isCollapsed,h=t.useRef(null),v=oe().getLinkToProject,b=function(){f.setIsCollapsed({value:!g,key:o.id})};return t.useEffect((function(){(null===h||void 0===h?void 0:h.current)&&(f.setRefFn(h),f.setSidebarRightLimitFn(h.current.getBoundingClientRect().right))}),[null===(a=null===h||void 0===h?void 0:h.current)||void 0===a?void 0:a.getBoundingClientRect().right]),D.createElement(Zn,{ref:h,theme:p,style:u},D.createElement(n.Box,{display:"flex",width:"100%","flex-direction":"row",justifyContent:"space-between",alignItems:"center"},D.createElement(Jn,{maxWidth:"200px"},v?D.createElement($n,{to:v(o.id),target:"_blank",theme:p},o.name," ",o.place&&"("+o.place+")"):D.createElement(n.Text,{fontSize:"small",fontWeight:"bold",ellipsis:!0},o.name," ",o.place&&"("+o.place+")"),D.createElement(n.Box,{display:"flex",mt:0,alignItems:"center"},D.createElement(n.Icon,{size:10,mr:0,color:p.colors.grey[6],as:it}),D.createElement(n.Text,{fontSize:"small",color:p.colors.grey[6]},o.customer))),D.createElement(n.Box,{display:"flex",width:"60px","flex-direction":"row",alignItems:"center"},r?D.createElement(n.LoaderSkeleton.Point,null):D.createElement(nt,{isPercentage:d,value:{min:i,max:l,rate:s,external:c},isShowAssignationStats:!0}))),D.createElement(Xn,{onClick:b},D.createElement(We,{isCollapsed:g})))},ta=function(){var e=G(),t=e.onEditNeed,n=void 0===t?function(){}:t,a=e.onReOrderNeed,o=void 0===a?function(){}:a;return{onClickNeed:function(e){n(e)},onClickArrow:function(e,t){o(e,t)}}},na=f(n.Box)((function(e){var t=e.theme,n=e.isFirstNeed,a=e.isLocked,o=e.style;return S({height:"50px",width:"100%",borderBottom:"0.5px solid "+t.colors.grey[2],display:"flex",alignItems:"center",paddingLeft:"20px",flexDirection:"row",justifyContent:"space-between",borderTop:n?"2px solid black":"0.5px solid black",opacity:a?"0.75":"none",background:a?t.colors.grey[2]:t.colors.grey[1]},o)})),aa=f(n.Box)((function(){return{width:"100%",display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",transition:"0.5s"}})),oa=f(n.Box)((function(e){return{display:"flex",flexDirection:"row",position:"relative",width:e.isFirstOrLastNeed?"15px":"30px",alignItems:"center",justifyContent:"center",top:"1px"}})),ra=f(n.Box)((function(){return{cursor:"pointer",transition:"0.4s",padding:"2px"}})),ia=f(Ve)((function(e){return{display:"flex",width:"15px",height:"15px",transform:e.isArrowUp?"rotate(-90deg)":"rotate(90deg)",":hover":{background:e.theme.colors.grey[2]}}})),la=f(n.Box)((function(){return{position:"relative",right:"5px",padding:"3px 6px",borderRadius:"20px",transition:"0.3s",cursor:"pointer"}})),sa=f(n.Text)((function(){return{cursor:"pointer",transition:"0.5s",paddingLeft:"0px",":hover":{background:"none",textDecoration:"underline"}}})),ca=function(e){var t=e.need,a=e.isAllocationLoading,o=e.isLocked,r=e.isFirstNeed,i=e.isLastNeed,l=e.style,s=e.isPercentage,c=en(),d=m.useTheme(),u=c.get(t.projectNeed.id).isCollapsed,p=ta(),f=p.onClickNeed,g=p.onClickArrow,h=function(){c.setIsCollapsed({value:!u,key:t.projectNeed.id})},v=A(D.useState(!1),2),b=v[0],x=v[1];return D.createElement(na,{theme:d,isLocked:o,style:l,isFirstNeed:r},D.createElement(aa,{onMouseEnter:function(){x(!0)},onMouseLeave:function(){x(!1)}},D.createElement(n.Box,{display:"flex",flexDirection:"row",alignItems:"center",width:"50%"},b&&D.createElement(oa,{isFirstOrLastNeed:r||i,mr:1},!r&&D.createElement(ra,{onClick:function(){g(t.projectNeed.id,"top")},theme:d},D.createElement(ia,{theme:d,isArrowUp:!0})),!i&&D.createElement(ra,{onClick:function(){g(t.projectNeed.id,"bottom")},theme:d},D.createElement(ia,{theme:d}))),D.createElement(n.Box,{maxWidth:"200px",display:"flex"},D.createElement(sa,{fontSize:"small",fontWeight:"semiBold",ellipsis:!0,onClick:function(){f(t.projectNeed.id)}},t.projectNeed.name))),D.createElement(n.Box,{display:"flex",width:"60px","flex-direction":"row",alignItems:"center"},!0===a?D.createElement(n.LoaderSkeleton.Point,null):D.createElement(nt,{isPercentage:s,value:{min:t.minAssignees,max:t.maxHeadCount,rate:t.allocationsNeed,external:t.externalTotal},isShowAssignationStats:!0}))),D.createElement(la,{onClick:h},D.createElement(We,{isCollapsed:u})))},da=function(){var e=G(),t=e.onAddNeed,n=void 0===t?function(){}:t,a=e.onAssignResource,o=void 0===a?function(){}:a,r=en(),i=$t();return{onClickAssignResource:function(e){o(e);var t=r.get(e).isCollapsed;r.setIsCollapsed({value:t,key:e})},onClickNewNeed:function(e){n(e);var t=i.get(e).isCollapsed;i.setIsCollapsed({value:t,key:e})}}},ua=function(e,a){var o=e.projects,r=n.useTranslate(),i=en(),l=$t(),s=da(),c=s.onClickAssignResource,d=s.onClickNewNeed,u=H().multipleDateRangeOverlaps;return t.useMemo((function(){return T([],A(o.reduce((function(e,t){var n,o=l.get(t.project.id).isCollapsed,s=t.needs;return T(T(T(T([],A(e)),[{component:ea,props:{project:t.project,isAllocationLoading:!0===t.allocationRatesLoading,total:t.total,externalTotal:t.externalTotal,minAssignees:t.minAssignees,maxHeadCount:t.maxHeadCount,isPercentage:a}}]),A(o?[]:s.reduce((function(e,n,o){var l,s=i.get(n.projectNeed.id).isCollapsed;return T(T(T(T([],A(e)),[{component:ca,props:{isAllocationLoading:!0===t.allocationRatesLoading,isLocked:n.isLocked,isLastNeed:o+1===(null===(l=t.needs)||void 0===l?void 0:l.length),isFirstNeed:0===o,need:n,isPercentage:a}}]),A(s?[]:n.allocations.map((function(e){var t=u(e.assignments).height;return{component:Qn,props:{isLocked:n.isLocked,allocation:e,height:t},height:t}})))),A(s?[]:[{component:Yn,props:{isLocked:n.isLocked,onClick:function(){c(n.projectNeed.id)},name:r("assign_resource")}}]))}),[]))),A(o?[]:[{component:Yn,props:{onClick:function(){d(t.project.id)},name:r("add_a_something",{object:r("a_staffing_project_need")}),isProjectNeed:!0,isLocked:!(null===(n=t.project.capabilities)||void 0===n?void 0:n.canCreateNeed)}}]))}),[])))}),[l,i,d,c,u,o])},pa=f(n.Text)((function(){return{textTransform:"lowercase"}})),ma=function(e){var t=e.isPercentage,a=n.useTranslate(),o=tn().data,r=Bn(o,t),i=ua(o,t);return D.createElement(re,{periodType:o.periodType,startDate:o.startDate,endDate:o.endDate,getLinkToUserProfile:o.getLinkToUserProfile,getLinkToProject:o.getLinkToProject,fixedHeaderChildren:D.createElement(Ye,{columns:[D.createElement(n.Column,{alignItems:"flex-start"},D.createElement(Xe,{useSort:tn,sortKey:"projects"},a("staffing_project",10)),D.createElement(pa,{fontWeight:"semiBold",height:"25px",mb:1,ml:0},a("num_staffing_project",o.totals.nbProjects)+", "+a("staffing_project_need_num",o.totals.nbNeeds))),D.createElement(n.Column,null,D.createElement(Xe,{useSort:tn,isSortDisabled:!0,sortKey:"projects-allocation-rate"},a("allocationRatesView")),D.createElement(n.Box,{height:"25px",mb:1}))]}),sideBarChildren:i,contentChildren:r,type:"planning"})},fa=function(e){var t=e.data,n=e.callbacks,a=e.isPercentage;return D.createElement(Xt,{data:t,callbacks:n},D.createElement(ma,{isPercentage:a}))},ga=xt(),ha=Dt(),va=function(e){var t=e.sortKeys,n=e.data;return t.resources&&(n.persons=x.orderBy(n.persons,(function(e){return e.person.familyName+" "+e.person.givenName}),t.resources)),t["assignment-end"]&&(n.persons=x.orderBy(n.persons,(function(e){return e.assignmentEnd}),t["assignment-end"])),n},ba=function(e){var t=e.children,n=e.data,a=e.callbacks;return D.createElement(Q,{callbacks:a},D.createElement(_t,{onSort:va,context:ha,data:n},D.createElement(ha.Consumer,null,(function(e){var n=e.data;return D.createElement(Ot,{context:ga,data:(null===n||void 0===n?void 0:n.persons)?n.persons:[],fieldKey:"person.id"},t)}))))};function xa(){return t.useContext(ha)}function ja(){return t.useContext(ga)}var ya=f(n.Box)((function(e){var t=e.theme,n=e.isFirstChild,a=e.styles;return S({height:"50px",width:"100%",borderTop:n?"2px solid black":void 0,borderBottom:"0.5px solid "+t.colors.grey[1],display:"flex",alignItems:"center",paddingLeft:"20px",flexDirection:"row",justifyContent:"space-between"},a)})),Oa=f(n.Box)((function(e){return{display:"flex",position:"relative",alignItems:"center",right:e.isAvailableNow?79:20,flexDirection:"column"}})),Da=function(e){var a,o=e.data,r=e.style,i=(e.height,e.isFirstChild),l=e.isLastChild,s=m.useTheme(),c=p.localeMoment(null===o||void 0===o?void 0:o.assignmentEnd).diff(p.localeMoment(),"day")<1,d=t.useRef(null),u=ja(),f=u.setRefFn,g=u.setSidebarRightLimitFn,v=O.getIsExternal(o.person);return t.useEffect((function(){(null===d||void 0===d?void 0:d.current)&&(f(d),g(d.current.getBoundingClientRect().right))}),[null===(a=null===d||void 0===d?void 0:d.current)||void 0===a?void 0:a.getBoundingClientRect().right]),"undefined"===typeof(null===o||void 0===o?void 0:o.person)?D.createElement(n.Line,{width:"100%"},D.createElement(n.LoaderSkeleton.Line,{width:"40%"})):D.createElement(ya,{styles:r,ref:d,isFirstChild:i,isLastChild:l,theme:s},D.createElement(n.Box,{maxWidth:"40%"},D.createElement(Ue,{user:o.person})),D.createElement(Oa,{maxWidth:"45%",isAvailableNow:c},!v&&D.createElement(h.NextAvailability,{textSize:"tiny",date:(null===o||void 0===o?void 0:o.assignmentEnd)?p.localeMoment(o.assignmentEnd).toISOString():p.localeMoment().subtract(1,"day").toISOString()})))},_a=function(e){var n=e.persons,a=H().multipleDateRangeOverlaps;return t.useMemo((function(){return T([],A(n.reduce((function(e,t,o){var r=a(t.allocations).height;return T(T([],A(e)),[{component:Da,props:{data:t,key:t.person.id,height:r,isFirstChild:0===o,isLastChild:o===n.length-1},height:r}])}),[])))}),[n,a])},Pa=f(n.Box)((function(e){var t=e.conmputedWidth,n=e.isFirstChild;return e.isLastChild,{position:"relative",width:t,borderTop:n?"2px solid black":void 0}})),Ca=function(e){var t=e.lines,a=e.endDate,o=e.style,r=e.isFirstChild,i=e.isLastChild,l=e.isLocked,s=e.person,c=e.data,d=e.startDate,u=e.periodType,p=e.height,m=oe().contentSquares,f=ja().sidebarRightLimit;return D.createElement(Pa,{conmputedWidth:50.5*(m.length+1),isFirstChild:r,isLastChild:i,style:S({},o)},c.map((function(e,n){return D.createElement(Mn,{contentLines:t,sidebarRightLimit:f,startDate:d,endDate:a,periodType:u,isLocked:l,index:n,key:n,assignment:e,assignments:c})})),D.createElement(n.Box,{display:"flex",flexDirection:"row"},D.createElement(Re,{id:s.id,isPercentage:!1,isLocked:l,isAssignmentSquare:!0,assignments:c,assignType:"assignment",values:m,byPeriod:[],squareStyle:{height:p,justifyContent:"flex-start"}})))},wa=function(e){var n=e.persons,a=e.startDate,o=e.endDate,r=e.periodType,i=H().multipleDateRangeOverlaps;return t.useMemo((function(){return T([],A(n.reduce((function(e,t,n){var l=i(t.allocations),s=l.height,c=l.lines;return T(T([],A(e)),[{component:Ca,props:{lines:c,key:n,person:t.person,data:t.allocations,startDate:a,endDate:o,periodType:r,height:s,isFirstChild:0===n,isLastChild:n===t.allocations.length-1,isLocked:t.isLocked},height:s}])}),[])))}),[n,o,i,r,a])},Sa=f(n.Text)((function(){return{textTransform:"lowercase"}})),Ea=function(e){var t=e.loadMoreRows,a=e.onRessourcePlanningSort,o=e.familyNameSortDirection,r=e.nextAvailabilitySortDirection,i=n.useTranslate(),l=xa().data,s=wa(l),c=_a({persons:l.persons}),d=D.createElement(Ye,{columns:[D.createElement(n.Column,{alignItems:"left"},D.createElement(Xe,{useSort:xa,initialSortValue:o,onRessourcePlanningSort:a,sortKey:"familyName"},D.createElement(n.Text,{fontWeight:"bold",fontSize:11},i("resources"))),D.createElement(Sa,{fontWeight:"semiBold",height:"25px",mb:1,ml:0},i("num_resources",l.totals.nbPersons))),D.createElement(n.Column,null,D.createElement(Xe,{useSort:xa,initialSortValue:r,onRessourcePlanningSort:a,sortKey:"nextAvailability"},D.createElement(n.Text,{fontWeight:"bold",fontSize:11},i("assignment_end"))),D.createElement(n.Box,{height:"25px",mb:1}))]});return D.createElement(re,{periodType:l.periodType,startDate:l.startDate,endDate:l.endDate,loadMoreRows:t,fixedHeaderChildren:d,getLinkToUserProfile:l.getLinkToUserProfile,contentChildren:s,sideBarChildren:c,type:"planning"})},Aa=function(e){var t=e.data,n=e.callbacks,a=e.loadMoreRows,o=e.onRessourcePlanningSort,r=e.familyNameSortDirection,i=e.nextAvailabilitySortDirection;return D.createElement(ba,{data:t,callbacks:n},D.createElement(Ea,{loadMoreRows:a,onRessourcePlanningSort:o,familyNameSortDirection:r,nextAvailabilitySortDirection:i}))},Ta=function(e){var t=e.className,n=de("cc-icon",t);return D.createElement("svg",S({className:n},e,{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"}),D.createElement("path",{d:"M2.00007 0C0.892078 0 0 0.891648 0 1.99963C0 3.10763 0.892078 3.99971 2.00007 3.99971H21.9999C23.1079 3.99971 24 3.10763 24 1.99963C24 0.891648 23.1079 0 21.9999 0H2.00007ZM2.00007 9.99992C0.892078 9.99992 0 10.8916 0 11.9996C0 13.1076 0.892078 13.9996 2.00007 13.9996H14.0001C15.1081 13.9996 15.9997 13.1076 15.9997 11.9996C15.9997 10.8916 15.1081 9.99992 14.0001 9.99992H2.00007ZM2.00007 19.9994C0.892078 19.9994 0 20.8915 0 21.9995C0 23.1075 0.892078 23.9996 2.00007 23.9996H5.99979C7.10778 23.9996 7.99986 23.1075 7.99986 21.9995C7.99986 20.8915 7.10778 19.9994 5.99979 19.9994H2.00007Z",fill:"#030E2D"}))},Na={callbacks:{onChangePeriod:function(){},onChangeView:function(){},onChangeDisplayMode:function(){},onChangeFilters:function(){},onExport:function(){}}},ka=t.createContext(Na),Ia=function(e){var t=e.children,n=e.callbacks;return D.createElement(ka.Provider,{value:{callbacks:n}},t)},Ma=function(){var e=t.useContext(ka).callbacks,n=e.onChangeFilters,a=e.onExport;return{onClickExport:function(){a()},onClickFilter:function(){n()}}},Ra=function(){var e=Ma().onClickFilter;return D.createElement("div",{className:"cc-top-header-actions"},D.createElement("div",{className:"cc-top-header-actions-filter"},D.createElement(Ta,null),D.createElement("div",{onClick:e,className:"cc-top-header-actions-filter-txt"},"FILTER")))},Fa=function(a){var o=a.startDate,r=a.endDate,i=a.periodType,l=n.useTranslate(),s=t.useContext(ka).callbacks.onChangePeriod;return D.createElement(n.Line,{ml:3},D.createElement(n.Label,{content:l("startDate")},D.createElement(n.DatePicker,{width:150,onChange:function(e){s(e.toDate(),r,i)},value:o.toISOString()})),D.createElement(n.Label,{content:l("endDate"),ml:1},D.createElement(n.DatePicker,{width:150,onChange:function(e){s(o,e.toDate(),i)},value:r.toISOString()})),D.createElement(n.Label,{content:l("periodType"),ml:3},D.createElement(n.SelectField,{value:i,onChange:function(e){return s(o,r,e)},width:100,source:[{label:l(e.PeriodType.DAY),value:e.PeriodType.DAY},{label:l(e.PeriodType.WEEK),value:e.PeriodType.WEEK},{label:l(e.PeriodType.MONTH),value:e.PeriodType.MONTH}]})))},La=[{label:"planningView",value:"planning"},{label:"allocationRatesView",value:"allocationRate"}],Ba=function(e){var t=e.value,a=void 0===t?La[0]:t,o=e.onChange,r=n.useTranslate();return D.createElement(n.Label,{content:r("viewType")},D.createElement(n.SelectField,{value:a,onChange:o,width:150,source:La.map((function(e){var t=e.label,n=e.value;return{label:r(t),value:n}}))}))},Ha=function(e){var t=e.callbacks,a=e.view,o=e.periodType,r=e.startDate,i=e.endDate;return D.createElement(Ia,{callbacks:t},D.createElement("div",{className:"cc-top-header-container"},D.createElement(n.Line,null,D.createElement(Ba,{value:a,onChange:t.onChangeView}),D.createElement(Fa,{periodType:o,startDate:r,endDate:i})),D.createElement(Ra,null)))};Object.defineProperty(e,"ProjectStatus",{enumerable:!0,get:function(){return u.ProjectStatus}}),e.AllocationProjects=Mt,e.AllocationResources=qt,e.PlanningProjects=fa,e.PlanningResources=Aa,e.TopHeader=Ha,e.generatePlanningHeaders=$,e.useCommon=H,Object.defineProperty(e,"__esModule",{value:!0})}(t,n(0),n(14),n(225),n(32),n(37),n(88),n(1144),n(421),n(63),n(773),n(140),n(1134),n(23),n(1135),n(425))},821:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var a,o,r=n(0),i=["title","titleId"];function l(){return(l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function s(e,t){if(null==e)return{};var n,a,o=function(e,t){if(null==e)return{};var n,a,o={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function c(e,t){var n=e.title,c=e.titleId,d=s(e,i);return r.createElement("svg",l({viewBox:"0 0 16 16",xmlns:"http://www.w3.org/2000/svg",ref:t,"aria-labelledby":c},d),n?r.createElement("title",{id:c},n):null,a||(a=r.createElement("path",{d:"M9.87792 6.37764H8.11267V4.61239C8.11267 4.13163 7.72957 3.74854 7.24882 3.74854C6.76807 3.74854 6.38497 4.13163 6.38497 4.61239V6.37764H4.61971C4.13896 6.37764 3.75586 6.76074 3.75586 7.24149C3.75586 7.72224 4.13896 8.10534 4.61971 8.10534H6.38497V9.8706C6.38497 10.3438 6.76807 10.7345 7.24882 10.7345C7.72957 10.7345 8.11267 10.3438 8.11267 9.8706V8.10534H9.87792C10.3512 8.10534 10.7418 7.72224 10.7418 7.24149C10.7418 6.76074 10.3512 6.37764 9.87792 6.37764Z"})),o||(o=r.createElement("path",{d:"M15.7446 14.5202L12.9427 11.7183C13.9493 10.4413 14.4977 8.88638 14.4977 7.24883C14.4977 5.34836 13.7239 3.48545 12.3643 2.13333C10.9897 0.758685 9.17183 0 7.24883 0C5.32582 0 3.48545 0.766197 2.13333 2.12582C0.758685 3.50047 0 5.31831 0 7.24131C0 9.16432 0.773709 11.0047 2.13333 12.3568C3.50798 13.7315 5.32582 14.4901 7.24883 14.4901C8.85634 14.4901 10.4488 13.9268 11.7183 12.9352L14.5277 15.7446C14.693 15.9099 14.9183 16 15.1362 16C15.354 16 15.5793 15.9174 15.7446 15.7446C16.0826 15.4066 16.0826 14.8582 15.7446 14.5202ZM11.1399 11.1399C10.1108 12.1765 8.69108 12.7624 7.24131 12.7624C5.79155 12.7624 4.40939 12.1991 3.34272 11.1399C2.31361 10.1108 1.72019 8.69108 1.72019 7.24131C1.72019 5.79155 2.28357 4.40939 3.34272 3.34272C4.37183 2.31361 5.79155 1.72019 7.24131 1.72019C8.69108 1.72019 10.0732 2.28357 11.1399 3.34272C12.1765 4.37934 12.7624 5.79906 12.7624 7.24131C12.7624 8.68357 12.1991 10.0732 11.1399 11.1399Z"})))}var d=r.forwardRef(c);n.p},871:function(e,t,n){"use strict";n.d(t,"c",(function(){return u})),n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return m}));var a=n(17),o=n(19),r=n(818),i=n(23),l=new Map([[r.PeriodType.DAY,o.AllocationRateAccuracy.Day],[r.PeriodType.WEEK,o.AllocationRateAccuracy.Week],[r.PeriodType.MONTH,o.AllocationRateAccuracy.Month]]),s=new Map([[o.ScheduledPeriodType.Project,r.AllocationType.WORK],[o.ScheduledPeriodType.Training,r.AllocationType.TRAINING],[o.ScheduledPeriodType.Absence,r.AllocationType.ABSENT]]),c=new Map([[o.ProjectAssignmentStatus.Confirmed,r.AllocationStatus.APPROVED],[o.ProjectAssignmentStatus.Planned,r.AllocationStatus.PROVISION],[o.ProjectAssignmentStatus.Provisional,r.AllocationStatus.PROVISION],[o.ProjectAssignmentStatus.Simulated,r.AllocationStatus.SIMULATION]]),d=new Map([[o.ProjectStatus.Past,r.ProjectStatus.PAST],[o.ProjectStatus.Ongoing,r.ProjectStatus.ONGOING],[o.ProjectStatus.Upcoming,r.ProjectStatus.UPCOMING]]);function u(e){return l.get(e)||o.AllocationRateAccuracy.Day}function p(e,t,n){var r=(t||[]).reduce((function(e,t){return e.nbPersons=n||0,e.allocationRate=e.allocationRate+t.allocationRates.total,t.allocationRates.byPeriod.forEach((function(t,n){var a;e.byPeriod.length>n?null!=t&&(e.byPeriod[n]={rate:((null===(a=e.byPeriod[n])||void 0===a?void 0:a.rate)||0)+t.rate}):e.byPeriod.push(t||null)})),e}),{nbPersons:0,allocationRate:0,byPeriod:[]});return r.allocationRate=r.allocationRate/(r.nbPersons||1),r.byPeriod=r.byPeriod.map((function(e){return e?{rate:e.rate/(r.nbPersons||1)}:e})),Object(a.a)(Object(a.a)({},e),{},{totals:r,allocations:(t||[]).map((function(e){return{person:Object(a.a)(Object(a.a)({},Object(o.getFormatedUserBasicFragment)(e)),{},{place:e.place,title:e.title,groups:e.groups}),total:e.allocationRates.total,byPeriod:e.allocationRates.byPeriod.map((function(e){return null!==e?{rate:(null===e||void 0===e?void 0:e.rate)||0}:null}))}}))})}function m(e,t,n,l){var u=new Map;return{data:Object(a.a)(Object(a.a)({},e),{},{totals:{nbPersons:t},persons:(n||[]).map((function(e){return{person:Object(a.a)(Object(a.a)({},Object(o.getFormatedUserBasicFragment)(e)),{},{place:e.place,title:e.title,groups:e.groups}),isLocked:l===e.id,assignmentEnd:e.nextAvailability,allocations:(e.scheduledPeriods.nodes||[]).map((function(t){var n,a;u.set(t.id,e.id);var i,l,p,m=(i=t.type,s.get(i)||r.AllocationType.VACANCY),f=t.projectAssignment?{id:t.projectAssignment.project.id,name:t.projectAssignment.project.name,colorHex:Object(o.maybeToOptional)(t.projectAssignment.project.color)||"success.3",status:(l=t.projectAssignment.project.status||o.ProjectStatus.Ongoing,d.get(l)||r.ProjectStatus.ONGOING),customer:""}:void 0;return{id:t.id,userId:e.id,project:f,startDate:new Date(t.startDate),endDate:new Date(t.endDate),type:m,status:(p=Object(o.maybeToOptional)(null===(n=t.projectAssignment)||void 0===n?void 0:n.status)||o.ProjectAssignmentStatus.Confirmed,c.get(p)||r.AllocationStatus.APPROVED),rate:t.rate,projectAndNeedName:Object(o.maybeToOptional)(t.name),assignmentId:m===r.AllocationType.WORK?null===(a=t.projectAssignment)||void 0===a?void 0:a.id:void 0}})).sort((function(e,t){return Object(i.sortByName)(e,t,(function(e){return(e.projectAndNeedName||"").toLowerCase()}))}))}}))}),allocationToUserMap:u}}},995:function(e,t,n){},996:function(e,t,n){"use strict";var a=n(139),o=n.n(a),r=n(187),i=n(17),l=n(286),s=n(53),c=n(285),d=n(0),u=n(14),p=n(37),m=n(10),f=n(1016),g=n(1e3),h=n(766),v=n(1),b=["isOpened","onClose","initialProjectId","minStartDate","maxEndDate","isProjectNameReadOnly","onSubmit"],x=function(e){return"undefined"!==typeof e?Object(p.localeMoment)(e).toISOString():void 0},j=function(e){var t,n=e.initialProjectId,a=e.minStartDate,o=e.maxEndDate;return{name:"",projectId:n,customFields:{},scheduledPeriods:[(t={startDate:x(a),endDate:x(o)},{rate:100,headCount:1,manDays:void 0,startDate:t.startDate,endDate:t.endDate})],description:"",isDateError:!1}};t.a=function(e){var t=e.isOpened,n=e.onClose,a=e.initialProjectId,p=void 0===a?null:a,x=e.minStartDate,y=e.maxEndDate,O=e.isProjectNameReadOnly,D=void 0===O||O,_=e.onSubmit,P=Object(c.a)(e,b),C=Object(d.useState)(j({initialProjectId:p,minStartDate:x,maxEndDate:y})),w=Object(s.a)(C,2),S=w[0],E=w[1],A=Object(d.useState)(!1),T=Object(s.a)(A,2),N=T[0],k=T[1],I=Object(u.useTranslate)({capitalize:!0}),M=Object(m.useAppContext)().customFields,R=Object(d.useMemo)((function(){return S.isDateError||0===S.name.trim().length||S.scheduledPeriods.some((function(e){return"undefined"===typeof e.startDate||"undefined"===typeof e.endDate}))}),[S,y]),F=function(e){return function(){var t=Object(l.a)(o.a.mark((function t(n){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:E(Object(i.a)(Object(i.a)({},S),{},Object(r.a)({},e,n)));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},L=function(){E(j({initialProjectId:p,minStartDate:x,maxEndDate:y}))},B=function(){var e=Object(l.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==S.projectId){e.next=2;break}return e.abrupt("return");case 2:return k(!0),e.next=5,_({name:S.name,projectId:S.projectId,description:S.description,customFields:S.customFields,scheduledPeriods:S.scheduledPeriods.map((function(e){return{startDate:e.startDate,endDate:e.endDate,headCount:e.headCount,rate:e.rate}}))}).catch((function(e){return console.error("Error creating project need",e)})).finally((function(){k(!1)}));case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(v.jsxs)(m.FormContainerModal,Object(i.a)(Object(i.a)({isOpened:t,onClose:n,title:I("new_staffing_project_need"),onConfirm:B,onCancel:n,isLoading:N,isDisabledSubmit:R,onClosingComplete:function(){L()},maxHeight:"95vh"},P),{},{children:[Object(v.jsxs)(m.ContainerWithBottomSeparator,{children:[Object(v.jsx)(u.Label,{content:I("staffing_project_need_name"),mb:1,required:!0,children:Object(v.jsx)(u.Input,{width:"100%",value:null===S||void 0===S?void 0:S.name,onChange:F("name"),mb:1})}),Object(v.jsx)(u.Label,{content:I("description"),mb:1,height:"auto",children:Object(v.jsx)(u.TextArea,{value:S.description||"",placeholder:"-",onChange:F("description")})}),Object(v.jsx)(u.Label,{content:I("staffing_project",1),mb:2,children:Object(v.jsx)(f.a,{value:S.projectId,submit:F("projectId"),width:"100%",readOnly:D})}),M.projectNeedFields.length>0&&Object(v.jsx)(h.a,{customFieldsConfiguration:M.projectNeedFields,value:S.customFields,onChange:F("customFields"),mb:1,width:"100%"})]}),Object(v.jsx)(m.FormSectionContainer,{title:I("scheduled_periods_and_number_of_resources"),children:Object(v.jsx)(g.f,{minStartDate:x,maxEndDate:y,initialScheduledPeriods:S.scheduledPeriods,onSubmit:function(e){var t=e.scheduledPeriods;E(Object(i.a)(Object(i.a)({},S),{},{isDateError:!1,scheduledPeriods:t}))},onError:function(){E(Object(i.a)(Object(i.a)({},S),{},{isDateError:!0}))}},S.scheduledPeriods.map((function(e){return"".concat(e.endDate,"_").concat(e.startDate,"_").concat(e.headCount,"_").concat(e.manDays,"_").concat(e.rate)})).join("."))})]}))}}}]);