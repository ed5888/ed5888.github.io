(this["webpackJsonp@elamp/main-app"]=this["webpackJsonp@elamp/main-app"]||[]).push([[71],{1583:function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return I}));var i=r(139),n=r.n(i),c=r(286),o=r(53),s=r(285),a=r(223),u=r(17),d=r(0),l=r(15),p=r(14),y=r(37),f=r(63),b=r(19),j=r(10),O=r(3),v=r(742),h=r(1),x=["currentPrivacyPolicyVersion","currentTosVersion","isLatestTosAccepted","isLatestPrivacyPolicyAccepted","privacyPolicyURL","tosURL"],V=function(e,t){switch(t.type){case"setTextFromURL":return Object(u.a)(Object(u.a)({},e),{},{textFromURL:t.text});case"setCurrentView":return Object(u.a)(Object(u.a)({},e),{},{currentView:t.currentView});case"setTosValidatedVersion":return Object(u.a)(Object(u.a)({},e),{},{tosValidatedVersion:t.version});case"setPrivacyPolicyVersion":return Object(u.a)(Object(u.a)({},e),{},{privacyPolicyVersion:t.version});case"setIsSigned":return Object(u.a)(Object(u.a)({},e),{},{isSigned:!0});case"reset":default:return e}},P={textFromURL:void 0,currentView:void 0,tosValidatedVersion:void 0,privacyPolicyVersion:void 0,isSigned:!1},w=Object(f.getAppConfiguration)(),_=function(e){var t,r=(new DOMParser).parseFromString(e,"text/html"),i=r.querySelectorAll("script"),n=Object(a.a)(i);try{for(n.s();!(t=n.n()).done;){t.value.remove()}}catch(c){n.e(c)}finally{n.f()}return r.body.innerHTML},g=function(e){return Object(y.localeMoment)(e,"YYYYMMDD").format("LL")},I=function(e){var t,r=e.currentPrivacyPolicyVersion,i=e.currentTosVersion,a=e.isLatestTosAccepted,y=e.isLatestPrivacyPolicyAccepted,f=e.privacyPolicyURL,I=e.tosURL,L=Object(s.a)(e,x),A=Object(p.useTranslate)({capitalize:!0}),R=Object(p.useAlert)(),m=Object(l.useParams)(),T=m.userId,C=m.view,S=Object(l.useHistory)(),D=Object(d.useReducer)(V,P),E=Object(o.a)(D,2),U=E[0],Y=U.textFromURL,N=U.currentView,B=U.tosValidatedVersion,F=U.privacyPolicyVersion,G=U.isSigned,M=E[1],k=Object(b.useUpdateTosOrPrivacyPolicyMutation)(),H=Object(o.a)(k,2),z=H[0],W=H[1].loading,J=function(){var e=Object(c.a)(n.a.mark((function e(t){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t).then((function(e){if(e.ok)return e.text()})).then((function(e){if("string"===typeof e){var t=_(e);"string"===typeof t&&M({type:"setTextFromURL",text:t})}})).catch((function(e){console.error("Failed to fetch url",e)}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();Object(d.useEffect)((function(){C&&M({type:"setCurrentView",currentView:C})}),[C]),Object(d.useEffect)((function(){a&&"undefined"===typeof B&&M({type:"setTosValidatedVersion",version:i}),y&&"undefined"===typeof F&&M({type:"setPrivacyPolicyVersion",version:r}),B===i&&F!==r?S.push(O.b.TOS_AND_PRIVACY_POLICY_DOCS_LANDING_PAGE.getRoute({userId:T,view:"privacy-policy"})):B!==i&&F===r?S.push(O.b.TOS_AND_PRIVACY_POLICY_DOCS_LANDING_PAGE.getRoute({userId:T,view:"tos"})):B===i&&F===r&&G&&(S.push(O.b.USER_PROFILE.getRoute({userId:T})),window.location.reload())}),[B,F]),Object(d.useEffect)((function(){return""!==I&&""!==f&&"undefined"===typeof N&&(a&&"undefined"===typeof B&&M({type:"setTosValidatedVersion",version:i}),y&&"undefined"===typeof F&&M({type:"setPrivacyPolicyVersion",version:r}),a?y||(S.push(O.b.TOS_AND_PRIVACY_POLICY_DOCS_LANDING_PAGE.getRoute({userId:T,view:"privacy-policy"})),M({type:"setCurrentView",currentView:"privacy-policy"})):(S.push(O.b.TOS_AND_PRIVACY_POLICY_DOCS_LANDING_PAGE.getRoute({userId:T,view:"tos"})),M({type:"setCurrentView",currentView:"tos"}))),function(){return M({type:"setCurrentView",currentView:void 0})}}),[y,a,f,I]),Object(d.useEffect)((function(){return""!==I&&""!==f&&("tos"===N?J(I):"privacy-policy"===N&&J(f)),function(){return M({type:"setTextFromURL",text:void 0})}}),[N]);var q=function(){var e=Object(c.a)(n.a.mark((function e(){var t;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={id:T,tosValidatedVersion:i},"privacy-policy"===N&&(t={id:T,privacyPolicyVersion:r}),e.next=4,z({variables:Object(u.a)({},t)}).then((function(){M({type:"tos"===N?"setTosValidatedVersion":"setPrivacyPolicyVersion",version:"tos"===N?i:r})})).catch((function(e){return R.error(Object(b.getErrorMessage)(e))}));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),K=Object(d.useMemo)((function(){return"tos"===N?A("accept_tos_label"):"privacy-policy"===N?A("accept_privacy_policy_label"):void 0}),[N]);return Object(h.jsxs)(v.a,Object(u.a)(Object(u.a)({display:"flex",bg:"white"},L),{},{children:[Object(h.jsx)(p.Column,{height:"100%",width:j.SIDEBAR_WIDTH,display:"flex",alignItems:"flex-start",children:Object(h.jsx)(p.Box,{px:3,py:1,width:j.SIDEBAR_WIDTH,height:j.TOPBAR_HEIGHT,display:"flex",alignItems:"center",justifyContent:"center",children:Object(h.jsx)(j.SideBarAppLogo,{src:null===w||void 0===w||null===(t=w.style)||void 0===t?void 0:t.logo})})}),Object(h.jsxs)(p.Column,{width:"100%",height:"100%",children:[Object(h.jsxs)(p.Box,{width:"100%",flexGrow:1,overflowY:"auto",px:4,pt:4,children:[Object(h.jsxs)(p.Box,{width:"100%",justifyContent:"flex-start",pb:15,children:[Object(h.jsx)(p.Text,{fontWeight:"bold",fontSize:"huge",mb:1,children:A("tos"===N?"tos_title":"privacy_policy")}),Object(h.jsxs)(p.Text,{children:[A("two_points",{phrase:A("version")})," ",g("tos"===N?i:r)]})]}),Object(h.jsx)(p.Box,{width:"100%",children:"undefined"!==typeof Y&&Object(h.jsx)(p.StringParser,{children:Y})})]}),Object(h.jsxs)(p.Line,{width:"100%",justifyContent:"flex-end",p:15,children:[(!a||!y)&&Object(h.jsx)(p.Text,{mr:1,children:K}),Object(h.jsx)(p.Button,{isLoading:W,onClick:function(){return i===B&&r===F?void S.push(O.b.USER_PROFILE_DETAILS.getRoute({userId:T})):(M({type:"setIsSigned"}),q())},children:A(a&&y?"go_back_to_homepage":"continue")})]})]})]}))}},742:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var i=r(17),n=r(285),c=(r(0),r(14)),o=r(1),s=["children"],a=function(e){var t=e.children,r=Object(n.a)(e,s);return Object(o.jsx)(c.Box,Object(i.a)(Object(i.a)({boxSizing:"border-box",height:"100%",overflow:"hidden",width:"100%"},r),{},{children:t}))}}}]);