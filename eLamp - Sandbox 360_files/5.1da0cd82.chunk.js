(this["webpackJsonp@elamp/main-app"]=this["webpackJsonp@elamp/main-app"]||[]).push([[5],{762:function(e,t,n){"use strict";n.d(t,"b",(function(){return b})),n.d(t,"c",(function(){return g})),n.d(t,"a",(function(){return z}));var i=n(285),a=n(17),r=n(53),c=n(0),d=n(14),s=n(19),o=n(32),u=n(10),l=["status","comment","customFields","trainingTag"],b=function(e){var t=e.onBulkStatusUpdateCompleted,n=e.onUpdateCompleted,b=e.pinnedTrainingId,j=(e.onBulkDeletionCompleted,Object(u.useAppContext)().getErrorMessage),p=Object(d.useAlert)(),O=Object(s.useGetPinnedTrainingDataLazyQuery)(),f=Object(r.a)(O,2),h=f[0],g=f[1],m=g.data,v=g.loading,x=Object(s.useUpdateTrainingPinMutation)(),T=Object(r.a)(x,2),y=T[0],P=T[1].loading,I=Object(s.usePinTrainingsStatusBulkUpdateMutation)(),S=Object(r.a)(I,2),D=S[0],C=S[1].loading;Object(c.useEffect)((function(){"undefined"!==typeof b&&h({variables:{id:b}})}),[b]);var w=Object(c.useMemo)((function(){var e=null===m||void 0===m?void 0:m.pinnedTraining;if(e){if("undefined"===typeof e.user||null===e.user||"undefined"===typeof e.training||null===e.training)return;return Object(a.a)({id:e.id,status:e.status,capabilities:{canDelete:e.capabilities.canDelete,canUpdate:e.capabilities.canUpdate,allowedStatuses:e.capabilities.allowedStatuses},trainingTag:{id:e.training.id,name:e.training.name,kind:"trainingTag"},user:Object(s.getFormatedUserBasicFragment)(e.user),updatedAt:e.updatedAt},Object(s.getFormatedPinTrainingData)(e.data))}}),[m]),L=Object(c.useMemo)((function(){for(var e={},t=0,n=Object.values(o.PinTrainingStatus);t<n.length;t++){var i=n[t];(null===w||void 0===w?void 0:w[i])&&(e[i]=w[i])}return e}),[m]);return{isPinnedTrainingDataLoading:v,isPinnedTrainingUpdateLoading:P,isPinTrainingsStatusBulkUpdateLoading:C,onPinnedTrainingUpdate:function(e){if("undefined"!==typeof b){e.status;var t=e.comment,r=e.customFields,c=e.trainingTag,d=Object(i.a)(e,l),s={id:b,status:e.status,comment:t,trainingId:c.id};"undefined"!==typeof r&&(s.customFields=r),s=Object(a.a)(Object(a.a)({},s),d),y({variables:{input:s},onCompleted:n,onError:function(e){p.error(j(e)),console.error("Training application failed !!!",e)}})}},onPinnedTrainingBulkDeletion:function(e){},onPinnedTrainingBulkStatusUpdate:function(e){var n=e.comment,i=e.updatedStatus,a=e.selectedIds;"undefined"!==typeof i&&"undefined"!==typeof a&&D({variables:{input:{ids:a,comment:n,status:i}},onCompleted:t,onError:function(e){return p.error(j(e))}})},pinnedTraining:w,pinnedTrainingHistory:L}},j=n(15),p=function(e){var t=e.userId,n=e.pinnedTrainingId;return"undefined"!==typeof t&&"undefined"!==typeof n},O=function(e,t){switch(t.type){case"setIds":return Object(a.a)(Object(a.a)({},e),{},{pinnedTrainingId:t.pinnedTrainingId,userId:t.userId,isOpened:p({userId:t.userId,pinnedTrainingId:t.pinnedTrainingId})});case"setPinnedTrainingId":return Object(a.a)(Object(a.a)({},e),{},{pinnedTrainingId:t.pinnedTrainingId,isOpened:p({userId:e.userId,pinnedTrainingId:t.pinnedTrainingId})});case"setUserId":return Object(a.a)(Object(a.a)({},e),{},{userId:t.userId,isOpened:p({userId:t.userId,pinnedTrainingId:e.pinnedTrainingId})});case"close":return Object(a.a)(Object(a.a)({},e),{},{isOpened:!1,pinnedTrainingId:void 0});case"open":return Object(a.a)(Object(a.a)({},e),{},{isOpened:p({userId:e.userId,pinnedTrainingId:e.pinnedTrainingId})});default:return e}},f="pinnedTraining",h="user",g=function(e){var t=Object(c.useReducer)(O,{userId:e.userId,pinnedTrainingId:e.pinnedTrainingId,isOpened:p({userId:e.userId})}),n=Object(r.a)(t,2),i=n[0],a=i.isOpened,d=i.pinnedTrainingId,s=i.userId,o=n[1],u=Object(j.useHistory)(),l=Object(j.useLocation)();Object(c.useEffect)((function(){a?u.replace("?".concat(f,"=").concat(d,"&").concat(h,"=").concat(s)):u.replace(l.pathname)}),[a,d,s]),Object(c.useEffect)((function(){var e=new URLSearchParams(l.search),t=e.get(f),n=e.get(h);t&&n&&(t!==d||n!==s)&&o({type:"setIds",pinnedTrainingId:t,userId:n})}),[l.search]);return{close:function(){o({type:"close"})},isOpened:a,open:function(){o({type:"open"})},pinnedTrainingId:d,setPinnedTrainingId:function(e){return o({type:"setPinnedTrainingId",pinnedTrainingId:e})},setUserAndPinnedTrainingId:function(e){var t=e.userId,n=e.pinnedTrainingId;return o({type:"setIds",userId:t,pinnedTrainingId:n})},setUserId:function(e){return o({type:"setUserId",userId:e})},userId:s}},m=n(752),v=n(786),x=n(223),T=n(187),y=n(65),P=n(63),I=n(37),S=n(747),D=n(787),C=n(1),w=function(e){var t=e.status,n=e.isOpened,i=e.isLoading,a=e.onClose,s=e.onCancel,o=e.onConfirm,l=e.isReadOnly,b=Object(c.useState)(""),j=Object(r.a)(b,2),p=j[0],O=j[1],f=Object(d.useTranslate)({capitalize:!0});Object(c.useEffect)((function(){n||O("")}),[n]);return Object(C.jsx)(u.StandardModal,{title:f("pin_training_status_update"),isOpened:n,onClose:a,onCancel:s,onConfirm:function(){o(p)},isLoading:i,isDisabledSubmit:l,width:800,children:Object(C.jsxs)(d.Column,{alignItems:"flex-start",children:[Object(C.jsx)(d.Text,{mb:1,children:f("two_points",{phrase:f("pin_training_status_update_confirm_msg")})}),Object(C.jsx)(D.a,{status:t,width:162,my:1}),Object(C.jsx)(d.TextArea,{value:p,onChange:O,placeholder:f("comment"),disabled:l,mt:1})]})})},L=["capabilities","isPinnedTrainingUpdateLoading","onUpdate","pinnedTraining"],A=function(e){var t=e.customFields,n=e.id;if(null===t||void 0===t?void 0:t.find((function(e){return Object.keys(e||{})[0]===n})))return Object.values(t.find((function(e){return Object.keys(e||{})[0]===n}))||[])[0]},E=function(e){var t=e.capabilities,n=e.isPinnedTrainingUpdateLoading,s=e.onUpdate,o=e.pinnedTraining,l=Object(i.a)(e,L),b=Object(c.useState)(o.status),j=Object(r.a)(b,2),p=j[0],O=j[1],f=Object(d.useTranslate)({capitalize:!0}),h=Object(d.useSwitch)(!1),g=h.active,m=h.off,v=h.on,D=Object(y.h)(),E=Object(u.useAppContext)().customFields.pinnedTrainingFields,_=[];if(o.customFields)for(var k=0,U=Object.entries(o.customFields);k<U.length;k++){var F=Object(r.a)(U[k],2),M=F[0],B=F[1];_.push(Object(T.a)({},M,B))}Object(c.useEffect)((function(){p!==o.status?v():m()}),[p]);var z=function(e){return function(t){if("status"===e)O(t);else if("deadline"===e){var n=Object(I.localeMoment)(t).toISOString();s(Object(a.a)(Object(a.a)({},o),{},{deadline:n}))}else s(Object(a.a)(Object(a.a)({},o),{},Object(T.a)({},e,t)))}},R=Object(c.useMemo)((function(){var e,n=[],i=Object(x.a)(S.b);try{var a=function(){var i=e.value;o.status&&!(t.allowedStatuses||[]).includes(o.status)&&i[0]===o.status&&n.push(i),(t.allowedStatuses||[]).forEach((function(e){i[0]===e&&n.push(i)}))};for(i.s();!(e=i.n()).done;)a()}catch(r){i.e(r)}finally{i.f()}return n}),[t]);return Object(C.jsxs)(C.Fragment,{children:[Object(C.jsxs)(d.Column,Object(a.a)(Object(a.a)({},l),{},{children:[Object(C.jsx)(u.FormLine,{children:Object(C.jsx)(u.FormLabel,{content:f("targeted_training"),children:Object(C.jsx)(P.ObjectTag,Object(a.a)({},o.trainingTag))})}),Object(C.jsx)(u.FormLine,{children:Object(C.jsx)(u.FormLabel,{name:"status",content:f("status"),children:Object(C.jsx)(d.SelectField,{value:o.status,onChange:z("status"),zIndex:D.zIndexes.MODAL_POPOVER,readOnly:1===R.length||!t.canUpdate,placeholder:"",source:R.map((function(e){return{label:f(e[1]),value:e[0]}})),width:"100%"})})}),Object(C.jsxs)(C.Fragment,{children:[Object(C.jsx)(u.FormLine,{children:Object(C.jsx)(u.FormLabel,{name:"budgetYear",content:f("budget_year"),mr:1,children:Object(C.jsx)(d.TextEditable,{value:o.budgetYear,onSubmit:z("budgetYear"),readOnly:!t.canUpdate,placeholder:f("add_a_value")})})}),Object(C.jsx)(u.FormLine,{children:Object(C.jsx)(d.PeriodPicker,{startDate:o.startDate,endDate:o.endDate,readOnly:!t.canUpdate,onChange:function(e){var t=e.startDate,n=e.endDate;if("undefined"!==typeof t&&t!==o.startDate||"undefined"!==typeof n&&n!==o.endDate){if("undefined"!==typeof n&&"string"===typeof o.startDate&&Object(I.localeMoment)(n).isBefore(o.startDate))return;"undefined"===typeof t||"undefined"!==typeof n&&!Object(I.localeMoment)(t).isAfter(Object(I.localeMoment)(o.endDate))?s(Object(a.a)(Object(a.a)({},o),{},{startDate:t||o.startDate,endDate:n||o.endDate})):s(Object(a.a)(Object(a.a)({},o),{},{startDate:t,endDate:t}))}},isOneDayMinimumGap:!1})}),E.map((function(e){return Object(C.jsx)(u.FormLine,{children:Object(C.jsx)(P.CustomField,Object(a.a)({mr:1,field:e,withLabel:!0,readOnly:!t.canUpdate,value:A({customFields:_,id:e._key}),onSubmit:function(t){return function(e){var t=Object(T.a)({},e.id,e.value),n={};_?_.forEach((function(e){var i=Object(r.a)(Object.entries(e||[])[0],2),c=i[0],d=i[1];n=Object(a.a)(Object(a.a)({},n),{},Object(T.a)({},c,d),t)})):n=t,z("customFields")(n)}({id:e._key,value:t,comparator:"DATE"===e.field_type?"BETWEEN":"IN_VALUES",fieldType:e.field_type})}},e),e._key)},e._key)}))]})]})),Object(C.jsx)(w,{isLoading:n,isOpened:g,isReadOnly:!t.canUpdate,onCancel:m,onClosingComplete:function(){O(o.status)},onClose:m,onConfirm:function(e){s(Object(a.a)(Object(a.a)({},o),{},{status:p,comment:e})),m()},status:p})]})},_=n(23),k=n(758),U=["data","isOpened"],F={MAP:{},statusToDisplay:[],usersIds:[]},M=["suggested","approved","accepted","pending","validated","noshow","canceled"],B=function(e){var t=e.data,n=e.isOpened,o=Object(i.a)(e,U),u=Object(d.useTranslate)(),l=Object(d.useSwitch)(!1),b=l.active,j=l.off,p=l.on,O=Object(c.useState)(F),f=Object(r.a)(O,2),h=f[0],g=h.MAP,m=h.statusToDisplay,v=h.usersIds,T=f[1],y=Object(s.useGetUsersLazyQuery)({variables:{ids:v}}),P=Object(r.a)(y,2),I=P[0],S=P[1],D=S.data,w=S.loading;Object(c.useEffect)((function(){var e={},n=[],i=new Set;if(t)for(var a=0,c=Object.entries(t);a<c.length;a++){var d,s=Object(r.a)(c[a],2),o=s[0],u=s[1],l=Object(x.a)(M);try{for(l.s();!(d=l.n()).done;){var b=d.value;o===b&&"undefined"!==typeof u&&(e[o]={data:u,wording:"training_status_".concat(o)},i.add(o),o===b&&n.push(u.by.id))}}catch(p){l.e(p)}finally{l.f()}}var j={MAP:e,usersIds:n,statusToDisplay:Array.from(i)};T(j)}),[t]),Object(c.useEffect)((function(){!0===n&&(v||[]).length>0&&I()}),[n,v]);var L=Object(c.useMemo)((function(){var e;return(null===D||void 0===D||null===(e=D.users)||void 0===e?void 0:e.nodes)?D.users.nodes.map((function(e){return Object(s.getFormatedUserBasicFragment)(e)})):[]}),[D]),A=function(e){return Object.entries(e).length>0},E=function(){for(var e=[],t=0,n=Object.values(g);t<n.length;t++){var i=n[t],a=i.data,r=i.wording;A(a)&&e.push({data:a,wording:r})}return e.sort((function(e,t){return new Date(t.data.at).getTime()-new Date(e.data.at).getTime()}))},B=Object(c.useMemo)((function(){return E()&&!b?E().slice(0,3):E()}),[E(),b]),z=function(){b?j():p()};return m.length>0?Object(C.jsxs)(k.a,Object(a.a)(Object(a.a)({isExpanded:b,isShowMoreDisplayed:E().length>3&&!b,onClickShowLess:z,onClickShowMore:z,title:Object(_.maj)(u("history_title"))},o),{},{children:[w&&Object(C.jsx)(C.Fragment,{children:m.map((function(e,t){return Object(C.jsxs)(d.Box,{children:[Object(C.jsxs)(d.Line,{width:"100%",height:"100%",children:[Object(C.jsx)(d.LoaderSkeleton.Point,{}),Object(C.jsx)(d.LoaderSkeleton.Line,{width:"150px"})]}),Object(C.jsx)(d.Line,{width:"100%",height:"100%",mt:1,children:Object(C.jsx)(d.LoaderSkeleton.Line,{width:"100px"})})]},"".concat(e," - ").concat(t))}))}),!w&&L.length>0&&B.map((function(e){var t=e.data,n=e.wording;if(t.by.id){var i=L.find((function(e){return e.id===t.by.id}));return A(t)&&i?Object(C.jsxs)(C.Fragment,{children:[Object(C.jsx)(k.b,{user:i,date:t.at,children:Object(C.jsx)(d.Text,{fontSize:"small",as:"span",children:"".concat(u("pinned_training_updated_status_to"),' "').concat(u(n),'"')})}),t.comment&&Object(C.jsx)(d.TextWithAutoTooltipOnEllipsis,{rows:5,tooltipTitle:t.comment,pl:30,fontSize:"small",color:"grey.6",mb:1,children:t.comment})]}):null}return null}))]})):null},z=function(e){var t=e.isOpened,n=e.onClose,i=e.onUpdate,a=e.pinnedTrainingId,r=Object(d.useTranslate)({capitalize:!0}),c=Object(d.useResponsive)().isMobile,s=Object(u.useAppContext)().topBarHeight,o=b({pinnedTrainingId:a}),l=o.isPinnedTrainingUpdateLoading,j=o.isPinnedTrainingDataLoading,p=o.pinnedTraining,O=o.pinnedTrainingHistory;return Object(C.jsx)(d.RightPane.Container,{contentTop:c?0:s,isOpened:t,isOverlayTransparent:!0,fixed:!0,onClose:n,children:Object(C.jsx)(d.RightPane.Content,{bg:"white",height:c?"100%":"calc(100% - ".concat(s,"px)"),width:620,maxWidth:"100%",children:"undefined"!==typeof a&&"undefined"===typeof p&&j?Object(C.jsx)(v.c,{}):Object(C.jsx)(v.e,{renderHeader:function(){return Object(C.jsxs)(d.Line,{width:"100%",p:2,children:[c&&Object(C.jsx)(d.ClickableIcon,{icon:m.a,onClick:n,mr:2}),Object(C.jsx)(d.Text,{fontWeight:"bold",fontSize:"huge",children:r("training_application")})]})},children:"undefined"!==typeof p&&Object(C.jsxs)(C.Fragment,{children:[Object(C.jsx)(E,{capabilities:p.capabilities,isPinnedTrainingUpdateLoading:l,onUpdate:i,pinnedTraining:{status:p.status,trainingTag:p.trainingTag,budgetYear:p.budgetYear,comment:p.comment,customFields:p.customFields,deadline:p.deadline,startDate:p.startDate,endDate:p.endDate}},p.id),Object(C.jsx)(B,{data:O,isOpened:t})]})})})})}},765:function(e,t,n){"use strict";n.d(t,"a",(function(){return A})),n.d(t,"b",(function(){return M}));var i=n(17),a=n(139),r=n.n(a),c=n(286),d=n(285),s=n(0),o=n(14),u=n(10),l=n(187),b=n(53),j=n(751),p=n(32),O=n(23),f=n(61),h=n(1),g=["label","isActive"],m=Object(f.default)(o.Text)((function(){return{fontWeight:"bold",borderRadius:0,textTransform:"uppercase"}}),(function(e){var t=e.isActive,n=e.theme;return t?{backgroundColor:n.colors.grey[2]}:{color:n.colors.grey[6]}})),v=function(e){var t=e.label,n=e.isActive,a=Object(d.a)(e,g);return Object(h.jsx)(m,Object(i.a)(Object(i.a)({isActive:n,p:1},a),{},{children:t}))},x=["value","onChange"],T=function(e){return{type:(null===e||void 0===e?void 0:e.type)||p.ScheduledPeriodType.ABSENCE,description:(null===e||void 0===e?void 0:e.description)||"",name:(null===e||void 0===e?void 0:e.name)||"",startDate:(null===e||void 0===e?void 0:e.startDate)||(new Date).toISOString(),endDate:(null===e||void 0===e?void 0:e.endDate)||(new Date).toISOString(),rate:(null===e||void 0===e?void 0:e.rate)||100}},y=function(e){var t=e.value,n=e.onChange,a=Object(d.a)(e,x),r=Object(s.useState)(T(t)),c=Object(b.a)(r,2),u=c[0],f=c[1],g=Object(o.useTranslate)({capitalize:!0}),m=Object(s.useCallback)(Object(j.debounce)((function(e){return n(e)}),500),[n]);Object(s.useEffect)((function(){f(T(t))}),[t]);var y=function(e){return function(){P("type")(e)}},P=function(e){return function(t){var n=Object(i.a)(Object(i.a)({},u),{},Object(l.a)({},e,t));f(n),m(n)}};return Object(h.jsxs)(o.Box,Object(i.a)(Object(i.a)({},a),{},{children:[Object(h.jsx)(o.Label,{content:g("name"),mb:2,required:!0,children:Object(h.jsx)(o.Input,{placeholder:g("unavailability_name"),value:u.name,onChange:P("name")})}),Object(h.jsxs)(o.Line,{justifyContent:"space-around",my:2,children:[Object(h.jsx)(v,{label:Object(O.maj)(g("absence")),onClick:y(p.ScheduledPeriodType.ABSENCE),isActive:u.type===p.ScheduledPeriodType.ABSENCE}),Object(h.jsx)(v,{label:Object(O.maj)(g("training",1)),onClick:y(p.ScheduledPeriodType.TRAINING),isActive:u.type===p.ScheduledPeriodType.TRAINING})]}),Object(h.jsx)(o.TextArea,{mb:2,value:u.description,onChange:P("description"),placeholder:g("details")}),Object(h.jsx)(o.PeriodPicker,{startDate:u.startDate,endDate:u.endDate,startDateLabel:g("from"),endDateLabel:g("to"),isFlex:!1,onChange:function(e){var t=Object(i.a)(Object(i.a)({},u),e);f(t),m(t)},mb:2,width:"100%"}),Object(h.jsx)(o.Label,{mb:2,content:"".concat(g("rate")," (%)"),children:Object(h.jsxs)(o.Line,{children:[Object(h.jsx)(o.Input,{mr:2,width:100,min:0,max:100,type:"number",rightElement:Object(h.jsx)(o.Text,{as:"span",children:"%"}),value:u.rate,onChange:function(e){return P("rate")(Number(e))}}),Object(h.jsx)(o.Slider,{flex:1,graduations:null,value:u.rate,max:100,onChange:function(e){return P("rate")(Number(e))}})]})})]}))},P=n(841),I=n(19),S=n(749),D=["onDelete"],C=function(e){var t=e.onDelete,n=Object(d.a)(e,D),a=Object(o.useSwitch)(!1),r=a.active,c=a.on,s=a.off,u=Object(o.useTranslate)({capitalize:!0});return Object(h.jsxs)(o.Column,Object(i.a)(Object(i.a)({alignItems:"flex-start"},n),{},{children:[Object(h.jsxs)(o.Line,{width:"100%",justifyContent:"space-between",mb:2,children:[Object(h.jsx)(o.Box,{children:Object(h.jsx)(o.Text,{fontWeight:"semiBold",children:u("unavailability")})}),Object(h.jsxs)(o.MenuSelect.Target,{px:1,children:[Object(h.jsx)(o.IconButton,{iconAs:S.a,onClick:c,isActive:r}),Object(h.jsx)(o.MenuSelect,{onClose:s,isOpened:r,children:Object(h.jsx)(o.MenuOption,{onClick:function(){t&&t(),s()},children:u("delete")})})]})]}),Object(h.jsx)(o.Line,{children:Object(h.jsx)(o.Text,{fontWeight:"bold",fontSize:"big",children:u("unavailability_details")})})]}))},w=["scheduledPeriodId","onUpdatedScheduledPeriod","onDeletedScheduledPeriod","isOpened","onClose"],L=["value","onChange","isLoading"],A=function(e){var t=e.scheduledPeriodId,n=e.onUpdatedScheduledPeriod,a=e.onDeletedScheduledPeriod,l=e.isOpened,j=e.onClose,p=Object(d.a)(e,w),O=Object(o.useTranslate)({capitalize:!0}),f=Object(u.useAppContext)().getErrorMessage,g=Object(o.useSwitch)(!1),m=Object(o.useAlert)(),v=function(e){var t=e.scheduledPeriodId,n=Object(I.useGetScheduledPeriodLazyQuery)({fetchPolicy:"cache-first",nextFetchPolicy:"network-only"}),i=Object(b.a)(n,2),a=i[0],d=i[1],o=d.data,u=d.loading,l=d.refetch,j=Object(I.useUpdatePeriodMutation)({awaitRefetchQueries:!0,refetchQueries:I.refetchQueries.onMutateScheduledPeriod,update:function(e,t){l&&l()}}),p=Object(b.a)(j,1)[0],O=Object(I.useDeleteScheduledPeriodMutation)({awaitRefetchQueries:!0,refetchQueries:I.refetchQueries.onMutateScheduledPeriod}),f=Object(b.a)(O,2),h=f[0],g=f[1].loading,m=function(){var e=Object(c.a)(r.a.mark((function e(n){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=2;break}return e.abrupt("return",p({variables:{input:{id:t,name:n.name,description:n.description,startDate:n.startDate,endDate:n.endDate,type:n.type,rate:n.rate}}}).then((function(){})).catch((function(e){throw new Error(e)})));case 2:return e.abrupt("return");case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),v=function(){var e=Object(c.a)(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=2;break}return e.abrupt("return",h({variables:{input:{id:t}}}).then((function(){})).catch((function(e){throw new Error(e)})));case 2:return e.abrupt("return");case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),x=Object(s.useMemo)((function(){if(null===o||void 0===o?void 0:o.scheduledPeriod)return{id:o.scheduledPeriod.id,name:Object(I.maybeToOptional)(o.scheduledPeriod.name),description:Object(I.maybeToOptional)(o.scheduledPeriod.description),startDate:o.scheduledPeriod.startDate,endDate:o.scheduledPeriod.endDate,rate:o.scheduledPeriod.rate,type:o.scheduledPeriod.type}}),[o]);return Object(s.useEffect)((function(){t&&a({variables:{id:t}})}),[t]),{scheduledPeriod:x,isLoadingScheduledPeriod:u,isDeletingScheduledPeriod:g,updateScheduledPeriod:m,deleteScheduledPeriod:v}}({scheduledPeriodId:t}),x=v.scheduledPeriod,T=v.isLoadingScheduledPeriod,y=v.isDeletingScheduledPeriod,S=v.updateScheduledPeriod,D=v.deleteScheduledPeriod,L=function(){var e=Object(c.a)(r.a.mark((function e(i){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",S(i).then((function(){m.success(O("your_availability_has_been_updated")),n&&n()})).catch((function(e){m.error(f(e)),console.error("Error updating scheduledPeriod ".concat(t),e)})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)(P.a,Object(i.a)(Object(i.a)({isOpened:l,onClose:j,renderHeader:function(){return Object(h.jsx)(C,{onDelete:g.on})}},p),{},{children:"undefined"!==typeof x&&Object(h.jsx)(E,{isLoading:T,value:x,onChange:L,mt:1})})),Object(h.jsx)(o.ConfirmModal,{isOpened:g.active,onConfirm:function(){D().then((function(){m.success(O("success")),a&&a(),g.off()})).catch((function(e){m.error(f(e)),console.error("Error deleting scheduledPeriod ".concat(t),e)}))},onCancel:g.off,isLoading:y,children:Object(h.jsx)(o.Box,{display:"flex",flexDirection:"column",children:Object(h.jsx)(o.Text,{fontSize:"big",fontWeight:"bold",children:O("confirm_delete_unavailability")})})})]})},E=function(e){var t=e.value,n=e.onChange,a=e.isLoading,r=Object(d.a)(e,L);return a?Object(h.jsx)(o.Loader,{}):Object(h.jsx)(y,Object(i.a)({value:t,onChange:n},r))},_=n(15),k="scheduledPeriodId",U=function(e){return"undefined"!==typeof e.scheduledPeriodId},F=function(e,t){switch(t.type){case"setScheduledPeriodId":return Object(i.a)(Object(i.a)({},e),{},{scheduledPeriodId:t.scheduledPeriodId,isOpened:U({scheduledPeriodId:t.scheduledPeriodId})});case"open":return Object(i.a)(Object(i.a)({},e),{},{isOpened:U({scheduledPeriodId:e.scheduledPeriodId})});case"close":return Object(i.a)(Object(i.a)({},e),{},{isOpened:!1});default:return e}},M=function(e){var t=Object(s.useReducer)(F,{scheduledPeriodId:e.scheduledPeriodId,isOpened:U({scheduledPeriodId:e.scheduledPeriodId})}),n=Object(b.a)(t,2),i=n[0],a=i.isOpened,r=i.scheduledPeriodId,c=n[1],d=Object(_.useLocation)(),o=Object(_.useHistory)();Object(s.useEffect)((function(){a&&r?o.push("?".concat(k,"=").concat(r)):o.push(d.pathname)}),[a,r]),Object(s.useEffect)((function(){var e=new URLSearchParams(d.search).get(k);e&&e!==r?c({type:"setScheduledPeriodId",scheduledPeriodId:e}):e||c({type:"close"})}),[d.search]);return{isOpened:a,scheduledPeriodId:r,setScheduledPeriodId:function(e){c({type:"setScheduledPeriodId",scheduledPeriodId:e})},open:function(){c({type:"open"})},close:function(){c({type:"close"})}}}},767:function(e,t,n){"use strict";n(762);var i=n(785);n.d(t,"a",(function(){return i.a})),n.d(t,"d",(function(){return i.b}));var a=n(765);n.d(t,"b",(function(){return a.a})),n.d(t,"e",(function(){return a.b}));var r=n(790);n.d(t,"c",(function(){return r.a})),n.d(t,"f",(function(){return r.b}))},787:function(e,t,n){"use strict";n.d(t,"a",(function(){return j}));var i,a=n(17),r=n(285),c=n(187),d=(n(0),n(14)),s=n(32),o=n(747),u=n(1),l=["status"],b=(i={},Object(c.a)(i,s.PinTrainingStatus.Validated,{color:"success.0",label:o.b.get(s.PinTrainingStatus.Validated)}),Object(c.a)(i,s.PinTrainingStatus.Suggested,{color:"grey.0",label:o.b.get(s.PinTrainingStatus.Suggested)}),Object(c.a)(i,s.PinTrainingStatus.Approved,{color:"secondary.0",label:o.b.get(s.PinTrainingStatus.Approved)}),Object(c.a)(i,s.PinTrainingStatus.Accepted,{color:"secondary.0",label:o.b.get(s.PinTrainingStatus.Accepted)}),Object(c.a)(i,s.PinTrainingStatus.Pending,{color:"secondary.0",label:o.b.get(s.PinTrainingStatus.Pending)}),Object(c.a)(i,s.PinTrainingStatus.Refused,{color:"error.0",label:o.b.get(s.PinTrainingStatus.Refused)}),Object(c.a)(i,s.PinTrainingStatus.Noshow,{color:"error.0",label:o.b.get(s.PinTrainingStatus.Noshow)}),Object(c.a)(i,s.PinTrainingStatus.Canceled,{color:"error.0",label:o.b.get(s.PinTrainingStatus.Canceled)}),i),j=function(e){var t=e.status,n=Object(r.a)(e,l),i=Object(d.useTranslate)({capitalize:!0}),c=b[t];return Object(u.jsx)(d.Box,Object(a.a)(Object(a.a)({p:0,bg:c.color,display:"flex",justifyContent:"center"},n),{},{children:Object(u.jsx)(d.Text,{fontWeight:"semiBold",children:i(c.label)})}))}}}]);