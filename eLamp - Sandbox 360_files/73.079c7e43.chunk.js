(this["webpackJsonp@elamp/main-app"]=this["webpackJsonp@elamp/main-app"]||[]).push([[73],{1567:function(t,e,n){"use strict";n.r(e);var r=n(17),i=n(53),o=n(0),a=n(15),u=n(14),s=n(37),c=n(19),l=n(10),b=n(3),j=n(63),d=n(1),f=function(t){var e=t.initialPattern,n=t.closeButtonLabel,r=t.submitButtonLabel,a=t.onClose,s=t.onSubmit,c=Object(u.useTranslate)({capitalize:!0}),l=Object(o.useState)(e),b=Object(i.a)(l,2),f=b[0],O=b[1];return Object(d.jsxs)(u.Box,{height:"calc(100vh - 110px)",p:3,children:[Object(d.jsx)(u.Box,{height:"100%",overflowY:"auto",children:Object(d.jsx)(j.PatternEditor,{initialPattern:f,isSkillWithChildrenSelectionBlocked:!0,onChange:function(t){O(t)}})}),Object(d.jsxs)(u.Box,{display:"flex",justifyContent:"center",pt:2,children:[Object(d.jsx)(u.Button,{onClick:a,appearance:"outline",mr:2,children:c(n)}),Object(d.jsx)(u.Button,{onClick:function(){s(f)},ml:2,children:c(r)})]})]})},O=n(1149);function p(t){var e=Object(r.a)({},t);return e.externalLink&&(e.externalLinks=[e.externalLink],delete e.externalLink),e.issuerGroups&&(e.issuerGroups=[e.issuerGroups],delete e.issuerGroups),e.startDate&&(e.startDate=Object(s.localeMoment)(e.startDate).toISOString()),e}var h=function(){var t=Object(u.useTranslate)(),e=Object(l.useAppContext)().getErrorMessage,n=Object(u.useAlert)(),r=Object(a.useHistory)(),s=Object(o.useState)("step1"),j=Object(i.a)(s,2),h=j[0],v=j[1],x=Object(c.useUpdateJobOfferMutation)(),m=Object(i.a)(x,1)[0],k=Object(c.useCreateJobOfferMutation)(),B=Object(i.a)(k,2),C=B[0],S=B[1],L=S.data,g=S.loading,P=Object(o.useMemo)((function(){var t=null===L||void 0===L?void 0:L.createJobOffer;if(null===t||void 0===t?void 0:t.jobOffer)return{id:t.jobOffer.id,name:t.jobOffer.name,rawPattern:t.jobOffer.rawPattern}}),[L]),w=function(t){r.push(b.b.RECRUITING_JOB_OFFERS_DETAILS.getRoute({jobId:t}),{redirectAfterCreation:!0})};return"step1"===h?Object(d.jsx)(O.a,{onSubmit:function(t){C({variables:{jobOffer:p(t)}}).then((function(){return v("step2")})).catch((function(t){return n.error(e(t))}))},isLoading:g}):Object(d.jsx)(f,{initialPattern:(null===P||void 0===P?void 0:P.rawPattern)||{must:[],should:[]},onClose:function(){(null===P||void 0===P?void 0:P.id)&&w(null===P||void 0===P?void 0:P.id)},onSubmit:function(r){P?m({variables:{input:{id:P.id,rawPattern:r}}}).then((function(){return w(null===P||void 0===P?void 0:P.id)})).catch((function(t){return n.error(e(t))})):n.error(t("error"))},closeButtonLabel:"skip_this_step",submitButtonLabel:"submit"})};e.default=h}}]);