(this["webpackJsonp@elamp/main-app"]=this["webpackJsonp@elamp/main-app"]||[]).push([[7],{1009:function(e,t,n){"use strict";n.d(t,"a",(function(){return S}));var r=n(139),a=n.n(r),c=n(286),o=n(53),i=n(285),l=n(17),s=n(0),d=n(19),u=n(23),j=n(37),p=n(14),b=n(10),f=n(996),O=n(1013),m=n(785),h=n(188),v=n(773),g=function(e){return e.map((function(e){return{id:e.skill.id,name:e.skill.name,logo:e.skill.logo,color:e.skill.color}}))},x=n(1147),y=n(1),w=["projectId"],P={isProjectNeedModalOpen:!1,isSearchProfileModalOpen:!1,newProjectNeedName:void 0,newProjectNeedDescription:void 0,newProjectNeedId:void 0,newProjectNeedSearchPattern:void 0},C=function(e,t){switch(t.type){case"openProjectNeedModal":return Object(l.a)(Object(l.a)({},e),{},{isProjectNeedModalOpen:!0});case"closeProjectNeedModal":return Object(l.a)(Object(l.a)({},e),{},{isProjectNeedModalOpen:!1});case"setNewProjectNeedDetails":return Object(l.a)(Object(l.a)({},e),{},{newProjectNeedName:t.newProjectNeedName,newProjectNeedDescription:t.newProjectNeedDescription,newProjectNeedId:t.newProjectNeedId,newProjectNeedSearchPattern:t.newProjectNeedSearchPattern,isProjectNeedModalOpen:!1});case"openSearchProfileModal":return Object(l.a)(Object(l.a)({},e),{},{isSearchProfileModalOpen:!0});case"reset":return P}},S=Object(s.createContext)({});t.b=function(e){var t,n=e.projectId,r=Object(i.a)(e,w),D=Object(b.useAppContext)().getErrorMessage,H=Object(s.useReducer)(C,P),I=Object(o.a)(H,2),M=I[0],V=M.isProjectNeedModalOpen,E=M.isSearchProfileModalOpen,N=M.newProjectNeedDescription,_=M.newProjectNeedId,k=M.newProjectNeedName,T=M.newProjectNeedSearchPattern,z=I[1],L=Object(p.useTranslate)({capitalize:!0}),R=Object(p.useAlert)(),F=Object(d.useGetProjectQuery)({variables:{id:n}}),A=F.data,B=F.loading,Z=F.refetch,U=Object(d.useUpdateProjectNeedMutation)(),W=Object(o.a)(U,1)[0],G=Object(d.useCreateProjectNeedMutation)(),K=Object(o.a)(G,2),q=K[0],J=K[1],Q=J.data,X=J.loading,Y=Object(m.b)({}),$=Y.setProjectNeedId,ee=Y.setProjectAssignmentId,te=Y.projectNeedId,ne=Y.projectAssignmentId,re=Y.isOpened,ae=Y.close;Object(s.useEffect)((function(){Q&&Z({id:n})}),[Q]);var ce=Object(s.useMemo)((function(){if(null===A||void 0===A?void 0:A.project){var e;if(A.project.place&&(e={label:A.project.place.label},A.project.place.location)){var t=A.project.place.location,n=t.latitude,r=t.longitude;e.location={latitude:n,longitude:r}}return{id:A.project.id,name:Object(d.maybeToOptional)(A.project.name),startDate:A.project.startDate?new Date(A.project.startDate):void 0,endDate:A.project.endDate?new Date(A.project.endDate):void 0,capabilities:A.project.capabilities,place:e,customFields:Object(d.maybeToOptional)(A.project.customFields),groups:A.project.groups.nodes.map((function(e){return e.id}))}}}),[A]),oe=Object(s.useMemo)((function(){var e,t;return((null===A||void 0===A||null===(e=A.project)||void 0===e||null===(t=e.projectNeeds)||void 0===t?void 0:t.nodes)||[]).map((function(e){var t,n,r,a=e.headCount||0,c=e.assignedHeadCount||0,o=((null===(t=e.projectAssignments)||void 0===t?void 0:t.nodes)||[]).map((function(e){return"AssignmentExternalResource"===e.assignedUser.__typename?{id:e.assignedUser.id,displayName:e.assignedUser.displayName,avatarURL:Object(d.maybeToOptional)(e.assignedUser.avatarURL)}:"User"===e.assignedUser.__typename?Object(d.getFormatedUserBasicFragment)(e.assignedUser):void 0}));return{id:e.id,name:Object(d.maybeToOptional)(e.name)||"",startDate:e.startDate,endDate:e.endDate,assignedUsers:o,resourceSearchPatternTags:(r=e.resourceSearchPatternTags,r.map((function(e){return"SearchPatternTagSkill"===e.__typename?{kind:"skillTag",id:e.id,name:e.name,color:e.color,logo:e.logo||null}:"SearchPatternTagAvailability"===e.__typename?{kind:"availabilityTag",startDate:Object(d.maybeToOptional)(e.startDate),endDate:Object(d.maybeToOptional)(e.endDate),rate:Object(d.maybeToOptional)(e.rate)}:"SearchPatternTagCustomField"===e.__typename?{kind:"customFieldTag",key:e.fieldKey,fieldKey:e.fieldKey,comparator:e.comparator,value:e.value}:"SearchPatternTagGeolocation"===e.__typename?{kind:"geolocationTag",place:{label:e.place.label,location:e.place.location?{latitude:e.place.location.latitude,longitude:e.place.location.longitude}:null}}:"SearchPatternTagGroup"===e.__typename?{kind:"groupTag",id:e.id,name:e.name}:"SearchPatternTagJob"===e.__typename?{kind:"jobTag",id:e.id,name:e.name}:void 0}))),headCount:a,assignedHeadCount:c,allocationRates:{total:e.allocationRates.total,totalRequiredManDays:Object(v.getRoundedToTwoDecimalsOrZero)(e.allocationRates.totalRequiredManDays),byPeriod:[]},skills:(n=e.resourceSearchPattern,[].concat(Object(h.a)(g((null===n||void 0===n?void 0:n.must)||[])),Object(h.a)(g((null===n||void 0===n?void 0:n.should)||[])))),resourceSearchPattern:e.resourceSearchPattern}}))}),[A]),ie=Object(s.useMemo)((function(){if(oe.length>0)return oe.find((function(e){return e.id===_}))}),[oe,_]);Object(s.useEffect)((function(){"undefined"!==typeof ie&&z({type:"openSearchProfileModal"})}),[ie]);var le=function(){var e=Object(c.a)(a.a.mark((function e(t){var n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n={name:t.name,projectId:t.projectId,customFields:t.customFields,scheduledPeriods:t.scheduledPeriods.map((function(e){return Object(l.a)(Object(l.a)({},e),{},{startDate:e.startDate?Object(j.localeMoment)(e.startDate).toISOString():void 0,endDate:e.endDate?Object(j.localeMoment)(e.endDate).toISOString():void 0})}))},t.description&&(n.description=t.description),q({variables:n,onCompleted:function(e){var n,r=null===(n=e.createProjectNeed)||void 0===n?void 0:n.projectNeed;r&&(z({type:"setNewProjectNeedDetails",newProjectNeedName:t.name,newProjectNeedDescription:t.description||"",newProjectNeedId:r.id,newProjectNeedSearchPattern:r.rawResourceSearchPattern}),R.success(L("success")),Z())},onError:function(e){console.error("Need creation failed !!!",e),R.error(D(e))}});case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),se=function(){var e=Object(c.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t||"undefined"===typeof _){e.next=3;break}return e.next=3,W({variables:{id:_,resourceSearchPattern:Object(l.a)({},t)},update:function(){Z({id:n})}}).then((function(){R.success(L("success")),z({type:"reset"})})).catch((function(e){console.error("Failed to update need !!",e),R.error(D(e))}));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(y.jsxs)(b.PageLayout,Object(l.a)(Object(l.a)({display:"flex",p:"0px"},r),{},{children:[Object(y.jsxs)(S.Provider,{value:{project:ce},children:[Object(y.jsx)(p.Box,{overflow:"auto",height:"100%",children:Object(y.jsx)(x.c,{capabilities:(null===ce||void 0===ce?void 0:ce.capabilities)||{canUpdate:!1,canDelete:!1,canCreateNeed:!1}})}),Object(y.jsxs)(p.Box,{px:3,pt:2,flex:1,display:"flex",flexDirection:"column",children:[Object(y.jsx)(p.Text,{fontSize:20,fontWeight:"bold",mb:1,children:L("staffing_project_needs_list_title")}),B||"undefined"===typeof oe?Object(y.jsx)(p.Loader,{}):Object(y.jsxs)(p.Column,{height:"100%",width:"100%",children:[Object(y.jsx)(b.TableToolbox,{totalCount:oe.length,isLoading:B,quickFilters:[],menuActions:[],primaryAction:(null===ce||void 0===ce||null===(t=ce.capabilities)||void 0===t?void 0:t.canCreateNeed)?{title:Object(u.maj)(L("add_a_something",{object:L("a_staffing_project_need")})),onClick:function(){z({type:"openProjectNeedModal"})}}:void 0}),Object(y.jsx)(x.b,{projectNeeds:oe,onClickProjectNeed:function(e){$(e)}})]})]})]}),"undefined"!==typeof(null===ce||void 0===ce?void 0:ce.id)&&Object(y.jsx)(f.a,{isOpened:V,onClose:function(){return z({type:"closeProjectNeedModal"})},initialProjectId:ce.id,minStartDate:ce.startDate,maxEndDate:ce.endDate,isLoading:X,onSubmit:le}),Object(y.jsx)(m.a,{isOpened:re,onClose:ae,projectNeedId:te,projectAssignmentId:ne,onDeletedProjectNeed:function(){Z(),ae()},onDeletedProjectAssignment:function(){Z(),ae()},onChangeProjectAssignmentId:ee},"".concat(te,"_").concat(ne)),Object(y.jsx)(O.a,{initialPattern:T,isOpened:E,onClose:function(){return z({type:"reset"})},onSubmit:se,cancelButtonLabel:L("not_now"),projectNeedForSuggestions:{name:k,description:N,project:{name:(null===ce||void 0===ce?void 0:ce.name)||"",description:void 0}}},"searchProfileModal_".concat(_))]}))}},1147:function(e,t,n){"use strict";n.d(t,"c",(function(){return Y})),n.d(t,"b",(function(){return te})),n.d(t,"a",(function(){return Q}));var r,a=n(17),c=n(187),o=n(139),i=n.n(o),l=n(286),s=n(53),d=n(285),u=n(0),j=n(15),p=n(14),b=n(23),f=n(19),O=n(877),m=n(96),h=n(850),v=n(804),g=["title","titleId"];function x(){return(x=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function y(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},c=Object.keys(e);for(r=0;r<c.length;r++)n=c[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(r=0;r<c.length;r++)n=c[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function w(e,t){var n=e.title,a=e.titleId,c=y(e,g);return u.createElement("svg",x({id:"Icon",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",x:"0px",y:"0px",viewBox:"0 0 24 24",style:{enableBackground:"new 0 0 24 24"},xmlSpace:"preserve",ref:t,"aria-labelledby":a},c),n?u.createElement("title",{id:a},n):null,r||(r=u.createElement("g",null,u.createElement("path",{d:"M21.4,11.1L21.4,11.1c-0.1-0.7-0.6-1.1-1.4-1.6c0-0.1,0.1-0.2,0.1-0.3l0,0V6.8l0,0c-0.1-2.2-4.4-3.3-8.5-3.3 S3.2,4.6,3.1,6.8v0.1V9v0.1l0,0c0,0.2,0.1,0.5,0.2,0.7c0.2,0.3,0.6,0.7,1,1v1l0,0v1c-1,0.6-1.8,1.3-1.9,2.1l0,0v2.3l0,0 C2.6,18,3,18.5,3.7,18.9c0.3,0.2,0.7,0.5,1.2,0.6c2,0.7,4.1,1,6.3,1c3.6,0,7.3-0.9,8.3-2.6c0.1-0.2,0.2-0.5,0.2-0.7l0,0v-0.1v-2 c0.3-0.1,0.5-0.2,0.8-0.5c0.5-0.3,0.9-0.9,1-1.5l0,0L21.4,11.1z M4,7.1c0-1,2.9-2.5,7.7-2.5l0,0c4.7,0,7.7,1.5,7.7,2.5 s-2.9,2.5-7.7,2.5h-0.9C6.5,9.4,4,8.1,4,7.1z M12.1,17.7h-0.9c-4.7,0-7.7-1.5-7.7-2.5c0-0.3,0.4-0.8,1.2-1.3c0,0.1,0.1,0.3,0.2,0.5 c1,1.5,4.8,2.2,8.3,2.1c1.9,0,3.8-0.3,5.6-0.9C18.1,16.5,15.7,17.5,12.1,17.7z M13,13.8h-0.9c-4.2,0-6.7-1.1-6.8-2.1l0,0v-0.5 c1.7,0.7,4.1,1.1,6.4,1.1c2.1,0,4.2-0.3,6.3-1c0.4-0.1,0.7-0.3,1.2-0.6c0.2-0.1,0.4-0.3,0.6-0.6c0.6,0.3,0.9,0.7,0.9,1 C20.7,12.2,17.8,13.7,13,13.8z"}),u.createElement("path",{d:"M14,6.6V6.5c0-0.3-0.2-0.6-0.5-0.8c-0.3-0.2-0.7-0.3-1.1-0.3V4.9h-0.9v0.5c-0.5,0-0.9,0.1-1.2,0.3 C9.9,5.8,9.7,6,9.7,6.3c0,0.2,0.1,0.3,0.2,0.4C10,6.9,10.1,7,10.3,7.1c0.2,0.1,0.4,0.1,0.6,0.2c0.2,0.1,0.5,0.1,0.8,0.2 c0.3,0.1,0.5,0.1,0.6,0.2c0.1,0.1,0.1,0.1,0.1,0.2c0,0,0,0.1-0.1,0.2C12.2,8,12,8,11.8,8c-0.3,0-0.5,0-0.6-0.1 C11,7.8,11,7.7,11,7.6V7.5H9.5v0.1C9.5,8,9.7,8.2,10,8.4c0.3,0.2,0.7,0.3,1.3,0.3v0.4h0.9V8.7c0.5,0,0.9-0.1,1.2-0.3 C13.8,8.3,14,8.1,14,7.8c0-0.2,0-0.3-0.1-0.4c-0.1-0.1-0.2-0.2-0.4-0.3h0c-0.2-0.1-0.4-0.2-0.6-0.2c-0.2-0.1-0.5-0.1-0.8-0.2 c-0.3-0.1-0.6-0.1-0.7-0.2c-0.1-0.1-0.1-0.1-0.1-0.1c0,0,0-0.1,0.1-0.2s0.3-0.1,0.5-0.1s0.4,0,0.5,0.1c0.1,0.1,0.1,0.1,0.1,0.3v0.1 H14z"}))))}var P,C=u.forwardRef(w),S=(n.p,["title","titleId"]);function D(){return(D=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function H(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},c=Object.keys(e);for(r=0;r<c.length;r++)n=c[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(r=0;r<c.length;r++)n=c[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function I(e,t){var n=e.title,r=e.titleId,a=H(e,S);return u.createElement("svg",D({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1000 1000",ref:t,"aria-labelledby":r},a),n?u.createElement("title",{id:r},n):null,P||(P=u.createElement("path",{d:"M304.979.004c-28.634.367-32.408 23.148-32.408 23.148l1.148 98.38H130.202s-32.23 6.029-49.767 28.935c-17.537 22.905-18.518 48.61-18.518 48.61v82.176H936.913v-82.175s0-25.706-17.36-48.611c-17.544-22.906-50.925-28.933-50.925-28.935H726.266v-98.38S722.492.371 693.858.004c-28.644-.37-26.622 23.148-26.622 23.148l-1.148 99.537-166.666-1.157-165.51 1.157-1.148-99.537S333.615-.364 304.986.004zm27.777 149.305c18.445 10.026 31.252 30.016 31.252 52.083 0 32.417-26.978 57.87-60.185 57.87-33.21 0-60.185-25.453-60.185-57.87 0-21.382 11.43-40.664 28.933-50.925l-1.148 48.61s7.182 20.117 30.089 20.834c22.907.71 30.096-20.833 30.096-20.833l1.148-49.769zm333.332 0l2.296 49.769s7.186 21.543 30.093 20.833c22.907-.717 30.092-20.833 30.092-20.833l-2.296-48.611c17.504 10.261 30.092 29.543 30.092 50.925 0 32.417-26.977 57.87-60.184 57.87-33.208 0-60.185-25.453-60.185-57.87 0-22.067 11.651-42.057 30.092-52.083zM59.61 320.605V1000h880.782V320.605H59.609zm64.815 62.5h158.562v160.878H124.424V383.105zm201.388 1.157h157.407v158.564H325.812V384.262zm402.776 0h157.407v159.721H728.588V384.262zm-203.703 2.315h157.407V545.14H524.885V386.577zm0 194.443h157.407v158.564H524.885V581.02zm201.388 0H883.68v158.564H726.273V581.02zm-400.461 1.158h157.407v158.564H325.812V582.178zm-201.388 1.157H281.83v159.722H124.424V583.335zm-2.297 199.073h157.407V942.13H122.127V782.408zm200.233 0h158.562V942.13H322.36V782.408zm201.384 0h157.407V942.13H523.744V782.408zm200.233 0h157.406V942.13H723.977V782.408z"})))}var M=u.forwardRef(I),V=(n.p,n(890)),E=n(63),N=n(10),_=n(3),k=n(1156),T=n(1157),z=n(288),L=n(1151),R=n(1),F=["managers","canChange","onChange"],A=function(e){var t=e.managers,n=e.canChange,r=e.onChange,c=Object(d.a)(e,F),o=Object(p.useTranslate)(),i=Object(p.useSwitch)(),l=i.active,s=i.on,u=i.off,j=new Set;t.forEach((function(e){j.add(e.id)}));return Object(R.jsx)(p.Popover,{isOpened:l,onClose:u,content:Object(R.jsx)(p.Card,{py:1,mx:1,boxShadow:"small",bg:"white",overflow:"auto",maxHeight:"100vh",children:Object(R.jsxs)(p.Box,{justifyContent:"center",p:1,children:[t.map((function(e){return Object(R.jsxs)(p.Line,{justifyContent:"space-between",p:1,children:[Object(R.jsxs)(p.Line,{children:[Object(R.jsx)(E.UserAvatar,{user:e,size:"tiny",mr:0,ml:1}),Object(R.jsx)(p.Text,{fontWeight:"semiBold",fontSize:12,p:0,children:Object(b.maj)(e.displayName)})]}),Object(R.jsx)(p.IconButton,{iconSize:20,size:20,iconAs:z.a,onClick:function(){return t=e.id,j.delete(t),u(),void r(Array.from(j));var t},accent:"black"})]},e.id)})),Object(R.jsx)(L.a,{onSelect:function(e){return t=e,j.add(t),u(),void r(Array.from(j));var t}})]})}),children:Object(R.jsxs)(p.Box,Object(a.a)(Object(a.a)({},c),{},{children:[t.map((function(e){return Object(R.jsxs)(p.Line,{children:[Object(R.jsx)(E.UserAvatar,{user:e,size:"tiny",mr:0}),Object(R.jsx)(p.Text,{fontWeight:"semiBold",fontSize:12,p:0,children:Object(b.maj)(e.displayName)})]},e.id)})),!0===n?Object(R.jsx)(p.Button,{my:1,accent:"primary",appearance:"outline",onClick:s,children:o("modify")}):null]}))})},B=n(766),Z=n(1009),U=["content","icon","children"],W=function(e){var t=e.content,n=e.icon,r=e.children,c=Object(d.a)(e,U);return Object(R.jsx)(p.Label,Object(a.a)(Object(a.a)({content:Object(R.jsxs)(R.Fragment,{children:[n&&Object(R.jsx)(p.Icon,{size:18,as:n,mr:1}),t]}),mb:3},c),{},{children:r}))},G=n(749),K=["onDeleteProject"],q=function(e){var t=e.onDeleteProject,n=Object(d.a)(e,K),r=Object(p.useSwitch)(),c=r.active,o=r.on,i=r.off,l=Object(p.useTranslate)();return Object(R.jsxs)(p.MenuSelect.Target,{children:[Object(R.jsx)(p.IconButton,Object(a.a)(Object(a.a)({iconAs:G.a,onClick:o},n),{},{isActive:c})),Object(R.jsx)(p.MenuSelect,{onClose:i,isOpened:c,children:Object(R.jsx)(p.MenuOption,{onClick:function(){i(),t()},children:l("delete_staffing_projet")})})]})},J=["value","isCreation","onChange","readOnly"],Q=function(e){var t=e.value,n=e.isCreation,r=e.onChange,c=e.readOnly,o=Object(d.a)(e,J),i=function(e){r({value:Number(e),unit:"\u20ac"})};return n?Object(R.jsx)(p.Input,Object(a.a)({name:"projectBudget",onChange:i,value:null===t||void 0===t?void 0:t.value,type:"number",min:0,readOnly:c},o)):Object(R.jsx)(p.InputEditable,Object(a.a)({name:"projectBudget",onSubmit:i,value:null===t||void 0===t?void 0:t.value,type:"number",min:0,readOnly:c},o))},X=["capabilities"],Y=function(e){var t,n,r,o,g,x=e.capabilities,y=Object(d.a)(e,X),w=Object(N.useAppContext)(),P=w.getErrorMessage,S=w.customFields,D=Object(p.useSwitch)(!1),H=Object(p.useTranslate)({capitalize:!0}),I=Object(j.useHistory)(),z=Object(p.useAlert)(),L=x.canUpdate,F=x.canDelete,U=Object(u.useContext)(Z.a).project,G=Object(f.useGetProjectDetailsLazyQuery)(),K=Object(s.a)(G,2),J=K[0],Y=K[1],$=Y.data,ee=Y.loading;Object(u.useEffect)((function(){(null===U||void 0===U?void 0:U.id)&&J({variables:{id:U.id}})}),[U]);var te=Object(f.useUpdateProjectMutation)({refetchQueries:["getCustomers"]}),ne=Object(s.a)(te,1)[0],re=Object(f.useDeleteProjectMutation)(),ae=Object(s.a)(re,2),ce=ae[0],oe=ae[1].loading,ie=Object(u.useMemo)((function(){var e;return((null===$||void 0===$||null===(e=$.project)||void 0===e?void 0:e.managers.nodes)||[]).map((function(e){return Object(f.getFormatedUserBasicFragment)(e)}))}),[$]),le=function(){z.success(H("success"))},se=function(e){z.error(P(e))},de=function(){var e=Object(l.a)(i.a.mark((function e(t){var n,r,a,c,o,l,s=arguments;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.startDate,c=t.endDate,o=s.length>1&&void 0!==s[1]?s[1]:{ignoreAlerts:!1},l=o.ignoreAlerts,a===(null===$||void 0===$||null===(n=$.project)||void 0===n?void 0:n.startDate)&&c===(null===$||void 0===$||null===(r=$.project)||void 0===r?void 0:r.endDate)){e.next=5;break}return e.next=5,be({startDate:a,endDate:c}).then((function(){l||le()})).catch((function(e){console.error("ERROR: Dates not updated !!",e),l||se(e)}));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ue=function(){var e=Object(l.a)(i.a.mark((function e(t){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.groups,e.next=3,pe("groupsIds")(n);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),je=function(){var e=Object(l.a)(i.a.mark((function e(t){var n,r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.status,r=t.probability,e.next=3,be({status:n,probability:Number(r)}).then((function(){le()})).catch((function(e){se(e)}));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),pe=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{ignoreAlerts:!1},n=t.ignoreAlerts;return function(){var t=Object(l.a)(i.a.mark((function t(r){return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,be(Object(c.a)({},e,r)).then((function(){n||le()})).catch((function(e){n||se(e)}));case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},be=function(){var e=Object(l.a)(i.a.mark((function e(t){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(null===U||void 0===U?void 0:U.id)){e.next=4;break}return e.next=3,ne({variables:{input:Object(a.a)({id:U.id},t)}});case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),fe=function(){var e=Object(l.a)(i.a.mark((function e(t){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:pe("place")(t||null);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Oe=function(){var e=Object(l.a)(i.a.mark((function e(t){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(null===t||void 0===t?void 0:t.length)>0&&pe("color")(t);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),me=function(){var e=Object(l.a)(i.a.mark((function e(t){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Array.isArray(t)&&pe("managers")(t);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(R.jsxs)(R.Fragment,{children:[Object(R.jsx)(p.Box,Object(a.a)(Object(a.a)({height:"100%",width:350,p:2,overflowX:"hidden"},y),{},{children:ee||"undefined"===typeof U||!(null===$||void 0===$?void 0:$.project)?Object(R.jsx)(p.Box,{"data-testid":"loader",children:Object(R.jsx)(p.Loader,{})}):Object(R.jsxs)(R.Fragment,{children:[Object(R.jsxs)(p.Line,{display:"flex",justifyContent:"space-between",mb:3,children:[Object(R.jsx)(p.Text,{fontSize:"big",fontWeight:"bold",children:Object(b.maj)($.project.name||"")}),F&&Object(R.jsx)(q,{onDeleteProject:function(){D.on()}})]}),Object(R.jsx)(p.Label,{content:H("title"),name:"title",mb:3,children:Object(R.jsx)(p.InputEditable,{value:Object(b.maj)($.project.name||""),onSubmit:pe("name"),readOnly:!L,width:"100%"})}),Object(R.jsx)(p.Text,{mb:2,fontWeight:"bold",color:"black.1",children:H("project_color")}),Object(R.jsx)(p.ColorPicker,{isCustomColor:!0,currentColor:$.project.color,onChangeColor:Oe,readOnly:!L}),Object(R.jsx)(T.a,{value:{status:Object(f.maybeToOptional)($.project.status),probability:Object(f.maybeToOptional)($.project.probability)},onChange:je,mb:3,readOnly:!L}),Object(R.jsx)(W,{content:H("description"),icon:O.a,mb:2,children:L?Object(R.jsx)(p.WysiwygEditable,{name:"projectDescription",onChange:function(){},onSubmit:pe("description",{ignoreAlerts:!0}),editorStyle:{height:"150px"},value:Object(b.maj)($.project.description||""),width:"100%"}):Object(R.jsx)(p.StringParser,{children:Object(b.maj)($.project.description||"")})}),Object(R.jsx)(W,{content:H("client"),icon:m.a,children:L?Object(R.jsx)(k.a,{value:$.project.customer||"",onSubmit:function(e){var t=e.trim();t.length>0&&be({customer:t}).then((function(){le()})).catch((function(e){se(e)}))},isEditable:!0,width:"100%"}):Object(R.jsx)(p.Text,{mt:1,children:$.project.customer||""})}),Object(R.jsx)(W,{content:H("entity"),icon:h.a,children:L?Object(R.jsx)(E.GroupSelector,{appearance:"outline",hideSelection:!1,onSubmit:ue,initiallySelectedGroups:null===(t=$.project.groups)||void 0===t||null===(n=t.nodes)||void 0===n?void 0:n.map((function(e){return null===e||void 0===e?void 0:e.id})),children:H("edit")}):Object(R.jsx)(p.LimitedTextList,{list:((null===(r=$.project.groups)||void 0===r?void 0:r.nodes)||[]).map((function(e){return e.name})),maxElements:2,my:2})}),Object(R.jsx)(W,{content:H("project_managers"),icon:V.a,children:Object(R.jsx)(A,{mt:2,managers:ie,canChange:L,onChange:function(e){me(e)}})}),Object(R.jsx)(W,{content:H("location"),icon:v.a,children:L?Object(R.jsx)(E.SearchLocation,{initialValue:null===(o=$.project.place)||void 0===o?void 0:o.label,onUpdateLocation:fe,width:"100%"}):Object(R.jsx)(p.Text,{mt:1,children:null===(g=$.project.place)||void 0===g?void 0:g.label})}),Object(R.jsx)(W,{content:H("dates"),icon:M,children:Object(R.jsx)(p.PeriodPicker,{onChange:de,startDate:new Date($.project.startDate).toISOString(),endDate:new Date($.project.endDate).toISOString(),readOnly:!L,mt:L?1:void 0})}),Object(R.jsx)(W,{content:H("externalId"),children:Object(R.jsx)(p.InputEditable,{value:$.project.externalId||"",onSubmit:pe("externalId"),readOnly:!L,width:"100%"})}),Object(R.jsx)(W,{content:H("budget"),icon:C,children:Object(R.jsx)(Q,{value:$.project.budget,onChange:pe("budget"),readOnly:!L,width:"100%"})}),S.projectFields.length>0&&Object(R.jsx)(B.a,{customFieldsConfiguration:S.projectFields,value:null===U||void 0===U?void 0:U.customFields,onChange:pe("customFields"),width:"100%"})]})})),Object(R.jsx)(p.ConfirmModal,{isOpened:D.active,onConfirm:function(){(null===U||void 0===U?void 0:U.id)&&ce({variables:{id:U.id}}).then((function(){return I.push(_.b.STAFFING_PROJECTS.getRoute()),z.success(H("success"))})).catch((function(e){return D.off(),z.error(P(e))}))},onCancel:D.off,isLoading:oe,children:Object(R.jsx)(p.Text,{children:H("delete_staffing_project_msg")})})]})},$=n(45),ee=["projectNeeds","onClickProjectNeed"],te=function(e){var t=e.projectNeeds,n=e.onClickProjectNeed,r=(Object(d.a)(e,ee),Object(p.useTranslate)({capitalize:!0}));return Object(R.jsx)(N.TableContent,{rows:t,columns:[{dataKey:"name",headerTitle:r("staffing_project_need_title"),isSortable:!1,cellRenderer:function(e){var t=e.node;return Object(R.jsx)(N.ShortTextCell,{fontWeight:"bold",isClickable:!0,text:t.name,size:"large",onClick:function(){return n(t.id)}})},columnWidth:Object($.b)("large")},{dataKey:"search_profile",headerTitle:r("search_profile"),isSortable:!1,cellRenderer:function(e){var t=e.node;return Object(R.jsx)(N.ObjectTagsCell,{tags:t.resourceSearchPatternTags,size:"large"})},columnWidth:Object($.b)("large")},{dataKey:"assignedUsers",headerTitle:r("team_members_title"),isSortable:!1,cellRenderer:function(e){var t=e.node;return Object(R.jsx)(N.MultipleUsersCell,{users:t.assignedUsers,size:"large"})},columnWidth:Object($.b)("large")},{dataKey:"assignmentRate",headerTitle:r("allocation_rate"),isSortable:!1,cellRenderer:function(e){var t=e.node;return Object(R.jsx)(N.ProgressionStatusCell,{actualValue:t.allocationRates.total,attendedValue:100,isPercent:!0,size:"xtraSmall"})},columnWidth:Object($.b)("xtraSmall")},{dataKey:"total_rate_man_day",headerTitle:r("total_rate_man_day"),isSortable:!1,cellRenderer:function(e){var t=e.node;return Object(R.jsx)(N.NumberDisplayCell,{number:t.allocationRates.totalRequiredManDays,size:"small"})},columnWidth:Object($.b)("small")},{dataKey:"startDate",headerTitle:r("start_date"),isSortable:!1,cellRenderer:function(e){var t=e.node;return Object(R.jsx)(N.DateCell,{date:t.startDate,size:"small"})},columnWidth:Object($.b)("small")},{dataKey:"endDate",headerTitle:r("end_date"),isSortable:!1,cellRenderer:function(e){var t=e.node;return Object(R.jsx)(N.DateCell,{date:t.endDate,size:"small"})},columnWidth:Object($.b)("small")}],isLoading:!1,totalRowCount:t.length,noRowsRenderer:function(){return Object(R.jsx)(p.Text,{children:r("no_staffing_project_need")})}})}},1156:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(17),a=n(285),c=(n(0),n(14)),o=n(19),i=n(1),l=["value","onSubmit","isEditable","zIndex"],s=function(e){var t=e.value,n=e.onSubmit,s=e.isEditable,d=void 0!==s&&s,u=e.zIndex,j=Object(a.a)(e,l),p=Object(o.useGetProjectCustomersQuery)().data,b=((null===p||void 0===p?void 0:p.projectsCustomers)||[]).map((function(e){return null===e||void 0===e?void 0:e.name}));return d?Object(i.jsx)(c.AutoCompleteEditable,Object(r.a)({onChange:function(){},placeholder:"",value:t||"",source:b,submit:n,zIndex:u},j)):Object(i.jsx)(c.AutoComplete,Object(r.a)({placeholder:"",value:t||"",source:b,onChange:n,zIndex:u},j))}},1157:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(17),a=n(53),c=n(285),o=n(0),i=n(32),l=n(14),s=n(1),d=["value","onChange","zIndex","readOnly"],u=function(e){var t=e.value,n=t.status,u=t.probability,j=e.onChange,p=e.zIndex,b=e.readOnly,f=void 0!==b&&b,O=Object(c.a)(e,d),m=Object(l.useTranslate)(),h=Object(o.useState)(u),v=Object(a.a)(h,2),g=v[0],x=v[1];return Object(s.jsxs)(l.Line,Object(r.a)(Object(r.a)({justifyContent:"space-between"},O),{},{children:[Object(s.jsx)(l.Label,{content:m("status"),width:"66%",children:Object(s.jsx)(l.SelectField,{value:n,onChange:function(e){j({status:e,probability:u})},source:[{label:m("past"),value:i.ProjectStatus.PAST},{label:m("ongoing"),value:i.ProjectStatus.ONGOING},{label:m("upcoming"),value:i.ProjectStatus.UPCOMING}],placeholder:m("add_status"),width:"100%",zIndex:p,readOnly:f})}),n===i.ProjectStatus.UPCOMING&&Object(s.jsx)(l.Label,{width:"32%",content:m("probability"),children:Object(s.jsxs)(l.Line,{children:[Object(s.jsx)(l.Input,{name:"probability",width:"100%",value:g,onChange:function(e){return x(parseInt(e||"100"))},onBlur:function(){j({status:n,probability:g||0})},type:"number",min:0,max:100,mr:0,readOnly:f}),Object(s.jsx)(l.Text,{children:"%"})]})})]}))}},795:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r,a=n(0),c=["title","titleId"];function o(){return(o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function i(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},c=Object.keys(e);for(r=0;r<c.length;r++)n=c[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(r=0;r<c.length;r++)n=c[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function l(e,t){var n=e.title,l=e.titleId,s=i(e,c);return a.createElement("svg",o({viewBox:"0 0 10 16",xmlns:"http://www.w3.org/2000/svg",ref:t,"aria-labelledby":l},s),n?a.createElement("title",{id:l},n):null,r||(r=a.createElement("path",{d:"M2.16667 0L0 2.27368L5.66667 8L0 13.7263L2.16667 16L10 8L2.16667 0Z"})))}var s=a.forwardRef(l);n.p},799:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));n(0);var r=n(14),a=n(1),c=function(e){var t=e.renderHeader,n=e.children;return Object(a.jsxs)(r.Box,{width:"100%",height:"100%",bg:"white",display:"flex",flexDirection:"column",backgroundColor:"white",children:[Object(a.jsx)(r.Box,{flexGrow:0,p:2,children:t()}),Object(a.jsx)(r.Box,{px:2,children:Object(a.jsx)(r.Separator,{width:"100%"})}),Object(a.jsx)(r.Box,{flexGrow:1,overflow:"auto",p:2,width:"100%",children:n})]})}},804:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r,a,c=n(0),o=["title","titleId"];function i(){return(i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function l(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},c=Object.keys(e);for(r=0;r<c.length;r++)n=c[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(r=0;r<c.length;r++)n=c[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function s(e,t){var n=e.title,s=e.titleId,d=l(e,o);return c.createElement("svg",i({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1000 1000",ref:t,"aria-labelledby":s},d),n?c.createElement("title",{id:s},n):null,r||(r=c.createElement("path",{d:"M500 105.5c128.7 0 241.6 105.4 241.6 225.6 0 121.9-96.2 280.4-232.8 495.9-4.1 6.5-13.6 6.5-17.7 0-136.6-215.5-232.8-374-232.8-495.9.1-120.1 113-225.6 241.7-225.6m0-80.5c-169.1 0-322.2 137-322.2 306.1 0 164.1 131.6 359.1 306.2 635.1 7.4 11.7 24.5 11.7 31.9 0 174.6-276 306.2-471 306.2-635.1C822.2 162 669.1 25 500 25z"})),a||(a=c.createElement("path",{d:"M500 480.2c-77.4 0-140.3-62.9-140.3-140.3S422.6 199.6 500 199.6s140.3 62.9 140.3 140.3S577.4 480.2 500 480.2zm0-225.6c-47 0-85.3 38.3-85.3 85.3s38.3 85.3 85.3 85.3 85.3-38.3 85.3-85.3-38.3-85.3-85.3-85.3z"})))}var d=c.forwardRef(s);n.p},850:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r,a=n(0),c=["title","titleId"];function o(){return(o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function i(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},c=Object.keys(e);for(r=0;r<c.length;r++)n=c[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(r=0;r<c.length;r++)n=c[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function l(e,t){var n=e.title,l=e.titleId,s=i(e,c);return a.createElement("svg",o({viewBox:"0 0 23 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",ref:t,"aria-labelledby":l},s),n?a.createElement("title",{id:l},n):null,r||(r=a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M5 7V0H18V10H23V24H0V7H5ZM5 23V18H4V23H5ZM13 19H10V23H13V19ZM19 18H18V23H19V18ZM21 12H18V17H20V22H21V12ZM16 2H7V22H8V17H15V22H16V2ZM3 22V17H5V9H2V22H3ZM11 15H9V13H11V15ZM14 15H12V13H14V15ZM11 12H9V10H11V12ZM14 12H12V10H14V12ZM11 9H9V7H11V9ZM14 9H12V7H14V9ZM11 6H9V4H11V6ZM14 6H12V4H14V6Z"})))}var s=a.forwardRef(l);n.p},877:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r,a=n(0),c=["title","titleId"];function o(){return(o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function i(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},c=Object.keys(e);for(r=0;r<c.length;r++)n=c[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(r=0;r<c.length;r++)n=c[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function l(e,t){var n=e.title,l=e.titleId,s=i(e,c);return a.createElement("svg",o({id:"Icon",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",x:"0px",y:"0px",viewBox:"0 0 24 24",style:{enableBackground:"new 0 0 24 24"},xmlSpace:"preserve",ref:t,"aria-labelledby":l},s),n?a.createElement("title",{id:l},n):null,r||(r=a.createElement("g",null,a.createElement("path",{d:"M19.8,5.4H4.2C3.6,5.4,3,4.8,3,4.2S3.6,3,4.2,3h15.6C20.4,3,21,3.6,21,4.2S20.4,5.4,19.8,5.4z"}),a.createElement("g",null,a.createElement("path",{d:"M19.8,10.6H4.2C3.6,10.6,3,10.1,3,9.4c0-0.6,0.6-1.2,1.2-1.2h15.6c0.6,0,1.2,0.6,1.2,1.2 C21,10.1,20.4,10.6,19.8,10.6z"}),a.createElement("path",{d:"M19.8,15.9H4.2c-0.6,0-1.2-0.6-1.2-1.2s0.6-1.2,1.2-1.2h15.6c0.6,0,1.2,0.6,1.2,1.2S20.4,15.9,19.8,15.9z"})),a.createElement("path",{d:"M12.1,21H4.2C3.6,21,3,20.4,3,19.8c0-0.6,0.6-1.2,1.2-1.2h7.9c0.6,0,1.2,0.6,1.2,1.2 C13.3,20.4,12.7,21,12.1,21z"}))))}var s=a.forwardRef(l);n.p},890:function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));var r,a,c,o,i,l,s=n(0),d=["title","titleId"];function u(){return(u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function j(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},c=Object.keys(e);for(r=0;r<c.length;r++)n=c[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(r=0;r<c.length;r++)n=c[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function p(e,t){var n=e.title,p=e.titleId,b=j(e,d);return s.createElement("svg",u({viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg",ref:t,"aria-labelledby":p},b),n?s.createElement("title",{id:p},n):null,r||(r=s.createElement("path",{d:"M8.33789 9.72412L9.3682 11.2541H10.5119L11.4906 9.72412H8.33789Z"})),a||(a=s.createElement("path",{d:"M11.4808 14.3228L10.7596 11.8828H9.08015L8.34863 14.3228H11.4808Z"})),c||(c=s.createElement("path",{d:"M12.0263 7.85442C16.0961 6.00509 14.3136 -0.24262 9.91419 0.00728833C5.53536 -0.192638 3.82504 6.00509 7.78144 7.82443C4.18565 8.10432 2.3826 11.0033 2.59896 14.3121H4.20625C3.63958 7.49455 16.1682 7.58451 15.6118 14.3121H17.2294C17.4252 11.0033 15.6015 8.13431 12.0263 7.85442ZM9.91419 1.57671C13.6233 1.43676 13.5615 7.0847 9.91419 6.90476C6.09173 7.10469 6.16385 1.26683 9.91419 1.57671Z"})),o||(o=s.createElement("path",{d:"M1.5 20H5.44953V16.0015H1.5V20ZM4.28442 17.181V18.8104H2.67499V17.181H4.28442Z"})),i||(i=s.createElement("path",{d:"M7.854 20H11.9753V16.0015H7.854V20ZM10.7595 17.181V18.8104H9.08008V17.181H10.7595Z"})),l||(l=s.createElement("path",{d:"M14.207 20H18.5V16.0015H14.207V20ZM17.2336 17.181V18.8104H15.4842V17.181H17.2336Z"})))}var b=s.forwardRef(p);n.p},996:function(e,t,n){"use strict";var r=n(139),a=n.n(r),c=n(187),o=n(17),i=n(286),l=n(53),s=n(285),d=n(0),u=n(14),j=n(37),p=n(10),b=n(1016),f=n(1e3),O=n(766),m=n(1),h=["isOpened","onClose","initialProjectId","minStartDate","maxEndDate","isProjectNameReadOnly","onSubmit"],v=function(e){return"undefined"!==typeof e?Object(j.localeMoment)(e).toISOString():void 0},g=function(e){var t,n=e.initialProjectId,r=e.minStartDate,a=e.maxEndDate;return{name:"",projectId:n,customFields:{},scheduledPeriods:[(t={startDate:v(r),endDate:v(a)},{rate:100,headCount:1,manDays:void 0,startDate:t.startDate,endDate:t.endDate})],description:"",isDateError:!1}};t.a=function(e){var t=e.isOpened,n=e.onClose,r=e.initialProjectId,j=void 0===r?null:r,v=e.minStartDate,x=e.maxEndDate,y=e.isProjectNameReadOnly,w=void 0===y||y,P=e.onSubmit,C=Object(s.a)(e,h),S=Object(d.useState)(g({initialProjectId:j,minStartDate:v,maxEndDate:x})),D=Object(l.a)(S,2),H=D[0],I=D[1],M=Object(d.useState)(!1),V=Object(l.a)(M,2),E=V[0],N=V[1],_=Object(u.useTranslate)({capitalize:!0}),k=Object(p.useAppContext)().customFields,T=Object(d.useMemo)((function(){return H.isDateError||0===H.name.trim().length||H.scheduledPeriods.some((function(e){return"undefined"===typeof e.startDate||"undefined"===typeof e.endDate}))}),[H,x]),z=function(e){return function(){var t=Object(i.a)(a.a.mark((function t(n){return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:I(Object(o.a)(Object(o.a)({},H),{},Object(c.a)({},e,n)));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},L=function(){I(g({initialProjectId:j,minStartDate:v,maxEndDate:x}))},R=function(){var e=Object(i.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==H.projectId){e.next=2;break}return e.abrupt("return");case 2:return N(!0),e.next=5,P({name:H.name,projectId:H.projectId,description:H.description,customFields:H.customFields,scheduledPeriods:H.scheduledPeriods.map((function(e){return{startDate:e.startDate,endDate:e.endDate,headCount:e.headCount,rate:e.rate}}))}).catch((function(e){return console.error("Error creating project need",e)})).finally((function(){N(!1)}));case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(m.jsxs)(p.FormContainerModal,Object(o.a)(Object(o.a)({isOpened:t,onClose:n,title:_("new_staffing_project_need"),onConfirm:R,onCancel:n,isLoading:E,isDisabledSubmit:T,onClosingComplete:function(){L()},maxHeight:"95vh"},C),{},{children:[Object(m.jsxs)(p.ContainerWithBottomSeparator,{children:[Object(m.jsx)(u.Label,{content:_("staffing_project_need_name"),mb:1,required:!0,children:Object(m.jsx)(u.Input,{width:"100%",value:null===H||void 0===H?void 0:H.name,onChange:z("name"),mb:1})}),Object(m.jsx)(u.Label,{content:_("description"),mb:1,height:"auto",children:Object(m.jsx)(u.TextArea,{value:H.description||"",placeholder:"-",onChange:z("description")})}),Object(m.jsx)(u.Label,{content:_("staffing_project",1),mb:2,children:Object(m.jsx)(b.a,{value:H.projectId,submit:z("projectId"),width:"100%",readOnly:w})}),k.projectNeedFields.length>0&&Object(m.jsx)(O.a,{customFieldsConfiguration:k.projectNeedFields,value:H.customFields,onChange:z("customFields"),mb:1,width:"100%"})]}),Object(m.jsx)(p.FormSectionContainer,{title:_("scheduled_periods_and_number_of_resources"),children:Object(m.jsx)(f.f,{minStartDate:v,maxEndDate:x,initialScheduledPeriods:H.scheduledPeriods,onSubmit:function(e){var t=e.scheduledPeriods;I(Object(o.a)(Object(o.a)({},H),{},{isDateError:!1,scheduledPeriods:t}))},onError:function(){I(Object(o.a)(Object(o.a)({},H),{},{isDateError:!0}))}},H.scheduledPeriods.map((function(e){return"".concat(e.endDate,"_").concat(e.startDate,"_").concat(e.headCount,"_").concat(e.manDays,"_").concat(e.rate)})).join("."))})]}))}}}]);