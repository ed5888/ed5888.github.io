(this["webpackJsonp@elamp/main-app"]=this["webpackJsonp@elamp/main-app"]||[]).push([[52],{1012:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));n(0);var i=n(14),a=n(1),o=function(e){var t=e.children,n=e.infoText,o=e.isLoading,r=e.isOpened,s=e.onCancel,d=e.onConfirm,l=e.title;return Object(a.jsx)(i.ConfirmModal,{isOpened:r,onConfirm:d,onCancel:s,isLoading:o,children:Object(a.jsxs)(i.Box,{display:"flex",flexDirection:"column",children:[Object(a.jsx)(i.Text,{fontSize:"big",fontWeight:"bold",pb:3,children:l}),Object(a.jsx)(i.Text,{pb:3,children:n}),t]})})}},1532:function(e,t,n){"use strict";n.r(t),n.d(t,"TrainingRequestSteps",(function(){return i}));var i,a=n(139),o=n.n(a),r=n(286),s=n(53),d=n(188),l=n(17),c=n(0),u=n(15),b=n(14),j=n(63),O=n(45),m=n(19),p=n(32),g=n(37),f=n(123),v=n(295),h=n(997),x=n(10),C=n(121),T=n(3),S=n(762),y=n(743),_=n(827),I=n(1012),k=n(747),R=n(789),E=n(742),D=n(902),M=n(1);!function(e){e.REQUEST_TYPE_SELECT="requestTypeSelect",e.TRAINING_NAVIGATOR="trainingNavigator"}(i||(i={}));var F={isTrainingModalOpened:!1,isTrainingRequestPopoverOpened:!1,isBulkDeleteConfirmationModalOpened:!1,isStatusUpdateConfirmationModalOpened:!1,trainingRequestStep:i.REQUEST_TYPE_SELECT,initialValues:{userId:"NONE",trainingPinId:"NONE",status:void 0,budgetYear:void 0,deadline:void 0,startDate:void 0,endDate:void 0,comment:void 0,trainingId:void 0,customFields:void 0},capabilities:{canUpdate:!0,canDelete:!0,allowedStatuses:[]},comment:void 0,trainingTag:{kind:"trainingTag",id:"NONE",name:"NONE"}},A=function(e,t){switch(t.type){case"openTrainingRequestPopover":return Object(l.a)(Object(l.a)({},e),{},{isTrainingRequestPopoverOpened:!0,trainingRequestStep:i.REQUEST_TYPE_SELECT});case"closeStatusUpdateConfirmationModal":return Object(l.a)(Object(l.a)({},e),{},{isStatusUpdateConfirmationModalOpened:!1,updatedStatus:void 0});case"closeTrainingRequestPopover":return Object(l.a)(Object(l.a)({},e),{},{isTrainingRequestPopoverOpened:!1});case"openTrainingNavigator":return Object(l.a)(Object(l.a)({},e),{},{isTrainingRequestPopoverOpened:!0,trainingRequestStep:i.TRAINING_NAVIGATOR});case"setComment":return Object(l.a)(Object(l.a)({},e),{},{comment:t.comment.trim().length>0?t.comment:void 0});case"setUpdatedStatus":return Object(l.a)(Object(l.a)({},e),{},{isStatusUpdateConfirmationModalOpened:"undefined"!==typeof t.updatedStatus,updatedStatus:t.updatedStatus});case"setDataForPinTrainingCreationAndOpenModal":return Object(l.a)(Object(l.a)({},e),{},{isTrainingRequestPopoverOpened:!1,isTrainingModalOpened:!0,trainingTag:t.trainingTag});case"setDataForPinTrainingUpdateAndOpenModal":return Object(l.a)(Object(l.a)({},e),{},{isTrainingModalOpened:!0,trainingTag:t.trainingTag,initialValues:t.initialValues,capabilities:t.capabilities});case"toggleIsBulkDeleteConfirmationModalOpened":return Object(l.a)(Object(l.a)({},e),{},{isBulkDeleteConfirmationModalOpened:!e.isBulkDeleteConfirmationModalOpened});case"reset":return F}},P=function(e){var t,n=null===e||void 0===e||null===(t=e.pinnedTrainings)||void 0===t?void 0:t.edges;return n?n.map((function(e){var t,n,i,a,o,r,s,c=e.node,u=((null===(t=c.pattern)||void 0===t?void 0:t.must)||[]).map((function(e){return Object(l.a)(Object(l.a)({},Object(m.getFormatedSkillBasicFragment)(e.skill)),{},{kind:"skillTag"})})),b=((null===(n=c.pattern)||void 0===n?void 0:n.should)||[]).map((function(e){return Object(l.a)(Object(l.a)({},Object(m.getFormatedSkillBasicFragment)(e.skill)),{},{kind:"skillTag"})})),j=[].concat(Object(d.a)(u),Object(d.a)(b));return{id:e.id,status:e.status,customFields:e.customFields,updatedAt:e.updatedAt,budgetYear:null===(i=e.data)||void 0===i?void 0:i.budgetYear,deadline:null===(a=e.data)||void 0===a?void 0:a.deadline,startDate:null===(o=e.data)||void 0===o?void 0:o.startDate,endDate:null===(r=e.data)||void 0===r?void 0:r.endDate,comment:null===(s=e.data)||void 0===s?void 0:s.comment,data:e.data,capabilities:{canUpdate:e.capabilities.canUpdate,canDelete:e.capabilities.canDelete,allowedStatuses:e.capabilities.allowedStatuses},training:{id:c.id,name:c.name,status:c.status,skills:j}}})):[]};t.default=function(e){var t=e.tabsOptions,n=Object(b.useTranslate)({capitalize:!0}),a=Object(y.a)().redirectToEntity404,d=Object(b.useAlert)(),l=Object(u.useHistory)(),N=Object(u.useParams)().userId,w=Object(x.useAppContext)(),L=w.checkModule,B=w.customFields,U=w.getErrorMessage,Y=w.setTabsOptions,z=w.user,q=Object(c.useReducer)(A,F),W=Object(s.a)(q,2),G=W[0],K=G.capabilities,V=G.comment,Q=G.initialValues,Z=G.isTrainingRequestPopoverOpened,H=G.isStatusUpdateConfirmationModalOpened,J=G.isBulkDeleteConfirmationModalOpened,X=G.trainingRequestStep,$=G.isTrainingModalOpened,ee=G.trainingTag,te=G.updatedStatus,ne=W[1],ie=Object(m.usePinTrainingMutation)(),ae=Object(s.a)(ie,2),oe=ae[0],re=ae[1].loading,se=Object(m.useGetUserPinnedTrainingsQuery)({variables:{userId:N},onError:function(e){return a({entity:C.d.User,error:e})}}),de=se.data,le=se.loading,ce=se.refetch,ue=se.fetchMore,be=Object(S.c)({}),je=be.close,Oe=be.isOpened,me=be.pinnedTrainingId,pe=be.setUserAndPinnedTrainingId,ge=Object(x.useCheckbox)(),fe=ge.handleCheckbox,ve=ge.isActionModeToolboxActive,he=ge.resetCheckboxState,xe=ge.selectedIds,Ce=ge.setSelectedIds,Te=function(){d.success(n("success")),ne({type:"reset"}),he(),ce()},Se=Object(S.b)({onBulkDeletionCompleted:Te,onBulkStatusUpdateCompleted:Te,onUpdateCompleted:function(){ce()},pinnedTrainingId:me}),ye=Se.isPinTrainingsStatusBulkUpdateLoading,_e=Se.onPinnedTrainingBulkDeletion,Ie=Se.onPinnedTrainingBulkStatusUpdate,ke=Se.onPinnedTrainingUpdate;Object(c.useEffect)((function(){return Y(t),function(){Y(void 0)}}),[]);var Re=Object(c.useMemo)((function(){return Object(O.c)(B.pinnedTrainingFields)}),[B]),Ee=z.id,De=Object(c.useMemo)((function(){var e;return(null===de||void 0===de||null===(e=de.user)||void 0===e?void 0:e.pinnedTrainings)?de.user.pinnedTrainings.totalCount:0}),[de]),Me=Object(c.useMemo)((function(){return P(null===de||void 0===de?void 0:de.user)}),[de]),Fe=(Object(c.useMemo)((function(){var e;return!!(null===de||void 0===de||null===(e=de.user)||void 0===e?void 0:e.capabilities)&&de.user.capabilities.canPinTraining}),[de]),Object(c.useMemo)((function(){if(Me.length>0){var e=[];return Me.forEach((function(t){t.training.skills.forEach((function(t){return e.push(t)}))})),e.length>0}return!1}),[Me])),Ae=Object(m.useGetSuggestedTrainingsAssistantLazyQuery)(),Pe=Object(s.a)(Ae,2),Ne=Pe[0],we=Pe[1].data;Object(c.useEffect)((function(){L(x.AppModule.MY_CAREER)&&N===Ee&&Ne()}),[N]);var Le=function(){ne(Z?{type:"closeTrainingRequestPopover"}:{type:"openTrainingRequestPopover"})},Be=function(){var e=Object(r.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,oe({variables:{input:{userId:t.userId,trainingId:"NO_REF"===t.trainingId?void 0:t.trainingId,trainingName:t.trainingName,status:t.status,budgetYear:t.budgetYear,comment:t.comment,deadline:t.deadline,startDate:t.startDate,endDate:t.endDate,customFields:t.customFields}},update:function(){ce()}}).then((function(){d.success(n("success")),ne({type:"reset"})})).catch((function(e){d.error(U(e)),console.error("Training application failed !!!",e)}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ue=Object(c.useMemo)((function(){var e,t,n=null===we||void 0===we||null===(e=we.me)||void 0===e||null===(t=e.suggestedTrainings)||void 0===t?void 0:t.nodes;return n?n.map((function(e){return{id:e.id,name:e.name}})):[]}),[we]),Ye=Object(c.useMemo)((function(){return Object(R.a)({selectedIds:xe,pinnedTrainings:Me})}),[Me,xe]),ze=function(){var e=[{dataKey:"checkBoxes",headerTitle:"".concat(n("assignment_selection")),isSortable:!1,isIcon:!0,iconData:{icon:v.a,size:20},columnWidth:Object(O.b)("xtraSmall"),cellRenderer:function(e){var t=e.node;return Object(M.jsx)(x.CheckboxCell,{size:"xtraSmall",value:t.id,isChecked:(null===xe||void 0===xe?void 0:xe.includes(t.id))||!1,onChange:fe})}},{dataKey:"eyeIcon",headerTitle:n("id_short"),isSortable:!1,isIcon:!0,iconData:{icon:h.a,color:"black",size:14},columnWidth:Object(O.b)("xtraSmall"),cellRenderer:function(e){var t=e.node;return Object(M.jsx)(x.IconAloneCell,{size:"xtraSmall",isClickable:!0,onClick:function(){pe({pinnedTrainingId:t.id,userId:N})},icon:Object(M.jsx)(b.Icon,{as:h.a,size:14,color:"black"})})}},{dataKey:"training",headerTitle:n("training",1),isSortable:!1,columnWidth:Object(O.b)("large"),cellRenderer:function(e){var t=e.node;return t.training.status!==p.SkillProfileStatus.Generated?Object(M.jsx)(x.LinkCell,{text:t.training.name,isTwoLines:!0,path:t.training.id?T.b.USER_ORGANIZATION_TRAINING_DETAILS.getRoute({trainingId:t.training.id}):"",size:"large"}):Object(M.jsx)(x.LongTextCell,{text:t.training.name,color:"grey.6",fontWeight:"semiBold",isTwoLines:!0})},xlsCellRenderer:function(e){return e.node.training.name}},{dataKey:"status",headerTitle:n("status"),isSortable:!1,columnWidth:Object(O.b)("medium"),cellRenderer:function(e){var t=e.node;return Object(M.jsx)(x.GenericStatusCell,{statusObject:Object(O.g)(k.a,t.status),size:"medium"})},xlsCellRenderer:function(e){var t=e.node,i=Object(O.g)(k.a,t.status);return"string"===typeof i.labelKey?"".concat(n(i.labelKey)):"-"}},{dataKey:"comment",headerTitle:n("comment"),isSortable:!1,columnWidth:Object(O.b)("large"),cellRenderer:function(e){var t=e.node;return Object(M.jsx)(x.LongTextCell,{size:"large",isTwoLines:!0,text:t.data["".concat(t.status,"_comment")]})},xlsCellRenderer:function(e){var t=e.node;return t.data["".concat(t.status,"_comment")]||"-"}},{dataKey:"updatedAt",headerTitle:n("update_title"),isSortable:!1,columnWidth:Object(O.b)("medium"),cellRenderer:function(e){var t=e.node;return Object(M.jsx)(x.UpdateCell,{date:t.updatedAt,size:"medium"})},xlsCellRenderer:function(e){var t=e.node;return Object(x.xlsDateCell)(t.updatedAt)}}];return Fe&&e.push({dataKey:"skills_targeted",headerTitle:n("skills_targeted"),isSortable:!1,columnWidth:Object(O.b)("large"),cellRenderer:function(e){var t=e.node;return Object(M.jsx)(x.ObjectTagsCell,{tags:t.training.skills,size:"large"})},xlsCellRenderer:function(e){var t=e.node.training.skills.map((function(e){return e.name}));return t.length>0?"".concat(t.join(", ")):"-"}}),e.push({dataKey:"budgetYear",headerTitle:n("budget_year"),isSortable:!1,columnWidth:Object(O.b)("small"),cellRenderer:function(e){var t=e.node;return Object(M.jsx)(x.ShortTextCell,{text:t.budgetYear,size:"small"})},xlsCellRenderer:function(e){var t=e.node;return t.budgetYear?t.budgetYear:"-"}},{dataKey:"startDate",headerTitle:n("startDate"),isSortable:!1,columnWidth:Object(O.b)("small"),cellRenderer:function(e){var t=e.node;return Object(M.jsx)(x.DateCell,{date:t.startDate,size:"small"})},xlsCellRenderer:function(e){var t=e.node;return Object(x.xlsDateCell)(t.startDate)}},{dataKey:"endDate",headerTitle:n("endDate"),isSortable:!1,columnWidth:Object(O.b)("small"),cellRenderer:function(e){var t=e.node;return Object(M.jsx)(x.DateCell,{date:t.endDate,size:"small"})},xlsCellRenderer:function(e){var t=e.node;return Object(x.xlsDateCell)(t.endDate)}}),Re.size>0&&Re.forEach((function(t){e.push({dataKey:"customFields.".concat(t._key),headerTitle:t.name,isSortable:!0,columnWidth:Object(O.b)("large"),cellRenderer:function(e){var n=e.node;return Object.keys(n.customFields||{}).includes(t._key)?Object(M.jsx)(x.CustomFieldCell,{field:t,customFields:n.customFields,value:n.customFields[t._key],size:"large"}):Object(M.jsx)(b.Line,{width:"100%",height:"100%",bg:"grey.0"})},xlsCellRenderer:function(e){var i=e.node;return Object.keys(i.customFields||{}).includes(t._key)?Object(x.xlsCustomFieldCell)({field:t,value:i.customFields[t._key],translate:n}):"-"}})})),e},qe=Object(x.useExportTable)({worksheetName:"Resource_training_".concat(Object(g.localeMoment)().format("DD.MM.YYYY")),columns:ze().slice(2),fetchRowsPromise:ue,rowsMappingFn:function(e){return P(e.user)},totalRowCount:De,fixedColumnCount:1}),We=Object(s.a)(qe,2),Ge=We[0],Ke=We[1];return Object(M.jsxs)(E.a,{display:"flex",flexDirection:"column",pt:1,pl:1,children:[L(x.AppModule.MY_CAREER)&&Ee===N&&Ue.length>0?Object(M.jsx)(b.Box,{width:"100%",pr:1,children:Object(M.jsx)(_.a,{onElementClick:function(e){var t=e.elementId;return l.push(T.b.USER_ORGANIZATION_TRAINING_DETAILS.getRoute({trainingId:t}))},onShowAll:function(){return l.push(T.b.USER_CAREER_TRAININGS.getRoute())},width:"100%",suggestedElements:Ue,titleLabel:n("these_trainings_might_interest_you"),icon:f.a})}):null,Object(M.jsx)(x.TableToolbox,{totalCount:De,isLoading:le,quickFilters:[],menuActions:[{title:n("export"),onClick:function(){return Ke()},disabled:Ge}],primaryAction:{title:n("add_a_training_need"),onClick:Le,isPrimaryActionOpensPopover:!0,popoverProps:{isOpened:Z,onClose:Le,content:X===i.REQUEST_TYPE_SELECT?Object(M.jsxs)(b.MenuSelect,{children:[Object(M.jsx)(b.MenuOption,{onClick:function(e){e.stopPropagation(),ne({type:"openTrainingNavigator"})},children:n("browse_training_catalog")}),Object(M.jsx)(b.MenuOption,{onClick:function(){ne({type:"setDataForPinTrainingCreationAndOpenModal",trainingTag:{kind:"trainingTag",id:"NO_REF",name:""}})},children:n("request_off_plan_training")})]}):Object(M.jsx)(j.TrainingsNavigator,{isTrainingWithChildrenSelectionBlocked:!0,onSubmit:function(e){var t=Object(s.a)(e,1)[0];ne({type:"setDataForPinTrainingCreationAndOpenModal",trainingTag:{kind:"trainingTag",id:t.id,name:t.name}})}})},onClosePopover:Le},actionModeProps:{isActive:ve,onClose:function(){Ce(void 0)},quickFilters:[{id:"pin_training_status_update",title:n("pin_training_status_update"),type:x.QuickFilterTypes.SingleSelect,elements:Ye,noElementsLabel:n("no_status_available"),value:te,isResetOption:!1,isSelected:"string"===typeof te,onApplyFilter:function(e){ne({type:"setUpdatedStatus",updatedStatus:e,selectedIds:xe})},onClearFilter:function(){ne({type:"setUpdatedStatus",updatedStatus:void 0,selectedIds:xe})}}]}}),Object(M.jsx)(x.TableContent,{rows:Me,selectedIdsForSelectedLines:xe,columns:ze(),noRowsRenderer:function(){return Object(M.jsx)(x.NoDataToDisplay,{})},totalRowCount:De,rowHeight:50,fixedColumnCount:2,isLoading:le}),Object(M.jsx)(D.a,{capabilities:K,isOpened:$,isLoading:re,trainingTag:ee,initialValues:Q,onSubmit:Be,onClose:function(){ne({type:"reset"})}}),Object(M.jsx)(I.a,{isOpened:H||J,onConfirm:H?function(){"undefined"!==typeof te&&"undefined"!==typeof xe&&Ie({comment:V,updatedStatus:te,selectedIds:xe})}:function(){"undefined"!==typeof xe&&_e(xe)},onCancel:function(){return ne({type:H?"closeStatusUpdateConfirmationModal":"toggleIsBulkDeleteConfirmationModalOpened"})},isLoading:ye,title:n(H?"project_assignments_bulk_status_update_confirmation_title":"project_assignments_bulk_deletion_confirmation_title"),infoText:n(H?"project_assignments_bulk_status_update_confirmation_info":"project_assignments_bulk_deletion_confirmation_info"),children:"undefined"!==typeof te&&H&&Object(M.jsxs)(b.Column,{justifyContent:"flex-start",children:[Object(M.jsx)(b.Box,{height:"50px",width:"100%",pb:1,children:Object(M.jsx)(x.GenericStatusCell,{statusObject:Object(O.g)(k.a,te),size:"medium"},te)}),Object(M.jsx)(b.TextArea,{value:V,onChange:function(e){ne({type:"setComment",comment:e})},placeholder:n("comment"),mt:1})]})}),Object(M.jsx)(S.a,{isOpened:Oe,onClose:je,onUpdate:ke,pinnedTrainingId:me})]})}},742:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var i=n(17),a=n(285),o=(n(0),n(14)),r=n(1),s=["children"],d=function(e){var t=e.children,n=Object(a.a)(e,s);return Object(r.jsx)(o.Box,Object(i.a)(Object(i.a)({boxSizing:"border-box",height:"100%",overflow:"hidden",width:"100%"},n),{},{children:t}))}},827:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));n(778);var i=n(17),a=n(285),o=(n(0),n(14)),r=n(746),s=n(10),d=n(1),l=["suggestedElements","titleLabel","icon","onShowAll","onElementClick"],c=function(e){var t=e.suggestedElements,n=e.icon,i=e.onElementClick,a=Object(o.useResponsive)().isMobile;return Object(d.jsx)(o.Line,{width:"100%",flexWrap:a?"wrap":"nowrap",children:t.slice(0,3).map((function(e){var t=e.id,r=e.name;return Object(d.jsx)(o.Box,{maxWidth:a?void 0:"30%",m:0,children:Object(d.jsxs)(o.TextWithAutoTooltipOnEllipsis,{tooltipTitle:r,fontWeight:"semiBold",clickableAppearance:"underline",mr:2,onClick:function(){return i({elementId:t})},children:[Object(d.jsx)(o.Icon,{as:n,size:18,mr:0}),r]})},t)}))})},u=function(e){var t=e.suggestedElements,n=e.titleLabel,u=e.icon,b=e.onShowAll,j=void 0===b?function(){return null}:b,O=e.onElementClick,m=void 0===O?function(){return null}:O,p=Object(a.a)(e,l),g=Object(o.useTranslate)({capitalize:!0}),f=Object(s.useAppContext)().checkModule;return Object(d.jsxs)(o.Box,Object(i.a)(Object(i.a)({p:2,mb:2,bg:"primary.0"},p),{},{children:[Object(d.jsxs)(o.Line,{mb:0,children:[Object(d.jsx)(o.Box,{borderRadius:34,bg:"white",p:0,mr:1,children:Object(d.jsx)(o.Icon,{as:r.a,size:20})}),Object(d.jsx)(o.Text,{fontSize:"large",fontWeight:"bold",children:n})]}),Object(d.jsxs)(o.Line,{flexWrap:"wrap",children:[Object(d.jsx)(o.Box,{flex:"1 1 auto",overflow:"hidden",children:(t||[]).length>0?Object(d.jsx)(c,{suggestedElements:t||[],onElementClick:m,icon:u}):Object(d.jsx)(o.Text,{fontWeight:"semiBold",children:g("no_suggestions_atm")})}),f(s.AppModule.MY_CAREER)&&Object(d.jsx)(o.Box,{flex:"0 0 auto",children:Object(d.jsx)(o.Button,{appearance:"outline",onClick:j,children:g("show_all_suggestions")})})]})]}))}},902:function(e,t,n){"use strict";n.d(t,"a",(function(){return k}));var i=n(223),a=n(53),o=n(285),r=n(187),s=n(188),d=n(17),l=n(0),c=n(15),u=n(61),b=n(65),j=n(14),O=n(10),m=n(19),p=n(37),g=n(63),f=n(32),v=n(747),h=n(843),x=n(789),C=n(1),T=["capabilities","initialValues","isOpened","isLoading","isModification","trainingTag","onSubmit","onClose"],S=Object(u.default)(j.TextArea)((function(){return{borderRadius:0}})),y={userId:"NONE",trainingPinId:"NONE",trainingName:"",freeRequestMode:!1,isAdvancedSettings:!1,status:f.PinTrainingStatus.Suggested,budgetYear:void 0,deadline:void 0,startDate:void 0,endDate:void 0,comment:void 0,customFields:void 0},_=function(e,t){var n;switch(t.type){case"init":return Object(d.a)(Object(d.a)({},e),{},{userId:t.userId,trainingPinId:t.trainingPinId,trainingName:t.trainingName,freeRequestMode:t.freeRequestMode,isAdvancedSettings:t.isAdvancedSettings,status:t.status,budgetYear:t.budgetYear,deadline:"undefined"!==typeof t.deadline?Object(p.localeMoment)(t.deadline).hour(12).toISOString():void 0,startDate:"undefined"!==typeof t.startDate?Object(p.localeMoment)(t.startDate).hour(12).toISOString():void 0,endDate:"undefined"!==typeof t.endDate?Object(p.localeMoment)(t.endDate).hour(12).toISOString():void 0,comment:t.comment,customFields:t.customFields});case"turnOnIsAdvancedSettings":return Object(d.a)(Object(d.a)({},e),{},{isAdvancedSettings:!0});case"setDate":return Object(d.a)(Object(d.a)({},e),{},{startDate:t.startDate,endDate:t.endDate});case"setCustomFields":var i=Object.keys(t.customField||[])[0],a=null===(n=e.customFields)||void 0===n?void 0:n.filter((function(e){return Object.keys(e||{})[0]!==i}));return Object(d.a)(Object(d.a)({},e),{},{customFields:[].concat(Object(s.a)(a||[]),[t.customField])});case"setState":return Object(d.a)(Object(d.a)({},e),{},Object(r.a)({},t.key,t.value));case"reset":return y}},I=function(e){var t=e.customFields,n=e.id;if(null===t||void 0===t?void 0:t.find((function(e){return Object.keys(e||{})[0]===n})))return Object.values(t.find((function(e){return Object.keys(e||{})[0]===n}))||[])[0]},k=function(e){var t=e.capabilities,n=e.initialValues,s=e.isOpened,u=e.isLoading,f=e.isModification,k=void 0!==f&&f,R=e.trainingTag,E=e.onSubmit,D=e.onClose,M=(Object(o.a)(e,T),Object(j.useTranslate)({capitalize:!0})),F=Object(b.h)(),A=Object(c.useParams)().userId,P=Object(l.useReducer)(_,y),N=Object(a.a)(P,2),w=N[0],L=w.userId,B=w.trainingPinId,U=w.trainingName,Y=w.freeRequestMode,z=w.isAdvancedSettings,q=w.status,W=w.budgetYear,G=w.deadline,K=w.startDate,V=w.endDate,Q=w.comment,Z=w.customFields,H=N[1],J=Object(O.useAppContext)(),X=J.customFields.pinnedTrainingFields,$=A||J.user.id,ee=Object(m.useGetPinnedTrainingsLazyQuery)({fetchPolicy:"cache-first",nextFetchPolicy:"cache-only"}),te=Object(a.a)(ee,2),ne=te[0],ie=te[1].data;Object(l.useEffect)((function(){"undefined"!==typeof L&&"NONE"!==L&&"undefined"!==typeof R&&"NO_REF"!==R.id&&"NONE"!==R.id&&ne({variables:{dataFilters:{user:{inUsers:[L]},training:{inValues:[R.id]}}}})}),[R,L]),Object(l.useEffect)((function(){var e="NO_REF"===R.id;if(k){var t=[];if(null===n||void 0===n?void 0:n.customFields)for(var i=0,o=Object.entries(n.customFields);i<o.length;i++){var s=Object(a.a)(o[i],2),l=s[0],c=s[1];t.push(Object(r.a)({},l,c))}H({type:"init",userId:null===n||void 0===n?void 0:n.userId,trainingPinId:null===n||void 0===n?void 0:n.trainingPinId,trainingName:(null===n||void 0===n?void 0:n.trainingName)||"",freeRequestMode:e,isAdvancedSettings:!0,status:(null===n||void 0===n?void 0:n.status)||y.status,budgetYear:null===n||void 0===n?void 0:n.budgetYear,deadline:null===n||void 0===n?void 0:n.deadline,startDate:null===n||void 0===n?void 0:n.startDate,endDate:null===n||void 0===n?void 0:n.endDate,comment:null===n||void 0===n?void 0:n.comment,customFields:t})}else H(Object(d.a)(Object(d.a)({type:"init"},y),{},{freeRequestMode:e,userId:$}))}),[n,!0===s]);var ae=function(e){return function(t){H("deadline"!==e?{type:"setState",key:e,value:t}:{type:"setState",key:e,value:Object(p.localeMoment)(t).toISOString()})}},oe=function(){H({type:"reset"}),D()},re=Object(l.useMemo)((function(){var e,n=[],a=Object(i.a)(v.b);try{var o=function(){var i=e.value;k?(q&&!((null===t||void 0===t?void 0:t.allowedStatuses)||[]).includes(q)&&i[0]===q&&n.push(i),((null===t||void 0===t?void 0:t.allowedStatuses)||[]).forEach((function(e){i[0]===e&&n.push(i)}))):n.push(i)};for(a.s();!(e=a.n()).done;)o()}catch(r){a.e(r)}finally{a.f()}return n}),[t]),se=Object(l.useMemo)((function(){return Object(x.b)(null===ie||void 0===ie?void 0:ie.pinnedTrainings.nodes)}),[ie]);return Object(C.jsx)(O.FormContainerModal,{title:M(k?"modify_training_application":"create_training_application"),confirmButtonLabel:M(k?"modify":"create"),maxHeight:"95vh",onClose:oe,onCancel:oe,onConfirm:function(){var e={};Z?Z.forEach((function(t){var n=Object(a.a)(Object.entries(t||[])[0],2),i=n[0],o=n[1];e=Object(d.a)(Object(d.a)({},e),{},Object(r.a)({},i,o))})):e=void 0,E({userId:L,trainingPinId:B,trainingId:R.id,trainingName:U,status:q,budgetYear:W,deadline:G?Object(p.localeMoment)(G).toISOString():void 0,startDate:K?Object(p.localeMoment)(K).toISOString():void 0,endDate:V?Object(p.localeMoment)(V).toISOString():void 0,comment:Q,customFields:e})},isOpened:s,isLoading:u,width:596,children:Object(C.jsxs)(j.Column,{children:["undefined"!==typeof se&&se.length>0&&Object(C.jsx)(O.FormLine,{mt:0,children:Object(C.jsx)(h.a,{pinnedTrainings:se})}),Object(C.jsx)(O.FormLine,{children:Object(C.jsx)(O.FormLabel,{content:M("targeted_training"),children:Y?Object(C.jsx)(j.Input,{type:"text",value:U,placeholder:M("training_request_name_placeholder"),onChange:k?void 0:ae("trainingName"),disabled:k,width:"100%"}):Object(C.jsx)(g.ObjectTag,Object(d.a)({},R))})}),Object(C.jsx)(O.FormLine,{children:Object(C.jsx)(O.FormLabel,{name:"status",content:M("status"),children:Object(C.jsx)(j.SelectField,{value:q,onChange:ae("status"),zIndex:F.zIndexes.MODAL_POPOVER,readOnly:1===re.length,placeholder:"",source:re.map((function(e){return{label:M(e[1]),value:e[0]}})),width:"100%"})})}),!k&&!z&&Object(C.jsx)(O.FormLine,{children:Object(C.jsx)(j.Box,{width:"fit-content",onClick:function(){H({type:"turnOnIsAdvancedSettings"})},children:Object(C.jsx)(j.Text,{fontWeight:"semiBold",color:F.colors.primary[3],children:"".concat(M("advanced_settings"),"...")})})}),(k||z)&&Object(C.jsxs)(C.Fragment,{children:[Object(C.jsx)(O.FormLine,{children:Object(C.jsx)(O.FormLabel,{name:"budgetYear",content:M("budget_year"),mr:1,children:Object(C.jsx)(j.Input,{value:W,onChange:ae("budgetYear"),placeholder:M("add_a_value")})})}),Object(C.jsx)(O.FormLine,{children:Object(C.jsx)(j.PeriodPicker,{startDate:K,endDate:V,onChange:function(e){var t=e.startDate,n=e.endDate;t===K&&n===V||H({type:"setDate",startDate:t||void 0,endDate:n||void 0})},isOneDayMinimumGap:!1})}),X.map((function(e){return Object(C.jsx)(O.FormLine,{children:Object(C.jsx)(g.CustomField,Object(d.a)({mr:1,field:e,withLabel:!0,value:I({customFields:Z,id:e._key}),onSubmit:function(t){return function(e){var t=Object(r.a)({},e.id,e.value);H({type:"setCustomFields",customField:t})}({id:e._key,value:t,comparator:"DATE"===e.field_type?"BETWEEN":"IN_VALUES",fieldType:e.field_type})}},e),e._key)},e._key)}))]}),Object(C.jsx)(O.FormLine,{children:Object(C.jsx)(O.FormLabel,{name:"comment",content:M("comment"),children:Object(C.jsx)(S,{value:Q,onChange:ae("comment"),placeholder:M("add_comment")})})})]})})}},997:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var i,a,o=n(0),r=["title","titleId"];function s(){return(s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e}).apply(this,arguments)}function d(e,t){if(null==e)return{};var n,i,a=function(e,t){if(null==e)return{};var n,i,a={},o=Object.keys(e);for(i=0;i<o.length;i++)n=o[i],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)n=o[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function l(e,t){var n=e.title,l=e.titleId,c=d(e,r);return o.createElement("svg",s({viewBox:"0 0 14 14",xmlns:"http://www.w3.org/2000/svg",ref:t,"aria-labelledby":l},c),n?o.createElement("title",{id:l},n):null,i||(i=o.createElement("path",{d:"M13.6355 5.99544C12.4331 4.54085 9.97076 2.1001 7.0032 2.1001C4.03563 2.1001 1.57332 4.54085 0.370946 5.99544C0.134308 6.27897 0 6.63645 0 7.0001C0 7.36375 0.134308 7.72123 0.370946 8.00475C1.57332 9.45934 4.03563 11.9001 7.0032 11.9001C9.97076 11.9001 12.4331 9.45934 13.6355 8.00475C14.1215 7.41305 14.1215 6.58714 13.6355 5.99544ZM12.6825 7.27746C11.8255 8.31909 9.54865 10.729 6.9968 10.729C4.44495 10.729 2.1809 8.31293 1.3175 7.27129C1.25354 7.19117 1.21517 7.09871 1.21517 7.0001C1.21517 6.90148 1.25354 6.80903 1.3175 6.72274C2.1809 5.68727 4.45135 3.27117 7.0032 3.27117C9.55505 3.27117 11.8255 5.68727 12.6889 6.72274C12.8296 6.89532 12.8296 7.10488 12.6889 7.27129L12.6825 7.27746Z"})),a||(a=o.createElement("path",{d:"M7.00341 4.56543C5.57079 4.56543 4.40039 5.65637 4.40039 7.00002C4.40039 8.34367 5.57079 9.43461 7.00341 9.43461C8.43602 9.43461 9.60642 8.34367 9.60642 7.00002C9.60642 5.65637 8.43602 4.56543 7.00341 4.56543ZM7.00341 8.26354C6.23593 8.26354 5.61556 7.6965 5.61556 7.00002C5.61556 6.30354 6.23593 5.7365 7.00341 5.7365C7.77088 5.7365 8.39125 6.30354 8.39125 7.00002C8.39125 7.6965 7.77088 8.26354 7.00341 8.26354Z"})))}var c=o.forwardRef(l);n.p}}]);