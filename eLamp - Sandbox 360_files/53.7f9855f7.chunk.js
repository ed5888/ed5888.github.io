(this["webpackJsonp@elamp/main-app"]=this["webpackJsonp@elamp/main-app"]||[]).push([[53],{1142:function(e,t,s){"use strict";s.d(t,"a",(function(){return I})),s.d(t,"b",(function(){return ae})),s.d(t,"c",(function(){return ve})),s.d(t,"d",(function(){return Ge})),s.d(t,"e",(function(){return We})),s.d(t,"f",(function(){return He})),s.d(t,"g",(function(){return Je})),s.d(t,"h",(function(){return Qe})),s.d(t,"i",(function(){return qe})),s.d(t,"j",(function(){return Ke})),s.d(t,"k",(function(){return Xe})),s.d(t,"l",(function(){return tt})),s.d(t,"n",(function(){return at})),s.d(t,"m",(function(){return rt})),s.d(t,"o",(function(){return mt}));var n=s(17),a=s(285),o=s(0),i=s.n(o),r=s(14),c=s(61),l=s(1),u=["number","titleElement","rightElement"],d=["title"],m=Object(c.default)(r.Line)((function(e){var t=e.theme;return{borderBottom:"1px solid ".concat(t.colors.grey[1])}})),p=function(e){var t=e.number,s=e.titleElement,o=e.rightElement,i=Object(a.a)(e,u),c=Object(r.useResponsive)().isMobile;return Object(l.jsxs)(r.Box,Object(n.a)(Object(n.a)({width:"100%"},i),{},{children:[Object(l.jsxs)(m,{p:[1,20],justifyContent:"space-between",mb:2,bg:["grey.0",null],children:[Object(l.jsxs)(r.Line,{children:[!isNaN(t)&&Object(l.jsx)(r.CircleIndicator,{size:c?24:20,fontWeight:["semiBold","bold"],text:t.toString(),mr:1}),s]}),o||null]}),Object(l.jsx)(j,{px:[15,20],children:i.children})]}))},j=function(e){var t=Object.assign({},e),s=Array.isArray(t.children)?t.children.filter((function(e){return!!e})):[t.children];return Object(l.jsx)(r.Line,Object(n.a)(Object(n.a)({justifyContent:"space-between",alignItems:"flex-start",flexWrap:"wrap"},t),{},{children:s.map((function(e,t){return Object(l.jsx)(r.Box,{flex:0===t?"1 1 auto":"0 1 300px",children:e},"sectionChild_".concat(t))}))}))},b=function(e){var t=e.title,s=Object(a.a)(e,d);return Object(l.jsx)(r.Text,Object(n.a)(Object(n.a)({fontWeight:["semiBold","bold"]},s),{},{children:t}))},f=s(187),O=s(139),v=s.n(O),x=s(286),h=s(32),A=s(109),g=s(933),S=s(776),C=s(53),y=s(63),_=s(164);var T,k,R=s(745),w=function(e){e.id;var t=e.name,s=e.pattern,n=Object(r.useTranslate)(),a=Object(A.getPatternCriteriaCount)({pattern:s});return Object(l.jsxs)(r.Line,{mb:2,children:[Object(l.jsx)(r.Icon,{mr:1,as:R.a,size:28}),Object(l.jsx)(r.Text,{fontWeight:"semiBold",children:t}),Object(l.jsx)(r.Text,{ml:1,color:"black.1",children:"(".concat(n("num_skill",a),")")})]})},D=["assessmentStatus","evaluationObjects","evaluationObjectsType"],I=function(e){var t=e.assessmentStatus,s=e.evaluationObjects,o=e.evaluationObjectsType,i=Object(a.a)(e,D),c=Object(r.useTranslate)(),u=Object(r.useSwitch)(),d=Object(S.useResourceAssessmentDetailContext)(),m=d.assessmentId,j=d.assessment,f=d.capabilities,O=d.isValidator,A=0===s.length,C=o?E[o]:function(){return null},y=o?L[o]({evaluationObjects:s}):0,_=(o===h.AssessmentSkillsScopeType.SKILLS_LIST||o===h.AssessmentSkillsScopeType.EVALUATED_USER_JOBS)&&!A&&(t===h.AssessmentStatus.PLANNED||t===h.AssessmentStatus.ONGOING),T=f.canUpdate||O,k=function(){var e=Object(x.a)(v.a.mark((function e(){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:u.off();case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(l.jsxs)(l.Fragment,{children:[Object(l.jsx)(p,Object(n.a)(Object(n.a)({number:1,titleElement:Object(l.jsxs)(l.Fragment,{children:[Object(l.jsx)(b,{title:c("targeted_skills")}),Object(l.jsxs)(r.Text,{ml:0,color:"grey.5",children:["(",y,")"]})]}),rightElement:_&&T&&Object(l.jsx)(r.Button,{appearance:"clean",onClick:u.on,children:c("edit")})},i),{},{children:Object(l.jsx)(C,{evaluationObjects:s})})),"undefined"!==typeof j&&Object(l.jsx)(g.c,{assessmentId:m,userId:null===j||void 0===j?void 0:j.evaluatedUser.id,isOpened:u.active,onClose:u.off,onUpdatedSkillsScope:k})]})},E=(T={},Object(f.a)(T,h.AssessmentSkillsScopeType.SKILLS_LIST,(function(e){var t=e.evaluationObjects,s=Object(o.useMemo)((function(){return Object(y.getNormalizedSkillsAndLibraries)(t)}),[t]),n=s.libraries,a=void 0===n?{}:n,i=s.skills,c=void 0===i?{}:i;return Object(l.jsx)(l.Fragment,{children:Object.entries(a).map((function(e){var t=Object(C.a)(e,2),s=t[0],n=t[1],a=n.name,o=n.color,i=n.logo;return Object(l.jsxs)(r.Box,{mb:1,children:[Object(l.jsxs)(r.Line,{mb:0,children:[Object(l.jsx)(r.Icon,{as:Object(y.getIconComponent)(i||""),color:o,mr:1,size:16}),Object(l.jsx)(r.Text,{fontWeight:"bold",textTransform:"uppercase",children:a})]}),Object.values(c).filter((function(e){return e.libraryContext===s})).sort((function(e,t){return Object(_.compareWith)(e,t,(function(e){return null===e||void 0===e?void 0:e.name}))})).map((function(e){return Object(l.jsx)(r.Text,{ml:26,children:e.name},e.id)}))]},s)}))})})),Object(f.a)(T,h.AssessmentSkillsScopeType.EVALUATED_USER_JOBS,(function(e){var t=e.evaluationObjects;return Object(l.jsx)(l.Fragment,{children:t.map((function(e){return Object(l.jsx)(w,Object(n.a)({},e),e.id)}))})})),Object(f.a)(T,h.AssessmentSkillsScopeType.LIBRARIES_AND_JOBS,(function(){return null})),T),L=(k={},Object(f.a)(k,h.AssessmentSkillsScopeType.SKILLS_LIST,(function(e){return e.evaluationObjects.length})),Object(f.a)(k,h.AssessmentSkillsScopeType.EVALUATED_USER_JOBS,(function(e){return e.evaluationObjects.reduce((function(e,t){var s=t.pattern;return e+Object(A.getPatternCriteriaCount)({pattern:s})}),0)})),Object(f.a)(k,h.AssessmentSkillsScopeType.LIBRARIES_AND_JOBS,(function(){return 0})),k),M=s(15),F=s(140),N=s(37),U=s(19),B=s(10),V=s(3),G=["assessment","isValidator","isAssessor","assessmentRowId"],z=function(e){var t,s=e.assessment,o=s.id,i=s.status,c=s.startDate,u=s.assessmentRowsCount,d=e.isValidator,m=e.isAssessor,p=e.assessmentRowId,j=Object(a.a)(e,G),b=Object(r.useTranslate)({capitalize:!0}),f=Object(B.useAppContext)().getErrorMessage,O=Object(M.useHistory)(),A=Object(r.useAlert)(),g=Object(S.useResourceAssessmentDetailContext)().assessment,y=Object(U.useUpdateAssessmentMutation)(),_=Object(C.a)(y,2),T=_[0],k=_[1].loading,R=i===h.AssessmentStatus.PLANNED;(null===g||void 0===g?void 0:g.assessmentFormContentType)===h.AssessmentFormContentType.ADDON?t=V.b.ASSESSMENT_ADDON.getRoute({assessmentId:o,assessmentRowId:p}):((null===g||void 0===g?void 0:g.assessmentFormContentType)===h.AssessmentFormContentType.JSON_FORM&&g.assessmentFormType===h.AssessmentType.SHARED_FORM&&"undefined"!==typeof g.assessmentFormContent.json||(null===g||void 0===g?void 0:g.assessmentFormContentType)===h.AssessmentFormContentType.JSON_FORM&&g.assessmentFormType===h.AssessmentType.INDIVIDUAL_FORMS)&&(t=V.b.ASSESSMENT_JSON_FORM.getRoute({assessmentId:o,assessmentRowId:p}));var w=function(){var e=Object(x.a)(v.a.mark((function e(s){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!R){e.next=4;break}return s.preventDefault(),e.next=4,T({variables:{input:{id:o,status:h.AssessmentStatus.ONGOING}}}).then((function(){O.push(t)})).catch((function(e){A.error(f(e))}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),D=!!u,I=i!==h.AssessmentStatus.PLANNED||d&&m,E=(i===h.AssessmentStatus.PLANNED||i===h.AssessmentStatus.ONGOING)&&m;return Object(l.jsxs)(r.Line,Object(n.a)(Object(n.a)({alignItems:"center"},j),{},{children:[R&&Object(l.jsx)(r.Text,{mr:1,color:"grey.6",fontSize:"small",children:b("the_assessment_will_start_on",{date:Object(N.localeMoment)(c).format("DD/MM/YYYY")})}),I&&"undefined"!==typeof t?Object(l.jsx)(r.Button,{as:F.Link,to:t,onClick:w,isLoading:k,children:b(E?D?"continue_evaluation":"start_evaluation":"see_action")}):Object(l.jsx)(r.Text,{children:b("no_content_to_fill")})]}))},P=function(){var e,t,s=Object(r.useTranslate)(),n=Object(S.useResourceAssessmentDetailContext)(),a=n.assessment,o=n.isAssessor,i=n.isValidator;a&&(e={id:a.id,status:a.status,startDate:a.startDate,assessmentRowsCount:(null===(t=a.assessmentRows)||void 0===t?void 0:t.length)||0});return o?e?Object(l.jsx)(z,{assessment:e,isAssessor:o,isValidator:i}):null:Object(l.jsx)(r.Text,{children:s("awaiting_assessors")})},W=function(e){var t,s,n=e.assessmentRow,a=Object(r.useTranslate)({capitalize:!0}),o=Object(S.useResourceAssessmentDetailContext)(),i=o.assessment,c=o.isAssessor,u=o.isValidator,d=n.resultReport;i&&(t={id:i.id,startDate:i.startDate,status:i.status,assessmentRowsCount:(null===(s=i.assessmentRows)||void 0===s?void 0:s.length)||0});return t?Object(l.jsxs)(r.Box,{children:["undefined"!==typeof n.result&&Object(l.jsx)(r.Line,{children:Object(l.jsxs)(r.Text,{fontWeight:"semiBold",children:[a("two_points",{phrase:a("results")})," ",Object(l.jsx)(r.StringParser,{children:n.result})]})}),Object(l.jsxs)(r.Text,{fontSize:"small",my:0,children:[a("two_points",{phrase:a("last_update")})," ",Object(N.localeMoment)(n.updatedAt).format("DD/MM/YYYY")," ",a("by")," ",n.updatedBy.displayName]}),(null===d||void 0===d?void 0:d.name)&&(null===d||void 0===d?void 0:d.url)&&Object(l.jsxs)(r.Line,{mb:20,mt:1,children:[Object(l.jsx)(r.Text,{fontWeight:"semiBold",fontSize:"small",mr:1,children:a("two_points",{phrase:a("results_report")})}),Object(l.jsx)(r.FileName,{url:d.url,fileName:d.name})]}),Object(l.jsx)(z,{assessment:t,isValidator:u,isAssessor:c,assessmentRowId:n.id})]}):null},Y=function(){var e=Object(S.useResourceAssessmentDetailContext)().assessment,t=null===e||void 0===e?void 0:e.assessmentRows;return t?Object(l.jsx)(r.Box,{mb:2,children:t.map((function(e){return Object(l.jsx)(W,{assessmentRow:e},e.id)}))}):null},H=function(){var e,t=Object(S.useResourceAssessmentDetailContext)().assessment;return t?0===((null===(e=t.assessmentRows)||void 0===e?void 0:e.length)||0)?Object(l.jsx)(P,{}):Object(l.jsx)(Y,{}):null},J=["user","assessorLabel"],Q=function(){return Object(S.useResourceAssessmentDetailContext)().assessment?Object(l.jsx)(r.Column,{maxWidth:[null,800],width:["100%",null],children:Object(l.jsx)(q,{})}):null},q=function(){var e=Object(r.useTranslate)({capitalize:!0}),t=Object(S.useResourceAssessmentDetailContext)(),s=t.assessment,a=t.assessors,o=Object(B.useAppContext)().user.id;if(!s)return null;var i=((null===s||void 0===s?void 0:s.assessmentRows)||[]).reduce((function(e,t){var s,a=null===(s=t.assessors)||void 0===s?void 0:s.nodes[0];return(null===a||void 0===a?void 0:a.id)?Object(n.a)(Object(n.a)({},e),{},Object(f.a)({},a.id,t)):e}),{});return Object(l.jsx)(l.Fragment,{children:a.map((function(t,n){var a,c,u,d,m,p,j,b=null===(a=i[t.id])||void 0===a?void 0:a.status;s.status!==h.AssessmentStatus.VALIDATING&&s.status!==h.AssessmentStatus.CLOSED&&s.status!==h.AssessmentStatus.CANCELED||b&&b!==U.AssessmentRowStatus.Pending?p=(null===(j=i[t.id])||void 0===j?void 0:j.status)||h.AssessmentRowStatus.PENDING:p="notCompleted";var f=Z({evaluatedUser:s.evaluatedUser,user:t,managers:s.evaluatedUser.managers});return Object(l.jsxs)(l.Fragment,{children:[Object(l.jsx)(r.DesktopOrTablet,{children:Object(l.jsxs)(r.Line,{justifyContent:"space-between",borderTop:0!==n?"1px solid":"",borderColor:"grey.3",width:"100%",alignItems:"center",py:0,children:[Object(l.jsx)(X,{width:.3,user:t,assessorLabel:f,mr:1}),Object(l.jsx)(r.Box,{width:.2,minWidth:175,children:Object(l.jsx)(y.AssessmentStatus,{status:p})}),Object(l.jsx)(r.Box,{width:.2,children:(null===(c=i[t.id])||void 0===c?void 0:c.updatedAt)?Object(l.jsx)(r.Text,{fontSize:"small",children:e("two_points",{phrase:e("last_update")})+" "+Object(N.localeMoment)(null===(u=i[t.id])||void 0===u?void 0:u.updatedAt).format("DD/MM/YYYY, HH:mm")}):Object(l.jsx)(r.Text,{fontSize:"small",color:"grey.6",children:e("not_completed_yet")})}),Object(l.jsx)(r.Box,{width:.3,children:o===t.id&&s.status===h.AssessmentStatus.ONGOING&&Object(l.jsx)(r.Button,{as:F.Link,to:V.b.USER_PROFILE_ASSESSMENT_SKILLS_VALIDATION.getRoute({userId:s.evaluatedUser.id,assessmentId:s.id,assessorId:t.id}),appearance:"outline",children:p===h.AssessmentRowStatus.DONE?e("edit"):e("complete_assessment")})})]},t.id)}),Object(l.jsx)(r.Mobile,{children:Object(l.jsxs)(r.Box,{width:"100%",borderTop:0!==n?"1px solid":"",borderColor:"grey.3",pt:0!==n?2:null,pb:0===n?2:null,children:[Object(l.jsxs)(r.Line,{width:"100%",justifyContent:"space-between",mb:2,children:[Object(l.jsx)(X,{user:t,assessorLabel:f,mr:1}),Object(l.jsx)(r.Box,{children:Object(l.jsx)(y.AssessmentStatus,{status:p})})]}),Object(l.jsx)(r.Box,{width:"100%",children:(null===(d=i[t.id])||void 0===d?void 0:d.updatedAt)?Object(l.jsx)(r.Text,{fontSize:"medium",children:e("two_points",{phrase:e("last_update")})+" "+Object(N.localeMoment)(null===(m=i[t.id])||void 0===m?void 0:m.updatedAt).format("DD/MM/YYYY, HH:mm")}):Object(l.jsx)(r.Text,{fontSize:"medium",color:"grey.6",children:e("not_completed_yet")})}),o===t.id&&s.status===h.AssessmentStatus.ONGOING&&Object(l.jsx)(r.Button,{as:F.Link,to:V.b.USER_PROFILE_ASSESSMENT_SKILLS_VALIDATION.getRoute({userId:s.evaluatedUser.id,assessmentId:s.id,assessorId:t.id}),appearance:"outline",children:p===h.AssessmentRowStatus.DONE?e("edit"):e("complete_assessment")})]})})]})}))})},K=Object(c.default)(r.Text)((function(){return{padding:0,":hover":{textDecoration:"underline",background:"initial"}}})),X=function(e){var t=e.user,s=e.assessorLabel,o=Object(a.a)(e,J),i=Object(r.useTranslate)();return Object(l.jsxs)(r.Line,Object(n.a)(Object(n.a)({},o),{},{children:[Object(l.jsx)(y.UserAvatar,{user:t,mr:1}),Object(l.jsxs)(r.Column,{alignItems:"flex-start",children:[Object(l.jsx)(K,{fontWeigt:"semiBold",as:F.Link,to:V.b.USER_PROFILE.getRoute({userId:t.id}),target:"_blank",children:t.displayName}),Object(l.jsx)(r.Text,{color:"grey.6",textTransform:"uppercase",fontSize:"small",fontWeight:"semiBold",children:i(s)})]})]}))},Z=function(e){var t=e.user,s=e.evaluatedUser,n=e.managers;return t.id===s.id?"self_assessment_title":n.find((function(e){return e.id===t.id}))?"manager_title":"peer_title"},$=["assessmentType"],ee=function(e){var t=e.assessmentType,s=Object(a.a)(e,$);switch(t){case h.AssessmentType.SHARED_FORM:return Object(l.jsx)(r.Box,Object(n.a)(Object(n.a)({},s),{},{children:Object(l.jsx)(H,{})}));case h.AssessmentType.INDIVIDUAL_FORMS:return Object(l.jsx)(r.Box,Object(n.a)(Object(n.a)({},s),{},{children:Object(l.jsx)(Q,{})}))}},te=["title","users","onAdd","onRemove","isEditable"],se=function(e){var t=e.title,s=e.users,o=void 0===s?[]:s,i=e.onAdd,c=e.onRemove,u=e.isEditable,d=void 0!==u&&u,m=Object(a.a)(e,te),p=Object(r.useResponsive)().isMobile;return Object(l.jsxs)(r.Column,Object(n.a)(Object(n.a)({alignItems:"flex-start"},m),{},{children:[Object(l.jsx)(r.Text,{fontWeight:"semiBold",mb:2,children:t}),o.length>0&&Object(l.jsx)(r.Box,{mb:2,children:o.map((function(e){return Object(l.jsx)(y.UserBasicInfo,{size:p?"medium":"small",user:{id:e.id,displayName:e.displayName,avatarURL:e.avatarURL,familyName:e.familyName,givenName:e.givenName},mb:1},e.id)}))}),d&&Object(l.jsx)(y.UsersListEditable,{users:o,onAdd:i,onRemove:c})]}))},ne=["assessors","assessmentType","assessmentStatus"],ae=function(e){var t=e.assessors,s=e.assessmentType,i=e.assessmentStatus,c=Object(a.a)(e,ne),u=Object(r.useTranslate)(),d=Object(S.useResourceAssessmentDetailContext)(),m=d.addAssessmentUser,j=d.removeAssessmentUser,f=d.isValidator,O=d.capabilities,v=Object(o.useMemo)((function(){return i===h.AssessmentStatus.PLANNED||i===h.AssessmentStatus.ONGOING}),[i]),x=O.canUpdate||f;return Object(l.jsxs)(p,Object(n.a)(Object(n.a)({number:2,titleElement:Object(l.jsx)(b,{title:u("evaluation_content")})},c),{},{children:[Object(l.jsx)(ee,{assessmentType:s,mb:[2,null]}),Object(l.jsx)(se,{title:u("assessor",10),users:t,onAdd:function(e){m("assessor",e)},onRemove:function(e){j("assessor",e)},isEditable:v&&x})]}))},oe=s(838),ie=s(188),re=["title","titleId"];function ce(){return(ce=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(e[n]=s[n])}return e}).apply(this,arguments)}function le(e,t){if(null==e)return{};var s,n,a=function(e,t){if(null==e)return{};var s,n,a={},o=Object.keys(e);for(n=0;n<o.length;n++)s=o[n],t.indexOf(s)>=0||(a[s]=e[s]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)s=o[n],t.indexOf(s)>=0||Object.prototype.propertyIsEnumerable.call(e,s)&&(a[s]=e[s])}return a}function ue(e,t){var s=e.title,n=e.titleId,a=le(e,re);return o.createElement("svg",ce({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1000 1000",ref:t,"aria-labelledby":n},a),s?o.createElement("title",{id:n},s):null,">",o.createElement("path",{d:"M500 68.498C262.132 68.498 68.498 262.132 68.498 500c0 237.868 193.634 431.502 431.502 431.502 237.868 0 431.502-193.634 431.502-431.502 0-237.868-193.634-431.502-431.502-431.502zm0 75c197.335 0 356.502 159.167 356.502 356.502S697.335 856.502 500 856.502 143.498 697.335 143.498 500 302.665 143.498 500 143.498zM456.979 288.77v74.12h75v-74.12h-75zm1.974 117.562V711.23h71.053V406.332h-71.053z",style:{lineHeight:"normal",textIndent:0,textAlign:"start",textDecorationLine:"none",textDecorationStyle:"solid",textDecorationColor:"#000",textTransform:"none",blockProgression:"tb",whiteSpace:"normal",isolation:"auto",mixBlendMode:"normal",solidColor:"#000",solidOpacity:1},color:"#000",fontWeight:400,fontFamily:"sans-serif",overflow:"visible",fillRule:"evenodd",strokeWidth:75}))}var de=o.forwardRef(ue),me=(s.p,["validatedSkills","assessmentStatus"]),pe=["text"],je=function(e){var t=e.validatedSkills,s=void 0===t?[]:t,o=e.assessmentStatus,i=Object(a.a)(e,me),c=Object(r.useTranslate)();if(!s.length)return null;var u=o===h.AssessmentStatus.CLOSED?c("user_profile_has_been_updated_with_these_values"):c("user_profile_will_be_updated_with_these_values"),d=s.map((function(e){var t;return(null===(t=e.qualifiers)||void 0===t?void 0:t.length)||0})),m=Math.max.apply(Math,Object(ie.a)(d));return Object(l.jsxs)(r.Box,Object(n.a)(Object(n.a)({},i),{},{children:[Object(l.jsx)(r.Box,{px:2,pb:1,children:s.map((function(e,t){return Object(l.jsxs)(r.Box,{py:0,mb:1,display:["flex","grid"],flexDirection:["column",null],gridTemplateColumns:"200px repeat("+m+", 150px)",alignItems:"start",children:[Object(l.jsxs)(r.Line,{mr:3,children:[Object(l.jsx)(r.Icon,{as:Object(y.getIconComponent)(e.skill.logo),color:e.skill.color,mr:1,size:16}),Object(l.jsx)(r.Text,{children:e.skill.name})]}),e.qualifiers.length>0&&e.qualifiers.map((function(e){return Object(l.jsx)(y.Qualifier,{qualifier:e.qualifier,value:e.value,mx:1,mb:[2,null]},e.qualifier.id)}))]},e.skill.id)}))}),Object(l.jsx)(be,{text:u})]}))},be=function(e){var t=e.text,s=Object(a.a)(e,pe);return Object(l.jsxs)(r.Line,Object(n.a)(Object(n.a)({},s),{},{children:[Object(l.jsx)(r.Box,{width:20,height:20,borderRadius:20,bg:"grey.2",mr:1,children:Object(l.jsx)(r.Icon,{as:de,size:18})}),Object(l.jsx)(r.Text,{fontSize:"small",children:t})]}))},fe=["assessmentStatus"],Oe=["assessmentId","assessmentStatus","isSkillsScopeEmpty","isAValidator"],ve=function(e){var t=e.assessmentStatus,s=Object(a.a)(e,fe),i=Object(r.useTranslate)(),c=Object(S.useResourceAssessmentDetailContext)(),u=c.validators,d=c.assessment,m=c.isValidator,j=c.isSkillsScopeEmpty,f=c.capabilities,O=c.addAssessmentUser,v=c.removeAssessmentUser,x=Object(o.useMemo)((function(){return t===h.AssessmentStatus.PLANNED||t===h.AssessmentStatus.ONGOING}),[t]),A=f.canUpdate||m;return d?Object(l.jsxs)(p,Object(n.a)(Object(n.a)({number:3,titleElement:Object(l.jsx)(b,{title:i("skills_evaluation")})},s),{},{children:[Object(l.jsx)(xe,{assessmentId:d.id,assessmentStatus:d.status,isAValidator:m,isSkillsScopeEmpty:j,mb:[2,null]}),Object(l.jsx)(se,{title:i("validator",10),users:u,onAdd:function(e){O("validator",e)},onRemove:function(e){v("validator",e)},isEditable:x&&A})]})):null},xe=function(e){var t=e.assessmentId,s=e.assessmentStatus,o=(e.isSkillsScopeEmpty,e.isAValidator),i=Object(a.a)(e,Oe),c=Object(r.useTranslate)(),u=Object(S.useResourceAssessmentDetailContext)().updateAssessmentValidatedSkills,d=Object(oe.g)({assessmentId:t}),m=d.validatedSkills,p=d.isLoading,j=s!==h.AssessmentStatus.ONGOING;if(p)return Object(l.jsx)(r.Loader,{});var b="undefined"!==typeof m&&m.length>0,f=o&&!j;return b||f?Object(l.jsxs)(r.Box,Object(n.a)(Object(n.a)({},i),{},{children:[b&&Object(l.jsxs)(l.Fragment,{children:[Object(l.jsx)(he,{assessmentStatus:s}),Object(l.jsx)(je,{validatedSkills:m,assessmentStatus:s,mb:2})]}),f&&Object(l.jsx)(r.Button,{onClick:u,children:c(b?"edit_assessed_skills":"set_skills_to_update")})]})):Object(l.jsx)(r.Text,{children:c("no_assessement_result_yet")})},he=function(e){var t=e.assessmentStatus,s=Object(r.useTranslate)(),n=t===h.AssessmentStatus.CLOSED?s("two_points",{phrase:s("assessment_has_updated_skills_description")}):s("two_points",{phrase:s("assessment_will_update_skills_description")});return Object(l.jsx)(r.Text,{fontWeight:"bold",mb:1,children:n})},Ae=s(860),ge=s(788),Se=["link","createdAt","onDelete","isDeleting"],Ce=function(e){var t=e.link,s=e.createdAt,i=e.onDelete,c=e.isDeleting,u=void 0!==c&&c,d=Object(a.a)(e,Se),m=Object(o.useState)(!1),p=Object(C.a)(m,2),j=p[0],b=p[1];return Object(l.jsxs)(r.Line,Object(n.a)(Object(n.a)({height:22,onMouseEnter:function(){b(!0)},onMouseLeave:function(){b(!1)},mr:4},d),{},{children:[Object(l.jsx)(r.FileName,{url:t,mr:1}),Object(l.jsx)(r.Text,{fontSize:"tiny",mr:1,children:Object(N.localeMoment)(s).format("DD/MM/YYYY HH:mm")}),j&&"undefined"!==typeof i&&!u&&Object(l.jsx)(r.IconButton,{iconAs:Ae.a,onClick:function(){i&&i()},iconSize:18,accent:"black"}),u&&Object(l.jsx)(r.Icon,{as:ge.a})]}))},ye=["canGenerate","canUpload","reportFiles","onGenerate","onUpload","onDelete","isUploading","isDeleting"],_e=Object(c.default)("input")((function(){return{width:1,height:1,position:"absolute"}})),Te=function(e){var t=e.canGenerate,s=e.canUpload,c=e.reportFiles,u=e.onGenerate,d=e.onUpload,m=e.onDelete,p=e.isUploading,j=void 0!==p&&p,b=e.isDeleting,f=void 0!==b&&b,O=Object(a.a)(e,ye),h=Object(o.useState)(),A=Object(C.a)(h,2),g=A[0],S=A[1],y=Object(r.useSwitch)(!1),_=y.active,T=y.on,k=y.off,R=Object(r.useSwitch)(!1),w=Object(r.useTranslate)({capitalize:!0}),D=Object(o.useRef)(null),I=Object(o.useMemo)((function(){return"undefined"!==typeof m&&!0===s}),[m,s]);Object(o.useEffect)((function(){"undefined"!==typeof g?R.on():R.off()}),[g]);var E=function(){var e=Object(x.a)(v.a.mark((function e(t){var s,n;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:"undefined"!==typeof(n=null===(s=t.target.files)||void 0===s?void 0:s[0])&&"undefined"!==typeof d&&d(n);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),L=function(e){return function(){S(e)}},M=i.a.useMemo((function(){return"undefined"!==typeof c&&c.length>0?c.filter((function(e,t,s){return"undefined"===typeof e.documentTemplate||!s.some((function(t){var s,n;return(null===(s=t.documentTemplate)||void 0===s?void 0:s.link)===(null===(n=e.documentTemplate)||void 0===n?void 0:n.link)&&Object(N.localeMoment)(e.createdAt).isBefore(Object(N.localeMoment)(t.createdAt))}))})).map((function(e){var t="undefined"===typeof e.documentTemplate;return Object(n.a)(Object(n.a)({},e),{},{canDelete:I&&t})})):[]}),[c,I]);return Object(l.jsxs)(l.Fragment,{children:[Object(l.jsxs)(r.Line,Object(n.a)(Object(n.a)({position:"relative"},O),{},{children:[s&&Object(l.jsx)(_e,{type:"file",ref:D,onChange:E}),M.length>0?Object(l.jsxs)(r.Column,{alignItems:"flex-start",children:[M.map((function(e){return Object(l.jsx)(Ce,{link:e.link,createdAt:e.createdAt,onDelete:!0===e.canDelete?L({link:e.link,name:e.name}):void 0,width:"100%",mb:1},"reportFile_".concat(e.createdAt))})),(t||s)&&Object(l.jsxs)(r.MenuSelect.Target,{children:[Object(l.jsx)(r.TextButton,{onClick:T,mt:0,children:w("add_a_something",{object:w("a_document").toLowerCase()})}),Object(l.jsxs)(r.MenuSelect,{onClose:k,isOpened:_,children:[t&&Object(l.jsx)(r.MenuOption,{onClick:function(){k(),u&&u()},children:w("generate_a_report_action")}),s&&Object(l.jsx)(r.MenuOption,{onClick:function(){k(),D.current&&D.current.click()},children:w("upload_a_report_file")})]})]})]}):Object(l.jsxs)(l.Fragment,{children:[Object(l.jsxs)(r.Text,{mr:1,children:[w("report_file_has_not_yet_been_generated"),"."]}),t&&Object(l.jsx)(r.Button,{onClick:u,mr:s?20:void 0,children:w("generate_a_report_action")}),s&&Object(l.jsx)(r.Button,{onClick:function(){D.current&&D.current.click()},appearance:"outline",isLoading:j,children:w("upload_a_report_file")})]})]})),Object(l.jsx)(r.ConfirmModal,{isOpened:R.active,onCancel:R.off,onConfirm:function(){m&&"undefined"!==typeof g&&m(g.link).then((function(){R.off()}))},isLoading:f,children:Object(l.jsx)(r.Text,{children:w("confirm_delete_object",{object:null===g||void 0===g?void 0:g.name})})})]})},ke=["isSkillsScopeEmpty","isValidator"],Re=function(e){e.isSkillsScopeEmpty;var t=e.isValidator,s=Object(a.a)(e,ke),o=Object(r.useTranslate)(),i=Object(S.useResourceAssessmentDetailContext)().openValidateAssessmentSkillsModal,c=Object(oe.e)(),u=c.isShowReportFile,d=c.reportFiles,m=c.canGenerate,p=c.canUpload,j=c.isUploading,b=c.isDeleting,f=c.onGenerateReportFile,O=c.onUploadReportFile,v=c.onDeleteReportFile;return Object(l.jsx)(l.Fragment,{children:Object(l.jsxs)(r.Column,Object(n.a)(Object(n.a)({alignItems:"flex-start"},s),{},{children:[u&&Object(l.jsx)(Te,{reportFiles:d,canGenerate:m,canUpload:p,onGenerate:f,onDelete:v,onUpload:O,isUploading:j,isDeleting:b,my:20}),Object(l.jsx)(r.Text,{mb:2,children:o("the_assessment_is_ongoing")}),t&&Object(l.jsx)(r.Button,{onClick:function(){i()},children:o("validate_assessment")})]}))})},we=s(813),De=s(793),Ie=["approvers","onApprove"],Ee=function(e){var t=e.approvers,s=e.onApprove,o=Object(a.a)(e,Ie),i=Object(r.useTranslate)(),c=Object(B.useAppContext)().user.id;return Object(l.jsxs)(r.Box,Object(n.a)(Object(n.a)({},o),{},{children:[Object(l.jsx)(r.Text,{fontWeight:"bold",mb:1,children:i("two_points",{phrase:i("approver",10)})}),Object(l.jsx)(r.Box,{children:null===t||void 0===t?void 0:t.map((function(e){return Object(l.jsxs)(r.Line,{children:[Object(l.jsx)(y.UserAvatar,{user:{displayName:e.displayName,avatarURL:e.avatarURL,familyName:e.familyName,givenName:e.givenName},mr:2}),e.hasApproved?Object(l.jsxs)(l.Fragment,{children:[Object(l.jsx)(r.Box,{bg:"success.0",p:0,mr:2,borderRadius:2,children:Object(l.jsx)(r.Icon,{as:De.a,size:23,m:0})}),Object(l.jsx)(r.Text,{textTransform:"uppercase",fontWeight:"bold",mr:3,children:i("assessment_approved")})]}):Object(l.jsxs)(r.Line,{my:0,children:[Object(l.jsx)(r.Box,{bg:"grey.2",p:0,mr:2,borderRadius:2,children:Object(l.jsx)(r.Icon,{as:we.a,size:23,m:0})}),Object(l.jsx)(r.Text,{textTransform:"uppercase",fontWeight:"bold",mr:3,children:i("approval_pending")}),e.id===c&&Object(l.jsx)(r.Button,{onClick:s,children:i("approve")})]})]},e.id)}))})]}))},Le=["assessmentId"],Me=function(e){e.assessmentId;var t=Object(a.a)(e,Le),s=Object(r.useTranslate)({capitalize:!0}),i=Object(o.useState)(!1),c=Object(C.a)(i,2),u=c[0],d=c[1],m=Object(S.useResourceAssessmentDetailContext)(),p=m.approvers,j=m.isValidator,b=m.isAllApproved,f=m.openApproveAssessmentModal,O=m.openUnapproveAssessmentModal,v=m.openCloseAssessmentModal,x=m.capabilities,h=Object(oe.e)(),A=h.isShowReportFile,g=h.reportFiles,y=h.isUploading;return Object(o.useEffect)((function(){d(!b)}),[b]),Object(l.jsxs)(r.Box,Object(n.a)(Object(n.a)({display:"flex",flexDirection:"column"},t),{},{children:[A&&Object(l.jsx)(Te,{reportFiles:g,canGenerate:!1,canUpload:!1,isUploading:y,my:20}),Object(l.jsx)(Ee,{approvers:p,onApprove:function(){f()}}),Object(l.jsx)(r.Box,{mt:1,children:Object(l.jsx)(Fe,{isAllApproved:b,isValidator:j,onCloseAssessment:function(){v()},isCloseAssessmentButtonDisabled:u})}),(j||x.canUpdate)&&Object(l.jsx)(r.Box,{mt:1,children:Object(l.jsx)(r.TextButton,{onClick:O,color:"primary",children:s("unapprove_assessment")})})]}))},Fe=function(e){var t=e.isAllApproved,s=e.isValidator,n=e.isCloseAssessmentButtonDisabled,a=e.onCloseAssessment,o=Object(r.useTranslate)({capitalize:!0});return t?s?Object(l.jsx)(r.Button,{onClick:a,disabled:n,children:o("close_assessment_and_update_skills")}):Object(l.jsx)(r.Text,{children:o("awaiting_validator_close")}):Object(l.jsx)(r.Text,{children:o("awaiting_all_approvers_approved")})},Ne=["approvers"],Ue=function(e){var t=e.approvers,s=Object(a.a)(e,Ne),o=Object(r.useTranslate)(),i=Object(oe.e)(),c=i.isShowReportFile,u=i.reportFiles,d=i.isUploading,m=Object(S.useResourceAssessmentDetailContext)(),p=m.isValidator,j=m.capabilities,b=m.onStartNewAssessment;return Object(l.jsxs)(l.Fragment,{children:[c&&Object(l.jsx)(Te,{reportFiles:u,canGenerate:!1,canUpload:!1,isUploading:d,my:20}),Object(l.jsx)(Ee,Object(n.a)({approvers:t},s)),(p||j.canUpdate)&&Object(l.jsx)(r.Line,{mt:2,children:Object(l.jsx)(r.Button,{onClick:b,appearance:"clean",children:o("plan_new_identical_assessment")})})]})},Be=["assessmentStatus"],Ve=function(e){var t=e.assessmentStatus,s=Object(a.a)(e,Be),o=Object(r.useTranslate)(),i=Object(S.useResourceAssessmentDetailContext)(),c=i.assessmentId,u=i.isValidator,d=i.isSkillsScopeEmpty,m=i.approvers,p=i.approveAssessment;switch(t){case h.AssessmentStatus.PLANNED:return Object(l.jsx)(r.Column,Object(n.a)(Object(n.a)({alignItems:"flex-start"},s),{},{children:Object(l.jsx)(r.Text,{mb:2,children:o("the_assessment_is_planned")})}));case h.AssessmentStatus.ONGOING:return Object(l.jsx)(Re,Object(n.a)({isValidator:u,isSkillsScopeEmpty:d,pb:4},s));case h.AssessmentStatus.VALIDATING:return Object(l.jsx)(Me,Object(n.a)({assessmentId:c,pb:4},s));case h.AssessmentStatus.CLOSED:return Object(l.jsx)(Ue,{approvers:m,onApprove:function(){p()}});default:return null}},Ge=function(e){var t=e.approvers,s=e.assessmentStatus,n=Object(r.useTranslate)(),a=Object(S.useResourceAssessmentDetailContext)(),i=a.capabilities,c=a.isValidator,u=a.addAssessmentUser,d=a.removeAssessmentUser,m=Object(o.useMemo)((function(){return s===h.AssessmentStatus.PLANNED||s===h.AssessmentStatus.ONGOING}),[s]),j=i.canUpdate||c;return Object(l.jsxs)(p,{number:4,titleElement:Object(l.jsx)(b,{title:n("assessment_validation")}),mb:2,children:[Object(l.jsx)(Ve,{assessmentStatus:s}),Object(l.jsx)(se,{title:n("approver",10),users:t,onAdd:function(e){u("approver",e)},onRemove:function(e){d("approver",e)},isEditable:m&&j})]})},ze=["documentTemplates","value","onChange","isExistingReportFile"],Pe=function(e){var t=e.documentTemplates,s=e.value,i=e.onChange,c=e.isExistingReportFile,u=Object(a.a)(e,ze),d=Object(r.useTranslate)({capitalize:!0}),m=Object(o.useMemo)((function(){return t.map((function(e){return{label:e.name,value:e.link}}))}),[t]),p=m.length>1;return Object(l.jsxs)(r.Box,Object(n.a)(Object(n.a)({},u),{},{children:[Object(l.jsx)(r.SelectField,{label:d("report_file_format"),name:"report_file",value:s.link,onChange:function(e){var s=t.find((function(t){return t.link===e}));"undefined"!==typeof s&&i(s)},source:m,disabled:!p}),c&&Object(l.jsxs)(r.Text,{mt:20,children:[d("previous_report_file_will_be_overriden_warning_msg"),"."]})]}))},We=function(e){var t=e.assessmentId,s=e.isOpened,n=e.onClose,a=e.onStartNewAssessment,i=e.onCloseAssessment,c=e.isEnabledGenerateReport,u=e.isExistingReportFile,d=e.documentTemplates,m=Object(o.useState)(!1),p=Object(C.a)(m,2),j=p[0],b=p[1],f=Object(o.useState)(),O=Object(C.a)(f,2),A=O[0],g=O[1],S=Object(r.useTranslate)(),y=Object(oe.g)({assessmentId:t}),_=y.validatedSkills,T=y.isLoading,k=Object(o.useState)(!1),R=Object(C.a)(k,2),w=R[0];R[1];Object(o.useEffect)((function(){b(!!c)}),[c]),Object(o.useEffect)((function(){"undefined"!==typeof d&&d.length>0?g(d[0]):g(void 0)}),[d]);var D=function(){var e=Object(x.a)(v.a.mark((function e(){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i({documentTemplate:j?A:void 0});case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(l.jsx)(r.Modal,{isOpened:s,onClose:n,width:880,height:"95%",children:Object(l.jsxs)(r.Box,{display:"flex",flexDirection:"column",height:"100%",p:1,overflowY:"auto",children:[Object(l.jsxs)(r.Box,{flexGrow:1,mb:3,children:[Object(l.jsx)(r.Text,{fontSize:"big",fontWeight:"bold",mb:3,children:S("close_assessment_and_update_skills")}),Object(l.jsx)(r.Text,{mb:2,children:S("two_points",{phrase:S("the_following_skills_will_be_updated")})}),Object(l.jsx)(r.Text,{fontWeight:"bold",fontSize:"large",mt:2,children:S("skills_to_update")}),T||"undefined"===typeof _?Object(l.jsx)(r.Loader,{}):Object(l.jsx)(je,{validatedSkills:_,assessmentStatus:h.AssessmentStatus.VALIDATING}),Object(l.jsx)(r.Box,{display:"flex",justifyContent:"start",flexDirection:"column",mt:1,children:c&&Object(l.jsxs)(l.Fragment,{children:[Object(l.jsxs)(r.Text,{as:"label",children:[Object(l.jsx)(r.Checkbox,{mr:1,checked:j,onChange:function(e){b(!0===e)}}),S("generate_a_report_action")]}),j&&"undefined"!==typeof A&&"undefined"!==typeof d&&Object(l.jsx)(Pe,{value:A,onChange:function(e){g(e)},documentTemplates:d,isExistingReportFile:u,mt:20})]})})]}),Object(l.jsxs)(r.Line,{justifyContent:"flex-end",children:[Object(l.jsx)(r.Button,{onClick:n,appearance:"outline",accent:"grey",mr:1,children:S("cancel")}),Object(l.jsx)(r.Button,{onClick:function(){a()},appearance:"outline",mr:1,children:S("close_assessment_and_schedule_new_one")}),Object(l.jsx)(r.Button,{onClick:D,isLoading:w,children:S("finish")})]})]})})},Ye=function(e){var t=e.title,s=e.text,n=e.confirmLabel,a=e.cancelLabel,o=e.isOpened,i=e.onConfirm,c=e.onCancel,u=e.isLoading;return Object(l.jsx)(r.ConfirmModal,{isOpened:o,onConfirm:i,onCancel:c,confirmLabel:n,cancelLabel:a,isLoading:u,children:Object(l.jsxs)(r.Box,{display:"flex",flexDirection:"column",children:[Object(l.jsx)(r.Text,{fontSize:"huge",fontWeight:"bold",mb:3,children:t}),Object(l.jsx)(r.Text,{children:s})]})})},He=function(e){var t=e.isOpened,s=e.onConfirm,n=e.onCancel,a=e.isLoading,o=Object(r.useTranslate)({capitalize:!0});return Object(l.jsx)(Ye,{title:o("approve_assessment"),text:o("approve_assessment_confirm_message"),confirmLabel:o("approve"),cancelLabel:o("cancel"),isOpened:t,onConfirm:s,onCancel:n,isLoading:a})},Je=function(e){var t=e.isOpened,s=e.onConfirm,n=e.onCancel,a=e.isLoading,o=Object(r.useTranslate)({capitalize:!0});return Object(l.jsx)(Ye,{title:o("cancel_assessment"),text:o("cancel_assessment_confirm_message"),confirmLabel:o("confirm"),cancelLabel:o("cancel"),isOpened:t,onConfirm:s,onCancel:n,isLoading:a})},Qe=function(e){var t=e.isOpened,s=e.onConfirm,n=e.onCancel,a=e.isLoading,o=Object(r.useTranslate)({capitalize:!0});return Object(l.jsx)(Ye,{title:o("delete"),text:o("delete_assessment_confirm_message"),confirmLabel:o("delete"),cancelLabel:o("cancel"),isOpened:t,onConfirm:s,onCancel:n,isLoading:a})},qe=function(e){var t=e.isOpened,s=e.onConfirm,n=e.onCancel,a=e.isLoading,o=Object(r.useTranslate)({capitalize:!0});return Object(l.jsx)(Ye,{title:o("reopen_assessment"),text:o("reopen_assessment_confirm_message"),confirmLabel:o("confirm"),cancelLabel:o("cancel"),isOpened:t,onConfirm:s,onCancel:n,isLoading:a})},Ke=function(e){var t=e.isOpened,s=e.onConfirm,n=e.onCancel,a=e.isLoading,o=Object(r.useTranslate)({capitalize:!0});return Object(l.jsx)(Ye,{title:o("unapprove_assessment"),text:o("unapprove_assessment_confirm_message"),confirmLabel:o("confirm"),cancelLabel:o("cancel"),isOpened:t,onConfirm:s,onCancel:n,isLoading:a})},Xe=function(e){var t=e.isBlocked,s=e.routingMessage,n=e.loaderMessage;return Object(o.useEffect)((function(){return t&&(window.onbeforeunload=function(e){return e.preventDefault(),e.stopPropagation(),!0}),function(){window.onbeforeunload=null}}),[t]),Object(l.jsxs)(l.Fragment,{children:[t&&Object(l.jsx)(r.LoadingOverlay,{message:n}),Object(l.jsx)(M.Prompt,{when:t,message:s})]})},Ze=s(774),$e=s(768),et=["text"],tt=function(e){var t=e.text,s=Object(a.a)(e,et);return Object(l.jsx)($e.a,Object(n.a)({image:Ze.a,text:t,maxWidth:200,maxHeight:200,py:4},s))},st=["title","text"],nt=function(e){return e.map((function(e){return e.displayName})).join(", ")},at=function(e){var t,s=e.assessmentId,n=e.isRescheduling,a=e.isOpened,i=e.onClose,c=e.onRescheduleAssessment,u=Object(N.localeMoment)().add(1,"d").hour(12),d=Object(o.useState)(u),m=Object(C.a)(d,2),p=m[0],j=m[1],b=Object(o.useState)(!0),f=Object(C.a)(b,2),O=f[0],h=f[1],A=Object(r.useTranslate)({capitalize:!0}),g=Object(U.useGetAssessmentSummaryQuery)({variables:{assessmentId:s}}),S=g.data,y=g.loading,_=Object(o.useMemo)((function(){if(null===S||void 0===S?void 0:S.assessment){var e,t="AssessmentSkillsFromList"===S.assessment.skillsScope.__typename?null===(e=S.assessment.skillsScope.selectedSkills)||void 0===e?void 0:e.map((function(e){return{name:e.name}})):void 0;return{assessmentName:S.assessment.name,evaluatedUserDisplayName:S.assessment.evaluatedUser.displayName,selectedSkills:t,assessors:S.assessment.assessors.nodes.map((function(e){return{displayName:e.displayName}})),validators:S.assessment.validators.nodes.map((function(e){return{displayName:e.displayName}})),approvers:S.assessment.approvers.nodes.map((function(e){return{displayName:e.displayName}}))}}}),[S]),T=function(){var e=Object(x.a)(v.a.mark((function e(){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:c({isCopyExistingContent:O,scheduledDate:Object(N.localeMoment)(p).toISOString()});case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(l.jsx)(r.Modal,{width:880,height:780,isOpened:a,onClose:i,children:y||!_?Object(l.jsx)(r.Loader,{}):Object(l.jsxs)(r.Column,{alignItems:"flex-start",p:1,height:"100%",children:[Object(l.jsx)(r.Line,{mb:3,children:Object(l.jsx)(r.Text,{fontSize:"huge",fontWeight:"bold",children:A("schedule_new_assessment")})}),Object(l.jsx)(r.Line,{mb:2,children:Object(l.jsx)(r.Text,{fontSize:"medium",children:A("two_points",{phrase:A("create_new_assessment_with_same_parameters")})})}),Object(l.jsxs)(r.Box,{mb:2,flexGrow:1,children:[Object(l.jsx)(ot,{title:A("type_title"),text:_.assessmentName}),Object(l.jsx)(ot,{title:A("evaluated_user"),text:_.evaluatedUserDisplayName}),Object(l.jsx)(ot,{title:A("asessor",10),text:nt(_.assessors)}),Object(l.jsx)(ot,{title:A("skills_targeted"),text:(t=_.selectedSkills||[],t.map((function(e){return e.name})).join(" / "))}),Object(l.jsx)(ot,{title:A("validator",10),text:nt(_.validators)}),Object(l.jsx)(ot,{title:A("approver",10),text:nt(_.approvers)})]}),Object(l.jsx)(r.Box,{flexGrow:1,children:Object(l.jsx)(r.Line,{mb:2,children:Object(l.jsxs)(r.Text,{as:"label",children:[Object(l.jsx)(r.Checkbox,{onChange:function(e){h(e)},checked:O}),Object(l.jsxs)(r.Text,{children:[A("copy_assessment_content"),Object(l.jsx)("br",{}),Object(l.jsx)(r.Text,{as:"span",fontWeight:"normal",color:"grey.6",mt:1,children:A("copy_assessment_content_description")})]})]})})}),Object(l.jsxs)(r.Box,{flexGrow:1,width:"100%",children:[Object(l.jsx)(r.Line,{mb:3,children:Object(l.jsxs)(r.Text,{as:"label",fontWeight:"bold",children:[A("two_points",{phrase:A("date")}),Object(l.jsx)(r.DatePicker,{min:Object(N.localeMoment)(u).format("YYYY-MM-DD"),value:p,onChange:j,ml:2})]})}),Object(l.jsx)(r.Separator,{width:"100%"})]}),Object(l.jsxs)(r.Line,{alignSelf:"flex-end",children:[Object(l.jsx)(r.Button,{appearance:"outline",accent:"grey",onClick:i,mr:2,children:A("cancel")}),Object(l.jsx)(r.Button,{onClick:T,isLoading:n,children:A("confirm")})]})]})})},ot=function(e){var t=e.title,s=e.text,o=Object(a.a)(e,st),i=Object(r.useTranslate)();return Object(l.jsxs)(r.Text,Object(n.a)(Object(n.a)({my:1},o),{},{children:[Object(l.jsxs)(r.Text,{as:"span",fontWeight:"bold",children:[i("two_points",{phrase:t})," "]}),Object(l.jsx)(r.Text,{as:"span",children:s})]}))},it=["documentTemplates","isExistingReportFile","onSubmit"],rt=function(e){var t=e.documentTemplates,s=e.isExistingReportFile,i=e.onSubmit,c=Object(a.a)(e,it),u=Object(o.useState)(!1),d=Object(C.a)(u,2),m=d[0],p=d[1],j=Object(o.useState)(t[0]),b=Object(C.a)(j,2),f=b[0],O=b[1],v=Object(r.useTranslate)({capitalize:!0});return Object(l.jsx)(B.FormContainerModal,Object(n.a)(Object(n.a)({},c),{},{title:v("generate_a_report_action"),confirmButtonLabel:v("create_resume"),onConfirm:function(){p(!0),i(f).then((function(){p(!1)})).catch((function(){return p(!1)}))},onClose:c.onCancel,isLoading:m,children:Object(l.jsx)(Pe,{documentTemplates:t,value:f,onChange:O,isExistingReportFile:s,mt:22,mb:27})}))},ct=["validatedSkills","isLoading","onValidateSkills","isButtonDisabled"],lt=function(e){var t=e.validatedSkills,s=e.isLoading,o=(e.onValidateSkills,e.isButtonDisabled,Object(a.a)(e,ct)),i=Object(r.useTranslate)();return s?Object(l.jsx)(r.Loader,{}):Object(l.jsx)(r.Box,Object(n.a)(Object(n.a)({},o),{},{children:"undefined"!==typeof t&&t.length>0?Object(l.jsx)(je,{validatedSkills:t,assessmentStatus:h.AssessmentStatus.ONGOING}):Object(l.jsxs)(r.Text,{color:"grey.6",ml:0,children:[i("no_skills_will_be_updated_warning"),"."]})}))},ut={isAutoClose:!0,isGenerateReport:!1,documentTemplate:void 0},dt=function(e,t){switch(t.type){case"setIsAutoClose":return!0===t.isAutoClose?Object(n.a)(Object(n.a)({},e),{},{isAutoClose:t.isAutoClose}):Object(n.a)(Object(n.a)({},e),{},{isAutoClose:t.isAutoClose,isGenerateReport:!1});case"setIsGenerateReport":return Object(n.a)(Object(n.a)({},e),{},{isGenerateReport:t.isGenerateReport});case"setDocumentTemplate":return Object(n.a)(Object(n.a)({},e),{},{documentTemplate:t.documentTemplate,isGenerateReport:!0});case"reset":return ut;default:return e}},mt=function(e){var t=e.assessmentId,s=e.isEnabledGenerateReport,n=e.isValidatingAssessment,a=e.isOpened,i=e.onClose,c=e.isDisabledValidateSkills,u=e.onValidateAssessment,d=e.documentTemplates,m=e.isExistingReportFile,p=Object(o.useReducer)(dt,ut),j=Object(C.a)(p,2),b=j[0],f=b.isAutoClose,O=b.isGenerateReport,v=b.documentTemplate,x=j[1],h=Object(r.useTranslate)(),A=Object(S.useResourceAssessmentDetailContext)().updateAssessmentValidatedSkills,g=Object(oe.g)({assessmentId:t}),y=g.validatedSkills,_=g.isLoading;Object(o.useEffect)((function(){a||x({type:"reset"})}),[a]),Object(o.useEffect)((function(){"undefined"!==typeof d&&d.length>0&&"undefined"===typeof v&&x({type:"setDocumentTemplate",documentTemplate:d[0]})}),[d]);return Object(l.jsx)(l.Fragment,{children:Object(l.jsx)(r.Modal,{isOpened:a,onClose:i,width:880,height:"95%",children:Object(l.jsxs)(r.Box,{p:1,display:"flex",flexDirection:"column",height:"100%",overflowY:"auto",children:[Object(l.jsxs)(r.Box,{flexGrow:1,children:[Object(l.jsx)(r.Text,{fontSize:"big",fontWeight:"bold",mb:3,children:h("validate_assessment_and_start_approval")}),Object(l.jsx)(r.Text,{fontSize:"large",ml:0,children:h("two_points",{phrase:h("validate_assessment_and_start_approval_description")})}),Object(l.jsx)(r.Text,{fontWeight:"bold",fontSize:"large",mt:2,children:h("skills_to_update")}),Object(l.jsx)(lt,{validatedSkills:y,isLoading:_,onValidateSkills:function(){i(),A()},isButtonDisabled:c,mt:1,mb:2}),Object(l.jsxs)(r.Text,{as:"label",children:[Object(l.jsx)(r.Checkbox,{checked:f,onChange:function(e){x({type:"setIsAutoClose",isAutoClose:!0===e})},mr:1}),h("close_automatically_once_everyone_has_approved")]}),Object(l.jsx)(r.Box,{display:"flex",justifyContent:"start",flexDirection:"column",mt:1,children:f&&s&&Object(l.jsxs)(l.Fragment,{children:[Object(l.jsxs)(r.Text,{as:"label",children:[Object(l.jsx)(r.Checkbox,{mr:1,checked:O,onChange:function(e){x({type:"setIsGenerateReport",isGenerateReport:!0===e})}}),h("generate_a_report_action")]}),O&&"undefined"!==typeof v&&"undefined"!==typeof d&&Object(l.jsx)(Pe,{value:v,onChange:function(e){x({type:"setDocumentTemplate",documentTemplate:e})},documentTemplates:d,isExistingReportFile:m,mt:20})]})})]}),Object(l.jsxs)(r.Line,{justifyContent:"flex-end",children:[Object(l.jsx)(r.Button,{appearance:"outline",onClick:i,mr:1,children:h("cancel")}),Object(l.jsx)(r.Button,{onClick:function(){u({isAutoClose:f,documentTemplate:O?v:void 0})},isLoading:n,ml:1,children:h("validate_assessment_and_start_approval")})]})]})})})}},1574:function(e,t,s){"use strict";s.r(t);var n=s(53),a=s(17),o=s(0),i=s(15),r=s(14),c=s(10),l=s(285),u=s(61),d=s(63),m=s(37),p=s(56),j=s(782),b=s(749),f=s(1),O=function(e){var t=e.canCancelAssessment,s=e.canReopenAssessment,n=e.canDeleteAssessment,a=e.onClickCancel,o=e.onClickReopen,i=e.onClickDelete,c=Object(r.useTranslate)({capitalize:!0}),l=Object(r.useSwitch)(!1),u=l.active,d=l.on,m=l.off,p=function(e){return function(){switch(m(),e){case"cancel":a&&a();break;case"reopen":o&&o();break;case"delete":i&&i()}}};return Object(f.jsxs)(r.MenuSelect.Target,{children:[Object(f.jsx)(r.IconButton,{iconAs:b.a,onClick:d,isActive:u}),Object(f.jsxs)(r.MenuSelect,{onClose:m,isOpened:u,children:[t&&Object(f.jsx)(r.MenuOption,{onClick:p("cancel"),children:c("cancel")}),s&&Object(f.jsx)(r.MenuOption,{onClick:p("reopen"),children:c("reopen")}),n&&Object(f.jsx)(r.MenuOption,{onClick:p("delete"),children:c("delete")})]})]})},v=["name","campaignName","status","startDate","updatedAt","updatedBy","onGoBack","linkToUpdatesHistory","canDeleteAssessment","canCancelAssessment","canReopenAssessment","onDeleteAssessment","onCancelAssessment","onReopenAssessment"],x=Object(u.default)(r.Link)((function(){return{cursor:"not-allowed"}})),h=function(e){var t=e.name,s=e.campaignName,n=e.status,i=e.startDate,c=e.updatedAt,u=e.updatedBy,b=e.onGoBack,h=e.linkToUpdatesHistory,A=e.canDeleteAssessment,g=e.canCancelAssessment,S=e.canReopenAssessment,C=e.onDeleteAssessment,y=e.onCancelAssessment,_=e.onReopenAssessment,T=Object(l.a)(e,v),k=Object(r.useTranslate)({capitalize:!0}),R=Object(o.useMemo)((function(){return A||g||S}),[A,g,S]);return Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)(r.DesktopOrTablet,{children:Object(f.jsxs)(r.Line,Object(a.a)(Object(a.a)({justifyContent:"space-between",alignItems:"center"},T),{},{children:[Object(f.jsxs)(r.Line,{alignItems:"center",children:[b&&Object(f.jsx)(r.IconButton,{iconAs:j.a,iconSize:20,mr:1,onClick:b}),Object(f.jsx)(r.Icon,{as:p.a,size:20,mr:12}),Object(f.jsx)(r.Text,{fontSize:"large",fontWeight:"bold",mr:20,children:t}),s&&Object(f.jsx)(r.Text,{fontSize:"large",color:"black.1",fontWeight:"bold",mr:20,children:s}),Object(f.jsx)(d.AssessmentStatus,{status:n,startDate:i,mr:20}),R&&Object(f.jsx)(O,{canCancelAssessment:g,canReopenAssessment:S,canDeleteAssessment:A,onClickCancel:y,onClickReopen:_,onClickDelete:C})]}),"undefined"!==typeof c&&"undefined"!==typeof u&&Object(f.jsxs)(r.Column,{alignItems:"flex-end",children:[Object(f.jsxs)(r.Text,{fontSize:"small",children:[k("last_update"),":"," ",Object(m.localeMoment)(c).format("DD/MM/YYYY")," ",k("by")," ",u.displayName]}),"undefined"!==typeof h&&Object(f.jsx)(x,{fontSize:"small",to:h,children:k("see_history")})]})]}))}),Object(f.jsx)(r.Mobile,{children:Object(f.jsxs)(r.Column,Object(a.a)(Object(a.a)({alignItems:"flex-start",p:2},T),{},{children:[Object(f.jsxs)(r.Line,{width:"100%",mb:2,children:[b&&Object(f.jsx)(r.IconButton,{iconAs:j.a,iconSize:20,mr:1,onClick:b}),Object(f.jsx)(r.Icon,{as:p.a,size:20,mr:12}),Object(f.jsxs)(r.Text,{fontSize:"large",fontWeight:"bold",mr:20,children:[t,"undefined"!==typeof s&&" - ".concat(s)]})]}),Object(f.jsxs)(r.Line,{width:"100%",justifyContent:"space-between",children:[Object(f.jsxs)(r.Line,{children:[Object(f.jsx)(d.AssessmentStatus,{status:n,startDate:i,mr:20}),R&&Object(f.jsx)(O,{canCancelAssessment:g,canReopenAssessment:S,canDeleteAssessment:A,onClickCancel:y,onClickReopen:_,onClickDelete:C})]}),"undefined"!==typeof c&&"undefined"!==typeof u&&Object(f.jsxs)(r.Column,{children:[Object(f.jsxs)(r.Text,{fontSize:"small",children:[k("last_update"),":"," ",Object(m.localeMoment)(c).format("DD/MM/YYYY")," ",k("by")," ",u.displayName]}),"undefined"!==typeof h&&Object(f.jsx)(x,{fontSize:"small",to:h,children:k("see_history")})]})]})]}))})]})},A=s(3),g=s(838),S=s(1142),C=Object(o.lazy)((function(){return Promise.resolve().then(s.bind(null,776))})),y=Object(o.lazy)((function(){return s.e(28).then(s.bind(null,1553))})),_=Object(o.lazy)((function(){return s.e(64).then(s.bind(null,1558))})),T={isOpenedConfirmCancelModal:!1,isOpenedConfirmReopenModal:!1,isOpenedConfirmDeleteModal:!1},k=function(e,t){switch(t.type){case"openConfirmCancelModal":return Object(a.a)(Object(a.a)({},e),{},{isOpenedConfirmCancelModal:!0,isOpenedConfirmDeleteModal:!1,isOpenedConfirmReopenModal:!1});case"closeConfirmCancelModal":return Object(a.a)(Object(a.a)({},e),{},{isOpenedConfirmCancelModal:!1});case"openConfirmDeleteModal":return Object(a.a)(Object(a.a)({},e),{},{isOpenedConfirmDeleteModal:!0,isOpenedConfirmCancelModal:!1,isOpenedConfirmReopenModal:!1});case"closeConfirmDeleteModal":return Object(a.a)(Object(a.a)({},e),{},{isOpenedConfirmDeleteModal:!1});case"openConfirmReopenModal":return Object(a.a)(Object(a.a)({},e),{},{isOpenedConfirmReopenModal:!0,isOpenedConfirmCancelModal:!1,isOpenedConfirmDeleteModal:!1});case"closeConfirmReopenModal":return Object(a.a)(Object(a.a)({},e),{},{isOpenedConfirmReopenModal:!1});default:return e}};t.default=function(e){var t=e.tabsOptions,s=Object(o.useReducer)(k,T),a=Object(n.a)(s,2),l=a[0],u=l.isOpenedConfirmCancelModal,d=l.isOpenedConfirmDeleteModal,m=l.isOpenedConfirmReopenModal,p=a[1],j=Object(r.useTranslate)({capitalize:!0}),b=Object(i.useParams)(),O=b.userId,v=b.assessmentId,x=Object(i.useHistory)(),R=Object(i.useLocation)().pathname,w=Object(c.useAppContext)(),D=w.user,I=w.getErrorMessage,E=Object(r.useAlert)(),L=Object(g.b)({assessmentId:v,currentUserId:D.id}).assessmentHeaderInfos,M=Object(g.c)({assessmentId:v,canDelete:null===L||void 0===L?void 0:L.canDelete,canUpdate:null===L||void 0===L?void 0:L.canUpdate,isValidator:null===L||void 0===L?void 0:L.isValidator,status:null===L||void 0===L?void 0:L.status}),F=M.canCancelAssessment,N=M.canDeleteAssessment,U=M.canReopenAssessment,B=M.cancelAssessment,V=M.deleteAssessment,G=M.isCancelingAssessment,z=M.isDeletingAssessment,P=M.isReopeningAssessment,W=M.reopenAssessment,Y=function(){p({type:"closeConfirmCancelModal"})},H=function(){p({type:"closeConfirmDeleteModal"})},J=function(){p({type:"closeConfirmReopenModal"})};return Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)(c.PageLayout,{overflow:"auto",position:"relative",children:Object(f.jsx)(r.Box,{width:"100%",height:"100%",children:Object(f.jsx)(r.ErrorBoundary,{onReset:function(){window.location.reload()},children:Object(f.jsxs)(r.Column,{width:"100%",height:"100%",alignItems:"flex-start",children:["undefined"!==typeof L?Object(f.jsx)(h,{name:L.name||"",campaignName:L.campaignName,status:L.status,startDate:L.startDate||"",updatedAt:L.updatedAt,updatedBy:L.updatedBy,onGoBack:function(){var e=Object(i.matchPath)(R,A.b.USER_PROFILE_ASSESSMENT.path),t=Object(i.matchPath)(R,A.b.USER_PROFILE_ASSESSMENT_SKILLS_VALIDATION.path),s=Object(i.matchPath)(R,A.b.USER_PROFILE_ASSESSMENT_RESULTS.path);!0===(null===t||void 0===t?void 0:t.isExact)||!0===(null===s||void 0===s?void 0:s.isExact)?x.push(A.b.USER_PROFILE_ASSESSMENT.getRoute({userId:O,assessmentId:v})):!0===(null===e||void 0===e?void 0:e.isExact)&&x.push(A.b.USER_PROFILE_ASSESSMENTS.getRoute({userId:O}))},canDeleteAssessment:N,onDeleteAssessment:function(){return p({type:"openConfirmDeleteModal"})},canCancelAssessment:F,onCancelAssessment:function(){return p({type:"openConfirmCancelModal"})},canReopenAssessment:U,onReopenAssessment:function(){return p({type:"openConfirmReopenModal"})},py:1,mb:[2,null],width:"100%"}):Object(f.jsxs)(r.Line,{width:"100%",justifyContent:"space-between",px:1,py:3,children:[Object(f.jsxs)(r.Line,{width:"50%",children:[Object(f.jsx)(r.LoaderSkeleton.Point,{}),Object(f.jsx)(r.LoaderSkeleton.Line,{width:"50%"})]}),Object(f.jsx)(r.Line,{width:"50%",justifyContent:"flex-end",children:Object(f.jsx)(r.LoaderSkeleton.Line,{width:"50%"})})]}),Object(f.jsxs)(r.Box,{width:"100%",height:"100%",children:[Object(f.jsx)(i.Route,{path:A.b.USER_PROFILE_ASSESSMENT.path,exact:!0,render:function(){return Object(f.jsx)(C,{})}}),Object(f.jsx)(i.Route,{path:A.b.USER_PROFILE_ASSESSMENT_SKILLS_VALIDATION.path,render:function(){return Object(f.jsx)(y,{tabsOptions:t})}}),Object(f.jsx)(i.Route,{path:A.b.USER_PROFILE_ASSESSMENT_RESULTS.path,render:function(){return Object(f.jsx)(_,{tabsOptions:t})}})]})]})})})}),Object(f.jsx)(S.g,{isOpened:u,onCancel:Y,onConfirm:function(){B({onCompleted:function(){Y(),E.success(j("success"))},onError:function(e){Y(),E.error(I(e))}})},isLoading:G}),Object(f.jsx)(S.h,{isOpened:d,onCancel:H,onConfirm:function(){V({onCompleted:function(){H(),E.success(j("success")),x.push(A.b.USER_PROFILE_ASSESSMENTS.getRoute({userId:O}))},onError:function(e){H(),E.error(I(e))}})},isLoading:z}),Object(f.jsx)(S.i,{isOpened:m,onCancel:J,onConfirm:function(){W({onCompleted:function(){J(),E.success(j("success"))},onError:function(e){J(),E.error(I(e))}})},isLoading:P})]})}},776:function(e,t,s){"use strict";s.r(t),s.d(t,"ResourceAssessmentDetailContext",(function(){return x})),s.d(t,"useResourceAssessmentDetailContext",(function(){return h}));var n=s(53),a=s(17),o=s(139),i=s.n(o),r=s(286),c=s(0),l=s.n(c),u=s(15),d=s(14),m=s(32),p=s(10),j=s(3),b=s(836),f=s(838),O=s(1142),v=s(1),x=l.a.createContext({assessmentId:"",isSkillsScopeEmpty:!0,isAssessor:!1,isValidator:!1,isApprover:!1,hasApproved:!1,isAllApproved:!1,isApprovingAssessment:!1,isValidatingSkillsAndClosingAssessment:!1,assessmentType:m.AssessmentType.SHARED_FORM,assessmentFormContentType:m.AssessmentFormContentType.ADDON,assessors:[],validators:[],approvers:[],capabilities:{canUpdate:!0,canDelete:!0,canReadDetails:!0},updateAssessmentValidatedSkills:function(){},openValidateAssessmentSkillsModal:function(){},openCloseAssessmentModal:function(){},approveAssessment:function(){},openApproveAssessmentModal:function(){},openUnapproveAssessmentModal:function(){},addAssessmentUser:function(){},removeAssessmentUser:function(){},generateAssessmentReportFile:function(){},uploadAssessmentReportFile:function(){var e=Object(r.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",void 0);case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),deleteAssessmentReportFile:function(){var e=Object(r.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",void 0);case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),onStartNewAssessment:function(){}}),h=function(){return Object(c.useContext)(x)},A={isOpenedConfirmApproveModal:!1,isOpenedConfirmUnapproveModal:!1},g=function(e,t){switch(t.type){case"openConfirmApproveModal":return Object(a.a)(Object(a.a)({},e),{},{isOpenedConfirmApproveModal:!0,isOpenedConfirmUnapproveModal:!1});case"closeConfirmApproveModal":return Object(a.a)(Object(a.a)({},e),{},{isOpenedConfirmApproveModal:!1});case"openConfirmUnapproveModal":return Object(a.a)(Object(a.a)({},e),{},{isOpenedConfirmUnapproveModal:!0,isOpenedConfirmApproveModal:!1});case"closeConfirmUnapproveModal":return Object(a.a)(Object(a.a)({},e),{},{isOpenedConfirmUnapproveModal:!1});default:return e}};t.default=function(e){var t=e.tabsOptions,s=Object(c.useReducer)(g,A),a=Object(n.a)(s,2),o=a[0],h=o.isOpenedConfirmApproveModal,S=o.isOpenedConfirmUnapproveModal,C=a[1],y=Object(u.useParams)(),_=(y.userId,y.assessmentId),T=Object(d.useTranslate)(),k=Object(u.useHistory)(),R=Object(d.useAlert)(),w=Object(p.useAppContext)(),D=w.getErrorMessage,I=w.setTabsOptions,E=w.user.id,L=Object(f.a)({assessmentId:_,currentUserId:E}),M=L.isLoading,F=L.assessment,N=L.isSkillsScopeEmpty,U=L.isExistingReportFile,B=L.isAssessmentFormDocumentTemplate,V=L.isValidatedSkillsWithQualifiers,G=L.capabilities,z=L.assessors,P=L.validators,W=L.approvers,Y=L.isAssessor,H=L.isValidator,J=L.isApprover,Q=L.hasApproved,q=L.isAllApproved,K=L.isLastApproval,X=L.refetchAssessment,Z=L.isPermissionDenied,$=Object(f.d)({assessmentId:_,isAutoClose:(null===F||void 0===F?void 0:F.isAutoClose)||!1}),ee=$.isApprovingAssessment,te=$.isUnapprovingAssessment,se=$.isValidatingSkillsAndClosingAssessment,ne=$.isReschedulingAssessment,ae=$.isValidatingSkills,oe=$.approveAssessment,ie=$.unapproveAssessment,re=$.rescheduleAssessment,ce=$.rescheduleAssessmentThenClose,le=$.validateSkillsAndCloseAssessment,ue=$.validateSkills,de=$.updateAssessmentUsers,me=$.generateReportFile,pe=$.deleteReportFile,je=Object(f.f)({assessmentId:_}).uploadReportFile,be=Object(d.useSwitch)(!1),fe=Object(d.useSwitch)(!1),Oe=Object(d.useSwitch)(!1),ve=Object(d.useSwitch)(!1);Object(c.useEffect)((function(){return I(t),function(){I(void 0)}}),[]),Object(c.useEffect)((function(){var e;return(null===F||void 0===F?void 0:F.status)===m.AssessmentStatus.VALIDATING&&J&&!Q&&(e=setTimeout((function(){C({type:"openConfirmApproveModal"})}),1e3)),function(){return clearInterval(e)}}),[J,Q,F]),Object(c.useEffect)((function(){var e;return(null===F||void 0===F?void 0:F.status)===m.AssessmentStatus.VALIDATING&&!F.isAutoClose&&q&&H&&(e=setTimeout((function(){fe.on()}),1e3)),function(){return clearInterval(e)}}),[q,H]),Object(c.useEffect)((function(){var e;return(null===F||void 0===F?void 0:F.status)===m.AssessmentStatus.ONGOING&&H&&V&&(e=setTimeout((function(){be.on()}),1e3)),function(){return clearInterval(e)}}),[H,V]);var xe=l.a.useMemo((function(){var e,t;return Object(b.b)({skillsList:null===F||void 0===F||null===(e=F.skillsScope)||void 0===e?void 0:e.selectedSkills,evaluatedUserJobs:null===F||void 0===F||null===(t=F.skillsScope)||void 0===t?void 0:t.userJobs,librariesAndJobs:void 0})}),[F]),he=xe.evaluationObjects,Ae=xe.evaluationObjectsType,ge=(xe.skillsToEvaluate,function(){var e=Object(r.a)(i.a.mark((function e(t){var s;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=t.documentTemplate,"undefined"===typeof F){e.next=4;break}return fe.off(),e.abrupt("return",le({documentTemplate:s}).then((function(){R.success(T("success")),X()})).catch((function(e){R.error(D(e))})));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),Se=function(){fe.off(),Oe.on()},Ce=function(){var e=Object(r.a)(i.a.mark((function e(t){var s,n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s=t.isCopyExistingContent,n=t.scheduledDate,((null===F||void 0===F?void 0:F.status)===m.AssessmentStatus.CLOSED?re({isCopyExistingContent:s,scheduledDate:n}):ce({isCopyExistingContent:s,scheduledDate:n})).then((function(){Oe.off(),X()})).catch((function(e){R.error(D(e))}));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ye=function(){var e=Object(r.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(_e(),"undefined"!==typeof F){e.next=3;break}return e.abrupt("return");case 3:oe({isLastApproval:K,documentTemplate:F.autoCloseDocumentTemplate}).then((function(){R.success(T("success")),X()})).catch((function(e){R.error(D(e))}));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),_e=function(){C({type:"closeConfirmApproveModal"})},Te=function(){C({type:"closeConfirmUnapproveModal"})},ke=function(){var e=Object(r.a)(i.a.mark((function e(t){var s,n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s=t.isAutoClose,n=t.documentTemplate,ue({isAutoClose:s,documentTemplate:n}).then((function(){be.off(),R.success(T("success")),X()})).catch((function(e){R.error(D(e))}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Re=function(){var e=Object(r.a)(i.a.mark((function e(t){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("undefined"===typeof t){e.next=2;break}return e.abrupt("return",me(t).then((function(){R.success(T("success")),ve.off(),X()})).catch((function(e){R.error(D(e))})));case 2:return e.abrupt("return");case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),we=function(){var e=Object(r.a)(i.a.mark((function e(t){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",je(t).then((function(){R.success(T("success")),X()})).catch((function(e){R.error(D(e))})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),De=function(){var e=Object(r.a)(i.a.mark((function e(t){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",pe(t).then((function(){R.success(T("success"))})).catch((function(e){R.error(D(e))})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return M?Object(v.jsx)(d.Loader,{}):F?Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)(O.k,{isBlocked:se,routingMessage:T("warning_operation_in_progress_please_wait"),loaderMessage:T("closing_assessment_please_wait")}),Object(v.jsx)(d.ErrorBoundary,{onReset:function(){window.location.reload()},children:Object(v.jsx)(d.Column,{width:"100%",height:"100%",alignItems:"flex-start",ml:1,children:!0===G.canReadDetails?Object(v.jsxs)(x.Provider,{value:{assessmentId:_,assessment:F,isSkillsScopeEmpty:N,capabilities:G,isApprover:J,isAssessor:Y,isValidator:H,hasApproved:Q,isAllApproved:q,isApprovingAssessment:ee,isValidatingSkillsAndClosingAssessment:se,assessmentType:F.assessmentFormType,assessmentFormContentType:F.assessmentFormContentType,assessors:z||[],validators:P||[],approvers:W||[],updateAssessmentValidatedSkills:function(){F&&k.push(j.b.USER_PROFILE_ASSESSMENT_RESULTS.getRoute({userId:F.evaluatedUser.id,assessmentId:_}))},openValidateAssessmentSkillsModal:function(){be.on()},openCloseAssessmentModal:function(){fe.on()},approveAssessment:function(){console.log("approveAssessment")},openApproveAssessmentModal:function(){C({type:"openConfirmApproveModal"})},openUnapproveAssessmentModal:function(){C({type:"openConfirmUnapproveModal"})},addAssessmentUser:function(e,t){de(e,{userToAdd:t}).then((function(){X()})).catch((function(s){console.error("Error adding ".concat(e," ").concat(t.id," to the assessment")),R.error(D(s))}))},removeAssessmentUser:function(e,t){de(e,{userIdToRemove:t}).then((function(){X()})).catch((function(s){console.error("Error removing ".concat(e," ").concat(t," from the assessment")),R.error(D(s))}))},generateAssessmentReportFile:function(){"undefined"!==typeof(null===F||void 0===F?void 0:F.assessmentFormDocumentTemplates)&&(F.assessmentFormDocumentTemplates.length>1?ve.on():1===F.assessmentFormDocumentTemplates.length&&Re(F.assessmentFormDocumentTemplates[0]))},uploadAssessmentReportFile:we,deleteAssessmentReportFile:De,onStartNewAssessment:Se},children:[Object(v.jsx)(O.a,{assessmentStatus:F.status,evaluationObjects:he,evaluationObjectsType:Ae,mb:40}),Object(v.jsx)(O.b,{assessors:z||[],assessmentType:F.assessmentFormType,assessmentStatus:F.status,mb:40}),Object(v.jsx)(O.c,{assessmentStatus:F.status,mb:40}),Object(v.jsx)(O.d,{assessmentStatus:F.status,approvers:W||[]})]}):Object(v.jsx)(O.l,{text:T("assessment_cannot_read_details_message")})})}),Object(v.jsx)(O.o,{assessmentId:_,isValidatingAssessment:ae,onValidateAssessment:ke,isOpened:be.active,onClose:be.off,isDisabledValidateSkills:N,isEnabledGenerateReport:B,isExistingReportFile:U,documentTemplates:F.assessmentFormDocumentTemplates}),Object(v.jsx)(O.e,{assessmentId:_,onStartNewAssessment:Se,onCloseAssessment:ge,isOpened:fe.active,onClose:fe.off,isEnabledGenerateReport:B,isExistingReportFile:U,documentTemplates:F.assessmentFormDocumentTemplates}),Object(v.jsx)(O.n,{assessmentId:_,isOpened:Oe.active,onClose:Oe.off,onRescheduleAssessment:Ce,isRescheduling:ne}),Object(v.jsx)(O.f,{isOpened:h,onCancel:_e,onConfirm:ye,isLoading:ee}),Object(v.jsx)(O.j,{isOpened:S,onCancel:Te,onConfirm:function(){"undefined"!==typeof F&&ie({onCompleted:function(){Te(),R.success(T("success")),X()},onError:function(e){Te(),R.error(D(e))}})},isLoading:te}),"undefined"!==typeof F.assessmentFormDocumentTemplates&&Object(v.jsx)(O.m,{isOpened:ve.active,onSubmit:Re,onCancel:ve.off,documentTemplates:F.assessmentFormDocumentTemplates,isExistingReportFile:U})]}):Z?Object(v.jsx)(O.l,{text:T("you_have_no_access_to_this_page")}):Object(v.jsx)(d.Line,{p:3,children:Object(v.jsx)(d.Text,{children:T("error")})})}},838:function(e,t,s){"use strict";s.d(t,"a",(function(){return m})),s.d(t,"b",(function(){return p})),s.d(t,"c",(function(){return b})),s.d(t,"d",(function(){return h})),s.d(t,"e",(function(){return g})),s.d(t,"f",(function(){return C})),s.d(t,"g",(function(){return _}));var n=s(139),a=s.n(n),o=s(286),i=s(17),r=s(0),c=s(19),l=s(32),u=s(121),d=s(743),m=function(e){var t=e.assessmentId,s=e.currentUserId,n=Object(d.a)().redirectToEntity404,m=Object(c.useGetAssessmentQuery)({variables:{id:t},onError:function(e){return n({entity:u.d.Assessment,error:e})}}),p=m.loading,j=m.data,b=m.error,f=m.refetch,O=Object(r.useMemo)((function(){if(null===j||void 0===j?void 0:j.assessment){var e,t,s,n,a,o,r,u,d,m,p,b,f=j.assessment.updatedBy?{displayName:j.assessment.updatedBy.displayName}:void 0;return j.assessment.skillsScope&&("AssessmentSkillsFromList"===j.assessment.skillsScope.__typename?p={selectedSkills:(j.assessment.skillsScope.selectedSkills||[]).map((function(e){return{id:e.id,name:e.name,libraryContext:e.libraryContext?{id:e.libraryContext.id,name:e.libraryContext.name,logo:e.libraryContext.logo,color:e.libraryContext.color}:void 0}}))}:"AssessmentSkillsFromEvaluatedUserJobs"===j.assessment.skillsScope.__typename&&(p={userJobs:(j.assessment.skillsScope.userJobs||[]).map((function(e){return{id:e.id,name:e.name,pattern:e.pattern}}))})),b="AssessmentFormContentAddon"===(null===(e=j.assessment.assessmentForm)||void 0===e||null===(t=e.content)||void 0===t?void 0:t.__typename)?{assessmentFormContentType:l.AssessmentFormContentType.ADDON,assessmentFormContent:{url:j.assessment.assessmentForm.content.url}}:"AssessmentFormContentJSONForm"===(null===(s=j.assessment.assessmentForm)||void 0===s||null===(n=s.content)||void 0===n?void 0:n.__typename)?{assessmentFormContentType:l.AssessmentFormContentType.JSON_FORM,assessmentFormContent:{json:Object(c.maybeToOptional)(j.assessment.assessmentForm.content.json)}}:{assessmentFormContent:void 0,assessmentFormContentType:void 0},Object(i.a)(Object(i.a)({id:j.assessment.id,name:j.assessment.name,status:j.assessment.status,campaignName:null===(a=j.assessment.campaign)||void 0===a?void 0:a.name,skillsScope:p,startDate:j.assessment.startDate,updatedAt:Object(c.maybeToOptional)(j.assessment.updatedAt),updatedBy:f,assessmentFormType:null===(o=j.assessment.assessmentForm)||void 0===o?void 0:o.assessmentType,assessmentFormDocumentTemplates:null===(r=j.assessment.assessmentForm)||void 0===r||null===(u=r.documentTemplates)||void 0===u?void 0:u.map((function(e){return{link:e.link,name:e.name}}))},b),{},{assessmentRows:null===(d=j.assessment.assessmentRows)||void 0===d?void 0:d.map((function(e){return Object(i.a)(Object(i.a)({},e),{},{result:Object(c.maybeToOptional)(e.result)})})),evaluatedUser:{id:j.assessment.evaluatedUser.id,managers:j.assessment.evaluatedUser.managers.nodes.map((function(e){return{id:e.id}}))},reportFiles:null===(m=j.assessment.reportFiles)||void 0===m?void 0:m.map((function(e){return{name:e.name,link:e.url,createdAt:e.createdAt,documentTemplate:e.documentTemplate?{name:e.documentTemplate.name,link:e.documentTemplate.link}:void 0}})),isAutoClose:!0===j.assessment.autoClose,autoCloseDocumentTemplate:j.assessment.documentTemplate?{link:j.assessment.documentTemplate.link,name:j.assessment.documentTemplate.name}:void 0})}}),[j]),v=Object(r.useMemo)((function(){return!(null===O||void 0===O?void 0:O.skillsScope)||0===(O.skillsScope.selectedSkills||[]).length&&0===(O.skillsScope.userJobs||[]).length}),[O]),x=Object(r.useMemo)((function(){return"undefined"!==typeof(null===O||void 0===O?void 0:O.reportFiles)&&O.reportFiles.length>0}),[O]),h=Object(r.useMemo)((function(){var e;return!!(null===j||void 0===j||null===(e=j.assessment)||void 0===e?void 0:e.assessmentForm)&&(j.assessment.assessmentForm.documentTemplates||[]).length>0}),[j]),A=Object(r.useMemo)((function(){var e,t=null===j||void 0===j||null===(e=j.assessment)||void 0===e?void 0:e.validatedSkills;return!!t&&t.filter((function(e){return e.qualifiers.edges.some((function(e){return null!==e.value}))})).length>0}),[j]),g=Object(r.useMemo)((function(){var e,t=null===j||void 0===j||null===(e=j.assessment)||void 0===e?void 0:e.capabilities;return t?{canUpdate:!0===t.canUpdate,canDelete:!0===t.canDelete,canReadDetails:!0===t.canReadDetails}:{canUpdate:!1,canDelete:!1,canReadDetails:!1}}),[j]),S=Object(r.useMemo)((function(){var e;return null===j||void 0===j||null===(e=j.assessment)||void 0===e?void 0:e.assessors.nodes.map((function(e){return{id:e.id,displayName:e.displayName,familyName:Object(c.maybeToOptional)(e.familyName),givenName:Object(c.maybeToOptional)(e.givenName),avatarURL:Object(c.maybeToOptional)(e.avatarURL)}}))}),[j]),C=Object(r.useMemo)((function(){var e;return null===j||void 0===j||null===(e=j.assessment)||void 0===e?void 0:e.validators.nodes.map((function(e){return{id:e.id,displayName:e.displayName,familyName:Object(c.maybeToOptional)(e.familyName),givenName:Object(c.maybeToOptional)(e.givenName),avatarURL:Object(c.maybeToOptional)(e.avatarURL)}}))}),[j]),y=Object(r.useMemo)((function(){var e;return null===j||void 0===j||null===(e=j.assessment)||void 0===e?void 0:e.approvers.edges.map((function(e){return{id:e.node.id,displayName:e.node.displayName,familyName:Object(c.maybeToOptional)(e.node.familyName),givenName:Object(c.maybeToOptional)(e.node.givenName),avatarURL:Object(c.maybeToOptional)(e.node.avatarURL),hasApproved:e.hasApproved}}))}),[j]),_=Object(r.useMemo)((function(){if("undefined"!==typeof y){var e=y.filter((function(e){return!0!==e.hasApproved}));return 1===e.length&&e[0].id===s}return!1}),[y]),T=Object(r.useMemo)((function(){return!!y&&y.every((function(e){return!0===e.hasApproved}))}),[y]),k=function(e){return!!(null===e||void 0===e?void 0:e.find((function(e){return e.id===s})))},R=k(S),w=k(C),D=k(y),I=(y||[]).some((function(e){return e.id===s&&e.hasApproved})),E=function(){var e=Object(o.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!f){e.next=2;break}return e.abrupt("return",f().then((function(){})).catch((function(e){throw new Error(e)})));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),L=b&&"PERMISSION_DENIED"===b.message||!1;return{isLoading:p,assessment:O,isSkillsScopeEmpty:v,isExistingReportFile:x,isAssessmentFormDocumentTemplate:h,isValidatedSkillsWithQualifiers:A,capabilities:g,assessors:S,validators:C,approvers:y,isAssessor:R,isValidator:w,isApprover:D,hasApproved:I,isAllApproved:T,isLastApproval:_,refetchAssessment:E,isPermissionDenied:L}},p=function(e){var t=e.assessmentId,s=e.currentUserId,n=Object(c.useGetAssessmentHeaderInfosQuery)({variables:{id:t},fetchPolicy:"cache-first",nextFetchPolicy:"cache-only"}).data,a=Object(r.useMemo)((function(){var e,t=null===n||void 0===n?void 0:n.assessment;if(t)return{id:t.id,name:t.name,status:t.status,campaignName:null===(e=t.campaign)||void 0===e?void 0:e.name,startDate:t.startDate,updatedAt:Object(c.maybeToOptional)(t.updatedAt),updatedBy:t.updatedBy?{displayName:t.updatedBy.displayName}:void 0}}),[n]),o=Object(r.useMemo)((function(){var e=null===n||void 0===n?void 0:n.assessment;return!!e&&e.validators.nodes.some((function(e){return e.id===s}))}),[n,s]),l=Object(r.useMemo)((function(){var e,t=null===n||void 0===n||null===(e=n.assessment)||void 0===e?void 0:e.capabilities;return t?{canUpdate:!0===t.canUpdate,canDelete:!0===t.canDelete}:{canUpdate:!1,canDelete:!1}}),[n]);return"undefined"===typeof a?{assessmentHeaderInfos:void 0}:{assessmentHeaderInfos:Object(i.a)(Object(i.a)({},a),{},{canUpdate:l.canUpdate,canDelete:l.canDelete,isValidator:o})}},j=s(53),b=function(e){var t=e.assessmentId,s=e.canDelete,n=e.canUpdate,a=e.isValidator,o=e.status,i=Object(c.useUpdateAssessmentStatusMutation)(),u=Object(j.a)(i,2),d=u[0],m=u[1].loading,p=Object(c.useDeleteAssessmentMutation)(),b=Object(j.a)(p,2),f=b[0];return{isDeletingAssessment:b[1].loading,isCancelingAssessment:m,isReopeningAssessment:m,canCancelAssessment:Object(r.useMemo)((function(){return!0===n&&(o===l.AssessmentStatus.PLANNED||o===l.AssessmentStatus.ONGOING||o===l.AssessmentStatus.VALIDATING)}),[n,o]),canDeleteAssessment:Object(r.useMemo)((function(){return(!0===s||!0===a)&&"undefined"!==typeof o&&o!==l.AssessmentStatus.CLOSED}),[s,o,a]),canReopenAssessment:Object(r.useMemo)((function(){return!0===n&&o===l.AssessmentStatus.CANCELED}),[n,o]),deleteAssessment:function(e){var s=e.onCompleted,n=e.onError;f({variables:{id:t},onCompleted:s,onError:n})},cancelAssessment:function(e){var s=e.onCompleted,n=e.onError;d({variables:{assessmentId:t,status:c.AssessmentStatus.Canceled},onCompleted:s,onError:n})},reopenAssessment:function(e){var s=e.onCompleted,n=e.onError;d({variables:{assessmentId:t,status:c.AssessmentStatus.Ongoing},onCompleted:s,onError:n})}}},f=s(188),O=s(994),v=s(115),x=function e(t){var s=Object(O.a)(t),n=s[0],a=s.slice(1);return n.then((function(){if(a.length>0)return e(a)})).catch((function(e){throw new Error(e)}))},h=function(e){var t=e.assessmentId,s=e.isAutoClose,n=Object(r.useState)(!1),i=Object(j.a)(n,2),l=(i[0],i[1]),u=Object(r.useState)(!1),d=Object(j.a)(u,2),m=d[0],p=d[1],b=Object(r.useState)(!1),O=Object(j.a)(b,2),h=O[0],A=O[1],g=Object(v.a)(),S=Object(c.useApproveAssessmentMutation)(),C=Object(j.a)(S,1)[0],y=Object(c.useUnapproveAssessmentMutation)(),_=Object(j.a)(y,2),T=_[0],k=_[1].loading,R=Object(c.useRescheduleAssessmentMutation)(),w=Object(j.a)(R,2),D=w[0],I=w[1].loading,E=Object(c.useValidateAssessmentSkillsMutation)(),L=Object(j.a)(E,2),M=L[0],F=(L[1].loading,Object(c.useUpdateAssessmentStatusMutation)()),N=Object(j.a)(F,2),U=N[0],B=N[1].loading,V=Object(c.useUpdateAssessmentToValidatingMutation)(),G=Object(j.a)(V,2),z=G[0],P=(G[1].loading,Object(c.useUpdateAssessmentUsersMutation)()),W=Object(j.a)(P,1)[0],Y=Object(c.useDeleteAssessmentMutation)(),H=(Object(j.a)(Y,1)[0],Object(c.useDeleteAssessmentReportFileMutation)()),J=Object(j.a)(H,1)[0],Q=function(){var e=Object(o.a)(a.a.mark((function e(n){var o,i,r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=n.isLastApproval,i=n.documentTemplate,(r=s&&o)?A(!0):p(!0),e.next=5,C({variables:{assessmentId:t}});case 5:if(!r){e.next=8;break}return e.next=8,Z({documentTemplate:i});case 8:return r?A(!1):p(!1),e.abrupt("return");case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),q=function(){var e=Object(o.a)(a.a.mark((function e(s){var n,o;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=s.isCopyExistingContent,o=s.scheduledDate,e.abrupt("return",x([D({variables:{assessmentId:t,copyExistingContent:n,schedulingDate:o}}),Z({})]));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),K=function(){var e=Object(o.a)(a.a.mark((function e(s){var n,o;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=s.isCopyExistingContent,o=s.scheduledDate,e.abrupt("return",x([D({variables:{assessmentId:t,copyExistingContent:n,schedulingDate:o}})]));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),X=function(){var e=Object(o.a)(a.a.mark((function e(s){var n,o;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=s.isAutoClose,o=s.documentTemplate,e.abrupt("return",x([z({variables:{assessmentId:t,isAutoClose:n,isGenerateReport:"undefined"!==typeof o,documentTemplate:o}})]));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Z=function(){var e=Object(o.a)(a.a.mark((function e(s){var n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=s.documentTemplate,A(!0),e.prev=2,"undefined"===typeof n){e.next=12;break}return e.next=6,te(n);case 6:return e.next=8,M({variables:{assessmentId:t}});case 8:return e.next=10,U({variables:{assessmentId:t,status:c.AssessmentStatus.Closed},refetchQueries:["getAssessment"],awaitRefetchQueries:!0});case 10:e.next=16;break;case 12:return e.next=14,M({variables:{assessmentId:t}});case 14:return e.next=16,U({variables:{assessmentId:t,status:c.AssessmentStatus.Closed},refetchQueries:["getAssessment"],awaitRefetchQueries:!0});case 16:e.next=22;break;case 18:throw e.prev=18,e.t0=e.catch(2),A(!1),new Error(e.t0);case 22:return A(!1),e.abrupt("return");case 24:case"end":return e.stop()}}),e,null,[[2,18]])})));return function(t){return e.apply(this,arguments)}}(),$=function(){var e=Object(o.a)(a.a.mark((function e(s,n){var o,i,r,c,l,u;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=n.userToAdd,i=n.userIdToRemove,r=g.extract()["Assessment:".concat(t)]){e.next=4;break}return e.abrupt("return",new Promise((function(e){return e(void 0)})));case 4:return c="assessor"===s?r.assessors.nodes.map((function(e){return g.extract()[e.__ref]})).map((function(e){return e.id})):"validator"===s?r.validators.nodes.map((function(e){return g.extract()[e.__ref]})).map((function(e){return e.id})):r.approvers.nodes?r.approvers.nodes.map((function(e){return g.extract()[e.__ref]})).map((function(e){return e.id})):r.approvers.edges?r.approvers.edges.map((function(e){return g.extract()[e.node.__ref]})).map((function(e){return e.id})):[],o?l=Array.from(new Set([].concat(Object(f.a)(c),[o.id]))):i&&(l=c.filter((function(e){return e!==i}))),u={assessmentId:t},"assessor"===s?u.assessorsIds=l:"validator"===s?u.validatorsIds=l:u.approversIds=l,e.abrupt("return",x([W({variables:u})]));case 9:case"end":return e.stop()}}),e)})));return function(t,s){return e.apply(this,arguments)}}(),ee=function(){throw new Error("Error generating report file")},te=function(){var e=Object(o.a)(a.a.mark((function e(s){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l(!0),e.abrupt("return",g.mutate({mutation:c.GenerateAssessmentReportDocument,variables:{assessmentId:t,documentTemplate:s}}).then((function(e){var t;null===(t=e.data)||void 0===t||t.generateAssessmentReport.url})).catch((function(){ee()})).finally((function(){l(!1)})));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return{isApprovingAssessment:m,isUnapprovingAssessment:k,isReschedulingAssessment:I,isValidatingSkills:B,isValidatingSkillsAndClosingAssessment:h,approveAssessment:Q,unapproveAssessment:function(e){var s=e.onCompleted,n=e.onError;T({variables:{assessmentId:t},onCompleted:function(){U({variables:{assessmentId:t,status:c.AssessmentStatus.Ongoing},onCompleted:function(){s&&s()},onError:function(e){n&&n(e)}})},onError:function(e){n&&n(e)}})},rescheduleAssessmentThenClose:q,rescheduleAssessment:K,validateSkills:X,validateSkillsAndCloseAssessment:Z,updateAssessmentUsers:$,generateReportFile:te,deleteReportFile:function(){var e=Object(o.a)(a.a.mark((function e(s){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",x([J({variables:{assessmentId:t,reportFileUrl:s}})]));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}},A=s(776),g=function(){var e=Object(r.useState)(!1),t=Object(j.a)(e,2),s=t[0],n=t[1],i=Object(r.useState)(!1),c=Object(j.a)(i,2),u=c[0],d=c[1],m=Object(A.useResourceAssessmentDetailContext)(),p=m.assessment,b=m.generateAssessmentReportFile,f=m.uploadAssessmentReportFile,O=m.deleteAssessmentReportFile,v="undefined"!==typeof p&&p.assessmentFormType!==l.AssessmentType.INDIVIDUAL_FORMS,x="undefined"!==typeof(null===p||void 0===p?void 0:p.assessmentFormDocumentTemplates)&&p.assessmentFormDocumentTemplates.length>0,h="undefined"!==typeof p&&p.assessmentFormType===l.AssessmentType.SHARED_FORM,g=function(){var e=Object(o.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n(!0),e.abrupt("return",f(t).then((function(){n(!1)})).catch((function(){n(!1)})));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return{isShowReportFile:v,reportFiles:null===p||void 0===p?void 0:p.reportFiles,canGenerate:x,canUpload:h,isUploading:s,isDeleting:u,onGenerateReportFile:function(){b()},onUploadReportFile:g,onDeleteReportFile:function(e){return d(!0),O(e).then((function(){d(!1)})).catch((function(){d(!1)}))}}},S=s(63),C=function(e){var t=e.assessmentId,s=Object(r.useState)(!1),n=Object(j.a)(s,2),i=n[0],l=n[1],u=Object(S.useUploadFiles)(),d=Object(c.useUpdateAssessmentResultReportMutation)(),m=Object(j.a)(d,1)[0];return{uploadReportFile:function(){var e=Object(o.a)(a.a.mark((function e(s){var n,o,i,r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l(!0),e.next=3,u([s]);case 3:if(i=e.sent,"undefined"===typeof(r=(null===i||void 0===i||null===(n=i.files)||void 0===n?void 0:n.length)?null===i||void 0===i||null===(o=i.files)||void 0===o?void 0:o[0].url:void 0)){e.next=7;break}return e.abrupt("return",m({variables:{assessmentId:t,resultReport:{url:r}}}).then((function(){l(!1)})));case 7:return e.abrupt("return");case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),isUploadingReportFile:i}},y=s(187),_=function(e){var t=e.assessmentId,s=Object(c.useGetValidatedSkillsQuery)({variables:{id:t}}),n=s.data,a=s.loading;return{validatedSkills:Object(r.useMemo)((function(){var e;if(null===n||void 0===n||null===(e=n.assessment)||void 0===e?void 0:e.validatedSkills)return n.assessment.validatedSkills.map((function(e){var t=e.skill.qualifiers.nodes.reduce((function(e,t){return Object(i.a)(Object(i.a)({},e),{},Object(y.a)({},t.id,Object(c.getFormatedQualifierBasicFragment)(t)))}),{});return{skill:{id:e.skill.id,name:e.skill.name,color:e.skill.color,logo:e.skill.logo},qualifiers:e.qualifiers.edges.map((function(e){return{qualifier:t[e.node.id],value:e.value}}))}}))}),[n]),isLoading:a}}},860:function(e,t,s){"use strict";s.d(t,"a",(function(){return l}));var n,a=s(0),o=["title","titleId"];function i(){return(i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(e[n]=s[n])}return e}).apply(this,arguments)}function r(e,t){if(null==e)return{};var s,n,a=function(e,t){if(null==e)return{};var s,n,a={},o=Object.keys(e);for(n=0;n<o.length;n++)s=o[n],t.indexOf(s)>=0||(a[s]=e[s]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)s=o[n],t.indexOf(s)>=0||Object.prototype.propertyIsEnumerable.call(e,s)&&(a[s]=e[s])}return a}function c(e,t){var s=e.title,c=e.titleId,l=r(e,o);return a.createElement("svg",i({id:"Icon",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",x:"0px",y:"0px",viewBox:"0 0 24 24",style:{enableBackground:"new 0 0 24 24"},xmlSpace:"preserve",ref:t,"aria-labelledby":c},l),s?a.createElement("title",{id:c},s):null,n||(n=a.createElement("g",null,a.createElement("g",null,a.createElement("path",{d:"M12,18.3L12,18.3c-0.4,0-0.8-0.3-0.8-0.8v-6c0-0.4,0.3-0.8,0.8-0.8h0c0.4,0,0.8,0.3,0.8,0.8v6C12.8,18,12.4,18.3,12,18.3z "}),a.createElement("path",{d:"M8.5,18.3L8.5,18.3c-0.4,0-0.8-0.3-0.8-0.8v-6c0-0.4,0.3-0.8,0.8-0.8h0c0.4,0,0.8,0.3,0.8,0.8v6C9.3,18,8.9,18.3,8.5,18.3 z"}),a.createElement("path",{d:"M15.5,18.3L15.5,18.3c-0.4,0-0.8-0.3-0.8-0.8v-6c0-0.4,0.3-0.8,0.8-0.8h0c0.4,0,0.8,0.3,0.8,0.8v6 C16.3,18,15.9,18.3,15.5,18.3z"})),a.createElement("path",{d:"M20.8,6.6h-3.9V3.5c0-0.8-0.7-1.5-1.5-1.5H8.6C7.8,2,7.1,2.7,7.1,3.5v3.1H3.3C2.6,6.6,2,7.2,2,7.9c0,0.7,0.6,1.3,1.3,1.3h1 v11.4c0,0.8,0.7,1.5,1.5,1.5h12.5c0.8,0,1.5-0.7,1.5-1.5V9.1h1c0.7,0,1.3-0.6,1.3-1.3C22,7.2,21.4,6.6,20.8,6.6z M9.1,4h5.8v2.6 H9.1V4z M17.8,20H6.3V9.1h11.5V20z"}))))}var l=a.forwardRef(c);s.p},994:function(e,t,s){"use strict";s.d(t,"a",(function(){return r}));var n=s(307),a=s(309),o=s(150),i=s(308);function r(e){return Object(n.a)(e)||Object(a.a)(e)||Object(o.a)(e)||Object(i.a)()}}}]);